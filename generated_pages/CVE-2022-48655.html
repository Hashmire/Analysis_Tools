
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
        <style>
        /* styles.css - CPE JSON Generator styles */

/* Row selection styling */
.table-active {
    background-color: rgba(0, 123, 255, 0.35) !important;
    font-weight: bold;
    border-left: 3px solid #007bff;
}

/* JSON container transitions */
.json-container {
    transition: all 0.3s ease-in-out;
    margin-top: 1rem;
    margin-bottom: 1rem;
}

/* Button transitions */
.btn-success {
    transition: background-color 0.3s ease;
}

/* Fix for the table row selection styling */
.table-active,
.table-active > td,
.table-active > th {
    background-color: rgba(0, 123, 255, 0.35) !important;  /* Clearly visible blue */
}

.table-hover tbody tr:hover:not(.table-active) {
    background-color: rgba(0, 0, 0, 0.075) !important;  /* Light gray for hover */
}

/* Ensure selected trumps hover */
.table-hover tbody tr.table-active:hover {
    background-color: rgba(0, 123, 255, 0.45) !important;  /* Slightly darker blue when hovering selected row */
}

/* Confirmed mapping row styling */
.confirmed-mapping-row {
    background-color: rgba(40, 167, 69, 0.1) !important;
    border-left: 3px solid #28a745;
}

.confirmed-mapping-row:hover {
    background-color: rgba(40, 167, 69, 0.2) !important;
}

.confirmed-mapping-row.table-active {
    background-color: rgba(40, 167, 69, 0.3) !important;
    border-left: 3px solid #1e7e34;
}

/* Add pointer cursor to rows that can be selected */
.cpe-row {
    cursor: pointer;
}

/* Pre-formatted code styling */
pre {
    max-height: 400px;
    overflow-y: auto;
    background: #f8f9fa;
    padding: 15px;
    border-radius: 5px;
}

/* Tab navigation styling */
.bg-pivot {
    --bs-bg-opacity: 1;
    background-color: rgb(181, 90, 232) !important;
}

.tab {
    overflow: hidden;
    border: 1px solid #ccc;
    background-color: #f1f1f1;
}

.tab button {
    background-color: inherit;
    float: left;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 14px 16px;
    transition: 0.3s;
}

.tab button:hover {
    background-color: #ddd;
}

.tab button.active {
    background-color: #ccc;
}

/* Tab content classes */
.tabcontent {
    display: block;  /* Changed from "display: none" */
}

.tabcontent.d-none {
    display: none !important;
}

.tabcontent {
    display: none;
    margin-left: 10px;
    border: 1px solid #ccc;
    border-top: none;
}

/* Table styling */
table.dataframe {
    table-layout: fixed;
    width: 100%;
}

table.dataframe td:first-child {
    width: 20%;
}

table.dataframe td:last-child {
    width: 80%;
}

/* Linux Kernel special handling badge */
.linux-kernel-badge {
    display: inline-block;
    margin-right: 5px;
    margin-bottom: 8px;
    padding: 3px 6px;
    font-size: 0.75rem;
    font-weight: bold;
    line-height: 1;
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    border-radius: 4px;
    color: #212529;
    background-color: #ffc107;
    cursor: help;
}

.linux-kernel-badge:hover {
    background-color: #e0a800;
}

/* Git versionType badge styling */
.git-versiontype-badge {
    display: inline-block;
    padding: 0.25em 0.6em;
    margin-right: 0.5rem;
    margin-bottom: 0.5rem;
    font-size: 0.75em;
    font-weight: 700;
    line-height: 1;
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    border-radius: 0.25rem;
    background-color: #ffc107; /* warning color */
    color: #212529; /* dark text */
    cursor: help;
    transition: all 0.2s ease-in-out;
}

.git-versiontype-badge:hover {
    background-color: #e0a800; /* darker warning color on hover */
    transform: scale(1.05);
}

/* Custom purple badge type for source data concerns */
.badge.bg-sourceDataConcern {
    background-color: #8e44ad !important; /* Deep purple color */
    color: #fff;
    display: inline-block;
    padding: 0.25em 0.6em;
    font-size: 0.75em;
    font-weight: 700;
    line-height: 1;
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    border-radius: 0.25rem;
    transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;
}

/* Hover effect */
.badge.bg-sourceDataConcern:hover {
    background-color: #7d3c98 !important; /* Slightly darker purple on hover */
    cursor: help;
}

/* Focus state for accessibility */
.badge.bg-sourceDataConcern:focus {
    outline: 0;
    box-shadow: 0 0 0 0.2rem rgba(142, 68, 173, 0.25);
}

/* Provenance Assistance Styles */
.provenance-content {
    font-size: 0.9rem;
}

/* Description content area */
.description-content {
    background-color: #f8f9fa;
    border-radius: 0.25rem;
    padding: 1rem;
    border: 1px solid #dee2e6;
}

.placeholder-text {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 80px;
    color: #6c757d;
    font-style: italic;
}

.description-text {
    white-space: pre-wrap;
    line-height: 1.5;
}

/* Container styling for both types of cards */
.provenance-links, 
.description-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    align-items: stretch;
}

/* Card styling - unified for all provenance cards */
.source-card {
    min-width: 180px;
    max-width: 300px;
    background-color: #f8f9fa;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    height: auto;
    margin-right: 0.5rem !important;
    margin-bottom: 0.5rem !important;
    display: flex;
    flex-direction: column;
}

/* Card header styling */
.source-card .card-header {
    background-color: #e9ecef;
    font-size: 0.85rem;
    padding: 0.4rem 0.75rem;
    height: 38px;
    display: flex;
    align-items: center;
}

/* Card body styling */
.source-card .card-body {
    padding: 0.5rem;
    flex: 1;
    display: flex;
    flex-direction: column;
}

/* Button styling - unified for all buttons */
.language-button,
.provenance-button {
    font-size: 0.8rem;
    padding: 0.2rem 0.5rem;
    transition: background-color 0.2s, color 0.2s;
    width: 100%;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-bottom: 0.5rem;
    min-height: 30px;
    height: auto;
}

/* Remove margin from last button */
.language-button:last-child,
.provenance-button:last-child {
    margin-bottom: 0;
}

/* Hover state for buttons */
.language-button:hover,
.provenance-button:hover {
    background-color: #0d6efd;
    color: white;
    border-color: #0d6efd;
}

/* Active state for language buttons */
.language-button.active {
    background-color: #0d6efd;
    color: white;
    border-color: #0d6efd;
}

/* Specific layout for center-aligned buttons (single button cards) */
.card-body.d-flex.align-items-center.justify-content-center {
    justify-content: center;
}

.card-body.d-flex.align-items-center.justify-content-center .language-button,
.card-body.d-flex.align-items-center.justify-content-center .provenance-button {
    margin-bottom: 0;
}

/* For cards with multiple buttons */
.card-body.has-multiple-buttons {
    justify-content: space-between;
    padding: 0.5rem;
    gap: 0.5rem;
}

/* Make specific adjustments for reference tag cards to match description cards */
#provenanceLinks_* .source-card,
#descriptionButtons_* .source-card {
    height: 100%;
    width: auto;
}

/* Link button styles */
.btn-link {
    text-decoration: none;
    color: #0d6efd;
    padding: 0;
}

.btn-link:hover {
    text-decoration: underline;
    color: #0a58ca;
}

/* Transitions for row collapse and JSON toggle */
.row-transition {
    transition: opacity 0.3s ease, max-height 0.4s ease, transform 0.3s ease !important;
    overflow: hidden;
    transition: all 0.3s ease-out;
}

/* Improve consolidated-json-container transitions */
.consolidated-json-container {
  overflow: hidden;
  max-height: 2000px; /* Large enough for most content */
  opacity: 1;
  transition: max-height 0.4s ease-out, opacity 0.3s ease-out;
  display: block;
}

.consolidated-json-container.collapsed {
  max-height: 0;
  opacity: 0;
  padding: 0;
  margin: 0;
  pointer-events: none;
  visibility: hidden;
}

/* Button transitions */
.btn-transition {
  transition: background-color 0.3s, color 0.3s, border-color 0.3s;
}

/* Add this to your existing .collapsing class or use Bootstrap's */
.collapsing {
    position: relative;
    height: 0;
    overflow: hidden;
    transition: height 0.35s ease;
}

/* Collapsible content styles */
.collapsible-content {
    overflow: hidden;
    transition: max-height 0.5s ease-out;
}

.collapsible-content.collapsed {
    max-height: 0 !important;
    overflow: hidden !important;
    padding: 0 !important;
    margin: 0 !important;
    border: none !important;
    display: none;
}

/* JSON container styles */
.consolidated-json-container pre {
    max-height: 400px;
    overflow-y: auto;
    background: #f8f9fa;
    padding: 15px;
    border-radius: 5px;
}

/* All configurations display */
#allConfigurationsContent {
    max-height: 600px;
    overflow-y: auto;
    background: #f8f9fa;
    padding: 15px;
    border-radius: 5px;
}

/* Completion tracker styles */
.completion-tracker-container {
    margin-top: 1rem;
    margin-bottom: 1rem;
    padding: 1rem;
    border: 1px solid #dee2e6;
    border-radius: 0.25rem;
}

/* JSON display container */
[id^="consolidatedJsonDisplay_"] {
    transition: max-height 0.3s ease-out;
}

/* Configuration summary styling */
#configurationSummary {
    font-weight: 500;
}

/* Table container styles */
.table-container {
  overflow: hidden;
  transition: max-height 0.4s ease, opacity 0.3s ease;
  max-height: 2000px; /* Large enough for most tables */
  opacity: 1;
}

/* Collapsed state */
.table-container.collapsed {
  max-height: 0;
  opacity: 0;
  padding: 0;
  margin: 0;
  border: none;
  pointer-events: none; /* Prevents interaction when collapsed */
}

/* Collapsible content styles - moved from inline JS */
.collapsible-content {
  overflow: hidden;
  transition: max-height 0.5s ease-out;
}

.collapsible-content.collapsed {
  max-height: 0 !important;
  overflow: hidden !important;
  padding: 0 !important;
  margin: 0 !important;
  border: none !important;
  display: none;
}

/* Button transitions - moved from inline JS */
.btn-transition {
  transition: background-color 0.3s, color 0.3s, border-color 0.3s;
}

/* JSON display containers */
.json-display-container {
  overflow: hidden;
  transition: max-height 0.4s ease, opacity 0.3s ease;
  max-height: 1000px;
  opacity: 1;
}

.json-display-container.collapsed {
  max-height: 0;
  opacity: 0;
  padding: 0;
  margin: 0;
}

/* Add these to your styles.css file */
.description-container {
  overflow: hidden;
  max-height: 2000px; /* Large enough for most descriptions */
  opacity: 1;
  transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
  margin-bottom: 1rem; /* Add some spacing when visible */
}

.description-container.collapsed {
  max-height: 0;
  opacity: 0;
  padding: 0;
  margin: 0; /* No margin when collapsed */
  pointer-events: none;
  display: block; /* Keep as block to maintain layout */
}

/* Add these CSS rules for description transitions */
.description-container {
  overflow: hidden;
  max-height: 2000px;
  opacity: 1;
  transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
  margin-bottom: 1rem; /* Add some spacing when visible */
}

.description-container.collapsed {
  max-height: 0;
  opacity: 0;
  padding: 0;
  margin: 0; /* No margin when collapsed */
  pointer-events: none;
  display: block; /* Keep as block to maintain layout */
}

/* For the description content area in provenance assistance */
.description-content {
  overflow: hidden;
  max-height: 2000px;
  opacity: 1;
  transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
  margin-bottom: 1rem; /* Add some spacing when visible */
}

.description-content.collapsed {
  max-height: 0;
  opacity: 0;
  padding: 0;
  margin: 0; /* No margin when collapsed */
  pointer-events: none;
  visibility: hidden;
}

/* Fix for any parent containers that might add extra spacing */
.provenance-container .row {
  margin-bottom: 0;
}

/* Collapse any description parent containers when all children are collapsed */
.description-container-wrapper:empty,
.description-container-wrapper:has(> .description-container.collapsed:only-child) {
  margin: 0;
  padding: 0;
}

/* Make description content completely collapse with no whitespace */
.description-content.collapsed {
  max-height: 0;
  opacity: 0;
  padding: 0 !important; /* Override Bootstrap padding */
  margin: 0 !important; /* Override Bootstrap margin */
  border: none !important; /* Remove any borders */
  overflow: hidden;
}

/* Hide specific table headers */
.hidden-header {
    display: none;
}

/* Add to existing styles.css */

/* Button styling for copy/export buttons */
.copy-button {
    margin-bottom: 8px;
}

/* Feedback animation */
.btn-transition {
    transition: all 0.2s ease-in-out;
}

/* Button container spacing */
#allConfigButtonsContainer {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

/* Add Font Awesome if not already included in your HTML */
@import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css');


        </style>
    </head>
    <body>
    <script>
/**
 * Modular JSON Generation Rules System
 * 
 * This module implements a truly modular rule system where each processing rule
 * can be independently enabled/disabled and applied in a composable manner.
 */

/**
 * Rule Registry - Each rule is a self-contained module
 */
const JSON_GENERATION_RULES = {
      /**
     * Wildcard Expansion Rule
     * Converts patterns like "5.4.*" into version ranges
     */
    wildcardExpansion: {
        name: 'Wildcard Expansion',
        description: 'Converts wildcard patterns (5.4.*) to version ranges',
        
        // Check if this rule should be applied
        shouldApply: (versionData, settings) => {
            return settings.enableWildcardExpansion && 
                   versionData.versions.some(v => 
                       v && (v.lessThanOrEqual && String(v.lessThanOrEqual).includes('*') || 
                            v.lessThan && String(v.lessThan).includes('*') ||
                            v.version && String(v.version).includes('*'))
                   );
        },        
        // Process the entire dataset to handle wildcard versions and prevent fallback processing
        processDataset: (cpeBase, versionData, settings, context) => {
            const matches = [];
            const nonWildcardVersions = [];
            let hasWildcards = false;
            
            // First pass: Process wildcard versions and collect non-wildcard ones
            for (const versionInfo of versionData.versions) {
                if (!versionInfo) continue;
                
                const isVulnerable = versionInfo.status === "affected";
                let wildcardProcessed = false;
                
                // Handle wildcards in the version field directly
                if (versionInfo.version && String(versionInfo.version).includes('*')) {
                    hasWildcards = true;
                    const wildcard = versionInfo.version;
                    const prefix = wildcard.split('*')[0].replace(/\.$/, '');
                    const parts = prefix.split('.');
                    
                    if (parts.length >= 1) {
                        const majorVersion = parseInt(parts[0], 10);
                        
                        if (!isNaN(majorVersion)) {
                            let startVersion, endVersion;
                            
                            if (parts.length === 1) {
                                // Handle patterns like "1.*"
                                startVersion = `${majorVersion}.0`;
                                endVersion = `${majorVersion + 1}.0`;
                            } else if (parts.length >= 2) {
                                // Handle patterns like "2.0.*"
                                const minorVersion = parseInt(parts[1], 10);
                                if (!isNaN(minorVersion)) {
                                    startVersion = `${majorVersion}.${minorVersion}`;
                                    endVersion = `${majorVersion}.${minorVersion + 1}`;
                                }
                            }
                              if (startVersion && endVersion) {
                                matches.push({
                                    criteria: cpeBase,
                                    matchCriteriaId: generateMatchCriteriaId(),
                                    vulnerable: isVulnerable,
                                    versionStartIncluding: startVersion,
                                    versionEndExcluding: endVersion
                                });
                                
                                wildcardProcessed = true;
                            }
                        }
                    }
                }
                  // Handle wildcards in lessThanOrEqual
                if (!wildcardProcessed && versionInfo.lessThanOrEqual && String(versionInfo.lessThanOrEqual).includes('*')) {
                    hasWildcards = true;
                    const wildcard = versionInfo.lessThanOrEqual;
                    const prefix = wildcard.split('*')[0].replace(/\.$/, '');
                    const parts = prefix.split('.');
                    
                    if (parts.length >= 1) {
                        const majorVersion = parseInt(parts[0], 10);
                        
                        if (!isNaN(majorVersion)) {
                            const startVersion = versionInfo.version;
                            let endVersion;
                            
                            if (parts.length === 1) {
                                // Handle patterns like "5.*" -> next major version "6"
                                endVersion = `${majorVersion + 1}`;
                            } else if (parts.length >= 2) {
                                const minorVersion = parseInt(parts[1], 10);
                                if (!isNaN(minorVersion)) {
                                    // Handle patterns like "5.4.*" -> next minor version "5.5"
                                    endVersion = `${majorVersion}.${minorVersion + 1}`;
                                }
                            }
                              if (startVersion && endVersion) {
                                matches.push({
                                    criteria: cpeBase,
                                    matchCriteriaId: generateMatchCriteriaId(),
                                    vulnerable: isVulnerable,
                                    versionStartIncluding: startVersion,
                                    versionEndExcluding: endVersion
                                });
                                
                                wildcardProcessed = true;
                            }
                        }
                    }
                }
                
                // Handle wildcards in lessThan
                if (!wildcardProcessed && versionInfo.lessThan && String(versionInfo.lessThan).includes('*')) {
                    hasWildcards = true;
                    // TODO: Implement lessThan wildcard processing
                }
                
                // Handle global wildcard "*" in lessThanOrEqual
                if (!wildcardProcessed && versionInfo.lessThanOrEqual === "*") {
                    hasWildcards = true;
                    const startVersion = versionInfo.version;
                      if (startVersion) {
                        // For global wildcard, create an open-ended range starting from the version
                        matches.push({
                            criteria: cpeBase,
                            matchCriteriaId: generateMatchCriteriaId(),
                            vulnerable: isVulnerable,
                            versionStartIncluding: startVersion
                            // No versionEndExcluding - covers everything above this version
                        });
                        
                        wildcardProcessed = true;
                    }
                }
                
                // If no wildcard was processed, keep this version for other rules
                if (!wildcardProcessed) {
                    nonWildcardVersions.push(versionInfo);
                }
            }
              // If we found wildcards, process remaining non-wildcard versions through other rules
            if (hasWildcards && nonWildcardVersions.length > 0) {
                // Create a temporary version data with only non-wildcard versions
                const cleanVersionData = { ...versionData, versions: nonWildcardVersions };
                
                // Process each non-wildcard version individually
                for (const versionInfo of nonWildcardVersions) {
                    const isVulnerable = versionInfo.status === "affected";
                    const otherRulesResult = context.applyOtherRules(cpeBase, versionInfo, isVulnerable, ['wildcardExpansion']);
                    
                    if (otherRulesResult.processed) {
                        matches.push(...otherRulesResult.matches);
                    } else {
                        // Standard processing for non-wildcard versions
                        const cpeMatch = createCpeMatchFromVersionInfo(cpeBase, versionInfo, isVulnerable);
                        matches.push(cpeMatch);
                    }
                }
            }
            
            return { processed: hasWildcards, matches };
        }
    },

    /**
     * Version Changes Rule
     * Processes version.changes arrays for fix information
     */
    versionChanges: {
        name: 'Version Changes',
        description: 'Processes version.changes arrays for patches and fixes',
        
        shouldApply: (versionData, settings) => {
            return settings.enableVersionChanges && 
                   versionData.versions.some(v => 
                       v && v.changes && Array.isArray(v.changes) && v.changes.length > 0
                   );
        },
        
        process: (cpeBase, versionInfo, isVulnerable, context) => {
            const matches = [];
              if (versionInfo.changes && Array.isArray(versionInfo.changes)) {
                for (const change of versionInfo.changes) {
                    if (change.status === "fixed" && change.at) {
                        matches.push({
                            criteria: cpeBase,
                            matchCriteriaId: generateMatchCriteriaId(),
                            vulnerable: true,
                            versionStartIncluding: versionInfo.version,
                            versionEndExcluding: change.at
                        });
                    }
                }
                
                if (matches.length > 0) {
                    return { processed: true, matches };
                }
            }
            
            return { processed: false, matches: [] };
        }
    },

    /**
     * Inverse Status Rule
     * Handles defaultStatus=unaffected with explicit affected entries
     */
    inverseStatus: {
        name: 'Inverse Status Processing',
        description: 'Handles default unaffected status with specific affected versions',
        
        shouldApply: (versionData, settings) => {
            if (!settings.enableInverseStatus) return false;
            
            const hasDefaultUnaffected = versionData.defaultStatus === 'unaffected';
            const affectedVersions = versionData.versions.filter(v => v && v.status === 'affected');
            return hasDefaultUnaffected && affectedVersions.length > 0;        },
        
        // This rule processes the entire version dataset, not individual versions
        processDataset: (cpeBase, versionData, settings, context) => {
            const matches = [];
            const affectedVersions = versionData.versions.filter(v => v && v.status === 'affected');
            
            for (const affectedInfo of affectedVersions) {
                // Check if other rules should process this version first
                const otherRulesResult = context.applyOtherRules(cpeBase, affectedInfo, true, ['inverseStatus']);
                
                if (otherRulesResult.processed) {
                    matches.push(...otherRulesResult.matches);                } else {
                    // Standard processing for this affected version
                    const cpeMatch = createCpeMatchFromVersionInfo(cpeBase, affectedInfo, true);
                    matches.push(cpeMatch);
                }
            }
            
            return { processed: true, matches };
        }
    },

    /**
     * Mixed Status Rule
     * Handles complex combinations of affected and multiple unaffected versions
     */
    mixedStatus: {
        name: 'Mixed Status Processing',
        description: 'Handles complex affected/unaffected status combinations',
        
        shouldApply: (versionData, settings) => {
            if (!settings.enableMixedStatus) return false;
            
            const affectedVersions = versionData.versions.filter(v => v && v.status === 'affected');
            const unaffectedVersions = versionData.versions.filter(v => v && v.status === 'unaffected');
            return affectedVersions.length > 0 && unaffectedVersions.length > 1;
        },
          processDataset: (cpeBase, versionData, settings, context) => {
            const matches = [];
            const affectedVersions = versionData.versions.filter(v => v && v.status === 'affected');
            const unaffectedVersions = versionData.versions.filter(v => v && v.status === 'unaffected');
            
            // Process affected versions normally
            for (const affectedInfo of affectedVersions) {
                const otherRulesResult = context.applyOtherRules(cpeBase, affectedInfo, true, ['mixedStatus']);
                
                if (otherRulesResult.processed) {
                    matches.push(...otherRulesResult.matches);                } else {
                    const cpeMatch = createCpeMatchFromVersionInfo(cpeBase, affectedInfo, true);
                    matches.push(cpeMatch);
                }
            }
              // For mixed status, we might need gap processing between unaffected ranges
            if (settings.enableGapProcessing) {
                // This would integrate with the gap processing rule
            }
            
            return { processed: true, matches };
        }
    },    /**
     * Gap Processing Rule
     * Fills gaps between unaffected version ranges
     */
    gapProcessing: {
        name: 'Gap Processing',
        description: 'Fills gaps between unaffected version ranges to create affected ranges',
        
        shouldApply: (versionData, settings) => {
            if (!settings.enableGapProcessing) return false;
            
            // Gap processing is most valuable with default status "affected" and multiple unaffected ranges
            const hasDefaultAffected = versionData.defaultStatus === 'affected';
            const unaffectedVersions = versionData.versions.filter(v => v && v.status === 'unaffected');
            const hasMultipleUnaffected = unaffectedVersions.length >= 2;
            
            // Also check for range constraints (lessThan, lessThanOrEqual, etc.)
            const hasRangeConstraints = unaffectedVersions.some(v => 
                v && (v.lessThan || v.lessThanOrEqual || v.greaterThan || v.greaterThanOrEqual));
            
            return hasDefaultAffected && hasMultipleUnaffected && hasRangeConstraints;
        },
          processDataset: (cpeBase, versionData, settings, context) => {
            const matches = [];
            const unaffectedVersions = versionData.versions.filter(v => v && v.status === 'unaffected');
            const affectedVersions = versionData.versions.filter(v => v && v.status === 'affected');
            
            if (unaffectedVersions.length < 2) {
                return { processed: false, matches };
            }
            
            // Use the existing processGapsBetweenUnaffectedRanges implementation
            processGapsBetweenUnaffectedRanges(cpeBase, unaffectedVersions, affectedVersions, matches);
            
            if (matches.length > 0) {
                return { processed: true, matches };
            } else {
                return { processed: false, matches };
            }
        }
    },

    /**
     * Special Version Types Rule
     * Handles non-standard version types (dates, commits, etc.)
     */
    specialVersionTypes: {
        name: 'Special Version Types',
        description: 'Handles non-standard version types like dates and commits',
        
        shouldApply: (versionData, settings) => {
            if (!settings.enableSpecialVersionTypes) return false;
            
            return versionData.versions.some(v => 
                v && v.versionType && !['semver', 'string'].includes(v.versionType) && v.versionType !== 'git'
            );
        },
          process: (cpeBase, versionInfo, isVulnerable, context) => {
            // Skip wildcard versions if wildcard expansion is enabled
            if (context.settings.enableWildcardExpansion && 
                versionInfo.version && String(versionInfo.version).includes('*')) {
                return { processed: false, matches: [] };
            }
              if (versionInfo.versionType && !['semver', 'string'].includes(versionInfo.versionType)) {
                // Apply special handling based on version type
                const cpeMatch = createCpeMatchFromVersionInfo(cpeBase, versionInfo, isVulnerable);
                
                return { processed: true, matches: [cpeMatch] };
            }
            
            return { processed: false, matches: [] };
        }
    },    /**
     * Update Patterns Rule
     * Recognizes and processes patch/hotfix/service pack patterns
     */
    updatePatterns: {
        name: 'Update Patterns',
        description: 'Recognizes patch, hotfix, and service pack version patterns',
          shouldApply: (versionData, settings) => {
            if (!settings.enableUpdatePatterns) return false;
            
            const updatePatterns = [
                // Traditional patterns
                /alpha/i, /beta/i, /rc/i, /patch/i, /hotfix/i, /service[\s\-_]+pack/i, 
                /sp\d/i, /\.p\d/i, /\.sp\d/i, /hf\d/i, /update/i, /upd/i,
                
                // Space-separated patterns (common in CVE data)
                /\s+p\d+$/i, /\s+patch\s*\d+/i, /\s+sp\d+$/i, /\s+hotfix\s*\d+/i,
                /\s+update\s*\d+/i, /\s+beta\s*\d*/i, /\s+alpha\s*\d*/i, 
                /\s+rc\s*\d*/i, /\s+fix\s*\d+/i, /\s+revision\s*\d+/i, /\s+rev\s*\d+/i
            ];
            
            return versionData.versions.some(v => 
                v && v.version && updatePatterns.some(pattern => pattern.test(v.version))
            );
        },
          process: (cpeBase, versionInfo, isVulnerable, context) => {
            const version = versionInfo.version;
              // Enhanced pattern definitions with proper ordering (specific patterns first)
            const updatePatterns = [
                // Specific patterns first to avoid incorrect matches
                
                // SPACE-SEPARATED PATTERNS (for real-world CVE data formats)
                // These must come first as they're more specific than the general patterns below
                
                // Space-separated patch patterns (most common in CVE data)
                { pattern: /^(.+?)\s+p(\d+)$/i, type: 'patch' }, // Handle "3.0.0 p1", "3.1.0 p2"
                { pattern: /^(.+?)\s+patch\s*(\d+)$/i, type: 'patch' }, // Handle "3.3 Patch 1", "3.3 Patch 2"
                { pattern: /^(.+?)\s+Patch\s*(\d+)$/i, type: 'patch' }, // Handle "3.3 Patch 1" (capitalized)
                
                // Space-separated service pack patterns
                { pattern: /^(.+?)\s+sp(\d+)$/i, type: 'sp' }, // Handle "2.0.0 sp1"
                { pattern: /^(.+?)\s+service\s+pack\s*(\d+)$/i, type: 'sp' }, // Handle "2.0.0 service pack 1"
                { pattern: /^(.+?)\s+Service\s+Pack\s*(\d+)$/i, type: 'sp' }, // Handle "2.0.0 Service Pack 1"
                
                // Space-separated hotfix patterns
                { pattern: /^(.+?)\s+hotfix\s*(\d+)$/i, type: 'hotfix' }, // Handle "3.0.0 hotfix 1"
                { pattern: /^(.+?)\s+Hotfix\s*(\d+)$/i, type: 'hotfix' }, // Handle "3.0.0 Hotfix 1"
                { pattern: /^(.+?)\s+hf(\d+)$/i, type: 'hotfix' }, // Handle "3.0.0 hf1"
                
                // Space-separated update patterns
                { pattern: /^(.+?)\s+update\s*(\d+)$/i, type: 'update' }, // Handle "3.0.0 update 1"
                { pattern: /^(.+?)\s+Update\s*(\d+)$/i, type: 'update' }, // Handle "3.0.0 Update 1"
                { pattern: /^(.+?)\s+upd(\d+)$/i, type: 'update' }, // Handle "3.0.0 upd1"
                
                // Space-separated beta patterns
                { pattern: /^(.+?)\s+beta\s*(\d*)$/i, type: 'beta' }, // Handle "1.0.0 beta", "1.0.0 beta 1"
                { pattern: /^(.+?)\s+Beta\s*(\d*)$/i, type: 'beta' }, // Handle "1.0.0 Beta 1"
                { pattern: /^(.+?)\s+b(\d+)$/i, type: 'beta' }, // Handle "1.0.0 b1"
                
                // Space-separated alpha patterns
                { pattern: /^(.+?)\s+alpha\s*(\d*)$/i, type: 'alpha' }, // Handle "1.0.0 alpha", "1.0.0 alpha 1"
                { pattern: /^(.+?)\s+Alpha\s*(\d*)$/i, type: 'alpha' }, // Handle "1.0.0 Alpha 1"
                { pattern: /^(.+?)\s+a(\d+)$/i, type: 'alpha' }, // Handle "1.0.0 a1"
                
                // Space-separated release candidate patterns
                { pattern: /^(.+?)\s+rc\s*(\d*)$/i, type: 'rc' }, // Handle "1.0.0 rc", "1.0.0 rc 1"
                { pattern: /^(.+?)\s+RC\s*(\d*)$/i, type: 'rc' }, // Handle "1.0.0 RC 1"
                { pattern: /^(.+?)\s+release\s+candidate\s*(\d*)$/i, type: 'rc' }, // Handle "1.0.0 release candidate 1"
                { pattern: /^(.+?)\s+Release\s+Candidate\s*(\d*)$/i, type: 'rc' }, // Handle "1.0.0 Release Candidate 1"
                
                // Space-separated fix patterns
                { pattern: /^(.+?)\s+fix\s*(\d+)$/i, type: 'fix' }, // Handle "3.0.0 fix 1"
                { pattern: /^(.+?)\s+Fix\s*(\d+)$/i, type: 'fix' }, // Handle "3.0.0 Fix 1"
                
                // Space-separated revision patterns
                { pattern: /^(.+?)\s+revision\s*(\d+)$/i, type: 'revision' }, // Handle "3.0.0 revision 1"
                { pattern: /^(.+?)\s+Revision\s*(\d+)$/i, type: 'revision' }, // Handle "3.0.0 Revision 1"
                { pattern: /^(.+?)\s+rev\s*(\d+)$/i, type: 'revision' }, // Handle "3.0.0 rev 1"
                { pattern: /^(.+?)\s+Rev\s*(\d+)$/i, type: 'revision' }, // Handle "3.0.0 Rev 1"
                
                // TRADITIONAL DOT/DASH/UNDERSCORE PATTERNS (existing patterns)
                
                // Service pack patterns (most specific first)
                { pattern: /^(.+?)\.sp(\d+)$/i, type: 'sp' }, // Handle 3.0.0.sp1
                { pattern: /^(.+?)[\.\-_]*service[\s\-_]+pack[\.\-_]*(\d*)[\.\-_]*$/i, type: 'sp' },
                { pattern: /^(.+?)[\.\-_]*sp[\.\-_]*(\d+)[\.\-_]*$/i, type: 'sp' },
                
                // Patch patterns (handle p-notation specifically)
                { pattern: /^(.+?)\.p(\d+)$/i, type: 'patch' }, // Handle 3.1.0.p7
                { pattern: /^(.+?)[\.\-_]*patch[\.\-_]*(\d*)[\.\-_]*$/i, type: 'patch' },
                
                // Beta patterns (handle .1 notation specifically)
                { pattern: /^(.+?)-beta\.(\d+)$/i, type: 'beta' }, // Handle 1.0.0-beta.1
                { pattern: /^(.+?)[\.\-_]*beta[\.\-_]*(\d*)[\.\-_]*$/i, type: 'beta' },
                { pattern: /^(.+?)[\.\-_]*b[\.\-_]*(\d+)[\.\-_]*$/i, type: 'beta' },
                
                // Alpha patterns
                { pattern: /^(.+?)-alpha\.(\d+)$/i, type: 'alpha' }, // Handle 1.0.0-alpha.1
                { pattern: /^(.+?)[\.\-_]*alpha[\.\-_]*(\d*)[\.\-_]*$/i, type: 'alpha' },
                { pattern: /^(.+?)[\.\-_]*a[\.\-_]*(\d+)[\.\-_]*$/i, type: 'alpha' },
                
                // Release candidate patterns
                { pattern: /^(.+?)-rc\.(\d+)$/i, type: 'rc' }, // Handle 1.0.0-rc.1
                { pattern: /^(.+?)[\.\-_]*rc[\.\-_]*(\d*)[\.\-_]*$/i, type: 'rc' },
                { pattern: /^(.+?)[\.\-_]*release[\s\-_]+candidate[\.\-_]*(\d*)[\.\-_]*$/i, type: 'rc' },
                
                // Hotfix patterns (handle .2 notation specifically)
                { pattern: /^(.+?)-hotfix\.(\d+)$/i, type: 'hotfix' }, // Handle 2.1.0-hotfix.2
                { pattern: /^(.+?)[\.\-_]*hotfix[\.\-_]*(\d*)[\.\-_]*$/i, type: 'hotfix' },
                { pattern: /^(.+?)[\.\-_]*hf[\.\-_]*(\d+)[\.\-_]*$/i, type: 'hotfix' },
                
                // Patch patterns with specific numbering (handle .5 notation)
                { pattern: /^(.+?)-patch\.(\d+)$/i, type: 'patch' }, // Handle 2.0.0-patch.5
                
                // Update patterns
                { pattern: /^(.+?)[\.\-_]*update[\.\-_]*(\d*)[\.\-_]*$/i, type: 'update' },
                { pattern: /^(.+?)[\.\-_]*upd[\.\-_]*(\d+)[\.\-_]*$/i, type: 'update' },
                
                // Fix patterns
                { pattern: /^(.+?)[\.\-_]*fix[\.\-_]*(\d+)[\.\-_]*$/i, type: 'fix' },
                
                // Revision patterns
                { pattern: /^(.+?)[\.\-_]*revision[\.\-_]*(\d+)[\.\-_]*$/i, type: 'revision' },
                { pattern: /^(.+?)[\.\-_]*rev[\.\-_]*(\d+)[\.\-_]*$/i, type: 'revision' }
            ];
              for (const { pattern, type } of updatePatterns) {
                const match = version.match(pattern);
                if (match) {
                      // Extract base version and update component
                    const baseVersion = match[1].trim(); // Trim any trailing spaces
                    let updateNumber = match[2] || '';
                    
                    // Handle p-notation expansion (p7 -> patch7)
                    let finalType = type;
                    if (pattern.source.includes('\\.p(') && type === 'patch') {
                        // This is the p-notation pattern, already correct type
                        finalType = 'patch';
                    }
                    
                    // Clean and format the update component
                    let updateComponent;
                    if (updateNumber) {
                        // Remove any punctuation and spaces from the number and combine with type
                        const cleanNumber = updateNumber.replace(/[\.\-_,\s]/g, '');
                        updateComponent = `${finalType}${cleanNumber}`;
                    } else {
                        // Just use the type name if no number
                        updateComponent = finalType;                    }
                    
                    // Create modified CPE with update component
                    const cpeMatch = createCpeMatchWithUpdate(cpeBase, baseVersion, updateComponent, isVulnerable);
                    
                    return { processed: true, matches: [cpeMatch] };
                }
            }
            
            return { processed: false, matches: [] };
        }
    },

    /**
     * Multiple Branches Rule
     * Handles products with multiple version families (>=3 major.minor branches)
     */
    multipleBranches: {
        name: 'Multiple Branches',
        description: 'Handles products with multiple version families',
        
        shouldApply: (versionData, settings) => {
            if (!settings.enableMultipleBranches) return false;
            
            const versionBranches = new Set();
            versionData.versions.forEach(v => {
                if (v && v.version && typeof v.version === 'string') {
                    const parts = v.version.split('.');
                    if (parts.length >= 2) {
                        versionBranches.add(`${parts[0]}.${parts[1]}`);
                    }
                }
            });
            
            return versionBranches.size >= 3;
        },
        
        processDataset: (cpeBase, versionData, settings, context) => {
            const matches = [];
            const branchMap = new Map();
            
            // Group versions by branch
            versionData.versions.forEach(v => {
                if (v && v.version && typeof v.version === 'string') {
                    const parts = v.version.split('.');
                    if (parts.length >= 2) {
                        const branch = `${parts[0]}.${parts[1]}`;
                        if (!branchMap.has(branch)) {
                            branchMap.set(branch, []);
                        }
                        branchMap.get(branch).push(v);
                    }
                }            });
            
            // Process each branch separately
            for (const [branch, versions] of branchMap) {
                for (const versionInfo of versions) {
                    const isVulnerable = versionInfo.status === "affected";
                    const otherRulesResult = context.applyOtherRules(cpeBase, versionInfo, isVulnerable, ['multipleBranches']);
                      if (otherRulesResult.processed) {
                        matches.push(...otherRulesResult.matches);
                    } else {
                        const cpeMatch = createCpeMatchFromVersionInfo(cpeBase, versionInfo, isVulnerable);
                        matches.push(cpeMatch);
                    }
                }
            }
            
            return { processed: true, matches };
        }
    }
};

/**
 * Modular Rule Engine
 * Applies enabled rules in the correct order and handles rule interactions
 */
class ModularRuleEngine {
    constructor(settings, versionData) {
        this.settings = settings;
        this.versionData = versionData;        
        this.appliedRules = new Set();
        this.cachedApplicableRules = null;
        this.conflictAnalysisLogged = false;
        this.conflicts = [];
        this.skippedRules = [];
    }/**
     * Get all rules that should be applied based on settings and data
     */
    getApplicableRules() {
        // Return cached result if available
        if (this.cachedApplicableRules) {
            return this.cachedApplicableRules;
        }
        
        const applicable = [];
          for (const [ruleId, rule] of Object.entries(JSON_GENERATION_RULES)) {
            if (rule.shouldApply(this.versionData, this.settings)) {
                applicable.push({ id: ruleId, rule });
            }
        }
        
        // Detect potential rule conflicts (but only log once)
        this.detectRuleConflicts(applicable);
        
        // Cache the result
        this.cachedApplicableRules = applicable;
        
        return applicable;
    }    /**
     * Detect and warn about potential rule conflicts with enhanced analysis
     */
    detectRuleConflicts(applicableRules) {
        // Only perform conflict analysis once per instance
        if (this.conflictAnalysisLogged) {
            return;
        }
        
        const ruleNames = applicableRules.map(r => r.id);
        const conflicts = [];
        
        // Enhanced conflict patterns with detailed analysis
        const conflictPatterns = [
            {
                rules: ['mixedStatus', 'inverseStatus'],
                severity: 'HIGH',
                warning: 'Mixed Status and Inverse Status rules may overlap in processing affected versions',
                resolution: 'Will use priority order or cooperative processing if compatible'
            },
            {
                rules: ['updatePatterns', 'wildcardExpansion'],
                severity: 'MEDIUM',
                warning: 'Update Patterns and Wildcard Expansion may both process versioned patterns',
                resolution: 'Will apply per-version rules after dataset rules to avoid conflicts'
            },
            {
                rules: ['multipleBranches', 'mixedStatus'],
                severity: 'LOW',
                warning: 'Multiple Branches and Mixed Status may both process complex version datasets',
                resolution: 'Will use Branch-Aware Mixed Status cooperative processing'
            },
            {
                rules: ['gapProcessing', 'mixedStatus'],
                severity: 'LOW',
                warning: 'Gap Processing and Mixed Status may create overlapping version ranges',
                resolution: 'Will use Mixed Status with Gap Processing cooperative processing'
            },
            {
                rules: ['multipleBranches', 'gapProcessing'],
                severity: 'MEDIUM',
                warning: 'Multiple Branches and Gap Processing may create complex rule interactions',
                resolution: 'Will use priority order processing'
            },
            {
                rules: ['inverseStatus', 'gapProcessing'],
                severity: 'LOW',
                warning: 'Inverse Status and Gap Processing can work together effectively',
                resolution: 'Will use Inverse Status with Gap Processing cooperative processing'
            }        ];
        
        // Store conflicts for focused logging during rule application
        for (const pattern of conflictPatterns) {
            const hasAllRules = pattern.rules.every(rule => ruleNames.includes(rule));
            if (hasAllRules) {
                conflicts.push(pattern);
            }
        }
        
        // Mark that conflict analysis has been logged
        this.conflictAnalysisLogged = true;
    }

    /**
     * Log a summary of how rules will be applied
     */    /**
     * Apply other rules to a version (used by rules that need to delegate)
     */
    applyOtherRules(cpeBase, versionInfo, isVulnerable, excludeRules = []) {
        const availableRules = this.getApplicableRules().filter(({id}) => !excludeRules.includes(id));
        
        for (const {id, rule} of availableRules) {
            if (rule.process) {
                const result = rule.process(cpeBase, versionInfo, isVulnerable, this);
                if (result.processed) {
                    this.appliedRules.add(id);
                    return result;
                }
            }
        }
        
        return { processed: false, matches: [] };
    }

    /**
     * Process a single version through applicable rules
     */
    processVersion(cpeBase, versionInfo, isVulnerable) {
        const result = this.applyOtherRules(cpeBase, versionInfo, isVulnerable);
          if (!result.processed) {
            // No rules applied, use standard processing
            const cpeMatch = createCpeMatchFromVersionInfo(cpeBase, versionInfo, isVulnerable);
            return [cpeMatch];
        }
        
        return result.matches;
    }    /**
     * Process the entire dataset through dataset-level rules with cooperative processing
     */
    processDataset(cpeBase) {
        const datasetRules = this.getApplicableRules().filter(({rule}) => rule.processDataset);
        
        if (datasetRules.length === 0) {
            return null;
        }
          // Detect if we have multiple applicable dataset rules
        const ruleNames = datasetRules.map(r => r.rule.name);
        
        // Define rule coordination strategies
        const cooperativeRules = this.getCooperativeRuleGroups(datasetRules);
        
        if (cooperativeRules.length > 0) {
            // Use cooperative processing for compatible rule combinations
            return this.processCooperativeRules(cpeBase, cooperativeRules);        } else {
            // Use single rule processing with enhanced priority
            return this.processSingleDatasetRule(cpeBase, datasetRules);
        }
    }

    /**
     * Identify groups of rules that can work together cooperatively
     */
    getCooperativeRuleGroups(datasetRules) {
        const ruleIds = datasetRules.map(r => r.id);
        const cooperativeGroups = [];
        
        // Define compatible rule combinations that can work together
        const compatibleCombinations = [
            {
                name: 'Branch-Aware Mixed Status',
                rules: ['multipleBranches', 'mixedStatus'],
                strategy: 'branch_then_status',
                description: 'Process by branches first, then apply mixed status logic within each branch'
            },
            {
                name: 'Mixed Status with Gap Processing',
                rules: ['mixedStatus', 'gapProcessing'],
                strategy: 'status_then_gaps',
                description: 'Process mixed status first, then fill gaps between unaffected ranges'
            },
            {
                name: 'Inverse Status with Gap Processing',
                rules: ['inverseStatus', 'gapProcessing'],
                strategy: 'inverse_then_gaps',
                description: 'Process inverse status first, then fill gaps'
            }
        ];
          for (const combination of compatibleCombinations) {
            const hasAllRules = combination.rules.every(rule => ruleIds.includes(rule));
            if (hasAllRules) {
                const applicableRules = datasetRules.filter(r => combination.rules.includes(r.id));
                cooperativeGroups.push({
                    ...combination,
                    applicableRules
                });
            }
        }
        
        return cooperativeGroups;
    }

    /**
     * Process multiple rules cooperatively using defined strategies
     */    processCooperativeRules(cpeBase, cooperativeGroups) {
        // Use the first cooperative group found (could be enhanced to choose best match)
        const group = cooperativeGroups[0];
        
        switch (group.strategy) {
            case 'branch_then_status':
                return this.processBranchThenStatus(cpeBase, group.applicableRules);
            
            case 'status_then_gaps':
                return this.processStatusThenGaps(cpeBase, group.applicableRules);
            
            case 'inverse_then_gaps':
                return this.processInverseThenGaps(cpeBase, group.applicableRules);
            
            default:
                console.warn(`[Rule Engine] Unknown cooperative strategy: ${group.strategy}`);
                return this.processSingleDatasetRule(cpeBase, group.applicableRules);
        }
    }

    /**
     * Strategy: Process by branches first, then apply mixed status within each branch
     */
    processBranchThenStatus(cpeBase, rules) {
        const branchRule = rules.find(r => r.id === 'multipleBranches');
        const statusRule = rules.find(r => r.id === 'mixedStatus');
        
        if (!branchRule || !statusRule) {
            return this.processSingleDatasetRule(cpeBase, rules);
        }
        
        const matches = [];
        const branchMap = new Map();
        
        // Group versions by branch (from multipleBranches logic)
        this.versionData.versions.forEach(v => {
            if (v && v.version && typeof v.version === 'string') {
                const parts = v.version.split('.');
                if (parts.length >= 2) {
                    const branch = `${parts[0]}.${parts[1]}`;
                    if (!branchMap.has(branch)) {
                        branchMap.set(branch, []);
                    }
                    branchMap.get(branch).push(v);
                }
            }
        });
        
        // Apply mixed status processing within each branch
        for (const [branch, versions] of branchMap) {
            const branchAffected = versions.filter(v => v.status === 'affected');
            const branchUnaffected = versions.filter(v => v.status === 'unaffected');
            
            // Process each version in this branch
            for (const versionInfo of versions) {
                const isVulnerable = versionInfo.status === "affected";
                const otherRulesResult = this.applyOtherRules(cpeBase, versionInfo, isVulnerable, ['multipleBranches', 'mixedStatus']);
                
                if (otherRulesResult.processed) {
                    matches.push(...otherRulesResult.matches);
                } else {
                    const cpeMatch = createCpeMatchFromVersionInfo(cpeBase, versionInfo, isVulnerable);
                    matches.push(cpeMatch);
                }
            }
        }
        
        this.appliedRules.add('multipleBranches');
        this.appliedRules.add('mixedStatus');
        return matches;
    }

    /**
     * Strategy: Process mixed status first, then apply gap processing
     */
    processStatusThenGaps(cpeBase, rules) {
        const statusRule = rules.find(r => r.id === 'mixedStatus');
        const gapRule = rules.find(r => r.id === 'gapProcessing');
        
        if (!statusRule || !gapRule) {
            return this.processSingleDatasetRule(cpeBase, rules);
        }
        
        // First apply mixed status processing
        const statusResult = statusRule.rule.processDataset(cpeBase, this.versionData, this.settings, this);
        const matches = statusResult.processed ? [...statusResult.matches] : [];
        
        if (statusResult.processed) {
            this.appliedRules.add('mixedStatus');
            
            // Then apply gap processing to fill any gaps
            const gapResult = gapRule.rule.processDataset(cpeBase, this.versionData, this.settings, this);
            if (gapResult.processed && gapResult.matches.length > 0) {
                matches.push(...gapResult.matches);
                this.appliedRules.add('gapProcessing');
            }
        }
        
        return matches.length > 0 ? matches : null;
    }

    /**
     * Strategy: Process inverse status first, then apply gap processing
     */
    processInverseThenGaps(cpeBase, rules) {
        const inverseRule = rules.find(r => r.id === 'inverseStatus');
        const gapRule = rules.find(r => r.id === 'gapProcessing');
        
        if (!inverseRule || !gapRule) {
            return this.processSingleDatasetRule(cpeBase, rules);
        }
        
        // First apply inverse status processing
        const inverseResult = inverseRule.rule.processDataset(cpeBase, this.versionData, this.settings, this);
        const matches = inverseResult.processed ? [...inverseResult.matches] : [];
        
        if (inverseResult.processed) {
            this.appliedRules.add('inverseStatus');
            
            // Then apply gap processing
            const gapResult = gapRule.rule.processDataset(cpeBase, this.versionData, this.settings, this);
            if (gapResult.processed && gapResult.matches.length > 0) {
                matches.push(...gapResult.matches);
                this.appliedRules.add('gapProcessing');
            }
        }
        
        return matches.length > 0 ? matches : null;
    }    /**
     * Fallback: Process single dataset rule with priority order
     */
    processSingleDatasetRule(cpeBase, datasetRules) {
        const priorityOrder = ['wildcardExpansion', 'multipleBranches', 'mixedStatus', 'inverseStatus', 'gapProcessing'];
        const orderedRules = [];
        
        // Add rules in priority order first
        for (const priorityRule of priorityOrder) {
            const found = datasetRules.find(({id}) => id === priorityRule);
            if (found) {
                orderedRules.push(found);
            }
        }
        
        // Add any remaining rules
        for (const rule of datasetRules) {
            if (!orderedRules.find(({id}) => id === rule.id)) {
                orderedRules.push(rule);
            }
        }
        
        for (const {id, rule} of orderedRules) {
            const result = rule.processDataset(cpeBase, this.versionData, this.settings, this);
            
            if (result.processed) {
                this.appliedRules.add(id);
                return result.matches;
            }
        }
        
        return null; // No dataset rules applied
    }/**
     * Main processing entry point
     */    generateMatches(cpeBase) {
        const matches = [];
        
        // First, try dataset-level rules
        const datasetMatches = this.processDataset(cpeBase);
        if (datasetMatches) {
            matches.push(...datasetMatches);
            
            // Apply additional per-version rules that might modify the results
            const additionalMatches = this.processAdditionalVersionRules(cpeBase, datasetMatches);
            if (additionalMatches.length > 0) {
                matches.push(...additionalMatches);
            }
            
            // Deduplicate matches to prevent conflicts
            const deduplicatedMatches = this.deduplicateMatches(matches);
            if (deduplicatedMatches.length !== matches.length) {
                console.warn(`ModularRules: Removed ${matches.length - deduplicatedMatches.length} duplicate matches for ${cpeBase}`);
            }
            
            // Log conflicts and rule application issues
            this.logTroubleshootingInfo(cpeBase);
            
            return deduplicatedMatches;
        }        // Fall back to per-version processing
        for (const versionInfo of this.versionData.versions) {
            if (!versionInfo) continue;
            
            const isVulnerable = versionInfo.status === "affected";
            const versionMatches = this.processVersion(cpeBase, versionInfo, isVulnerable);
            matches.push(...versionMatches);
        }
        
        this.logTroubleshootingInfo(cpeBase);        return this.deduplicateMatches(matches);
    }

    /**
     * Log focused troubleshooting information for rule conflicts and precarious scenarios
     */
    logTroubleshootingInfo(cpeBase) {
        // Log rule conflicts with specific information about what was not applied
        if (this.conflicts.length > 0) {
            for (const conflict of this.conflicts) {
                if (conflict.severity === 'HIGH') {
                    console.warn(`ModularRules: Rule conflict for ${cpeBase} - ${conflict.rules.join(' vs ')} (${conflict.resolution})`);
                }
            }
        }
        
        // Log precarious scenarios only
        if (this.skippedRules.length > 0) {
            for (const skipped of this.skippedRules) {
                console.info(`ModularRules: ${skipped.rule} skipped for ${cpeBase} - ${skipped.reason}`);
            }
        }
        
        // Log if no rules were applied (potential data issue)
        if (this.appliedRules.size === 0) {
            console.warn(`ModularRules: No rules applied for ${cpeBase} - check version data format or settings`);
        }
    }

    /**
     * Remove duplicate matches that could be caused by rule conflicts
     */
    deduplicateMatches(matches) {
        const seen = new Set();
        const deduplicated = [];
        
        for (const match of matches) {
            // Create a unique key for this match based on critical properties
            const key = JSON.stringify({
                criteria: match.criteria,
                vulnerable: match.vulnerable,
                versionStartIncluding: match.versionStartIncluding,
                versionStartExcluding: match.versionStartExcluding,
                versionEndIncluding: match.versionEndIncluding,
                versionEndExcluding: match.versionEndExcluding
            });
            
            if (!seen.has(key)) {
                seen.add(key);
                deduplicated.push(match);
            } else {
            }
        }
        
        return deduplicated;
    }    /**
     * Process additional per-version rules with enhanced coordination
     */
    processAdditionalVersionRules(cpeBase, existingMatches) {
        const additionalMatches = [];
        
        // Get per-version rules that should still be applied after dataset processing
        const perVersionRules = this.getApplicableRules().filter(({ id, rule }) => 
            !rule.processDataset && 
            rule.process && 
            !this.appliedRules.has(id)
        );
        
        if (perVersionRules.length === 0) {
            return additionalMatches;
        }
        
        // Enhanced version tracking with more detailed analysis
        const processedVersions = this.analyzeProcessedVersions(existingMatches);
        const versionCoverage = this.calculateVersionCoverage(existingMatches);
        
        // Apply per-version rules with intelligent filtering
        for (const versionInfo of this.versionData.versions) {
            if (!versionInfo || !versionInfo.version) continue;
            
            const versionKey = this.createVersionKey(versionInfo);
            const shouldProcessVersion = this.shouldProcessAdditionalVersion(versionInfo, processedVersions, versionCoverage);
            
            if (!shouldProcessVersion) {
                continue;
            }
            
            const isVulnerable = versionInfo.status === "affected";
            
            for (const { id, rule } of perVersionRules) {
                // Check if this rule is appropriate for this version
                if (!this.isRuleApplicableToVersion(rule, versionInfo)) {
                    continue;
                }
                
                const result = rule.process(cpeBase, versionInfo, isVulnerable, this);
                if (result.processed && result.matches.length > 0) {
                    
                    // Filter out matches that would duplicate existing coverage
                    const uniqueMatches = this.filterDuplicateMatches(result.matches, existingMatches, additionalMatches);
                    additionalMatches.push(...uniqueMatches);
                    
                    this.appliedRules.add(id);
                    processedVersions.add(versionKey);
                    break; // Only apply first matching rule per version to avoid conflicts
                }
            }
        }
        
        return additionalMatches;
    }

    /**
     * Analyze which versions have been processed by dataset rules
     */
    analyzeProcessedVersions(existingMatches) {
        const processedVersions = new Set();
        
        for (const match of existingMatches) {
            // Extract all version identifiers from the match
            if (match.versionStartIncluding) {
                processedVersions.add(this.normalizeVersion(match.versionStartIncluding));
            }
            if (match.versionEndIncluding) {
                processedVersions.add(this.normalizeVersion(match.versionEndIncluding));
            }
            if (match.versionStartExcluding) {
                processedVersions.add(this.normalizeVersion(match.versionStartExcluding));
            }
            if (match.versionEndExcluding) {
                processedVersions.add(this.normalizeVersion(match.versionEndExcluding));
            }
            
            // Extract version from CPE criteria if present
            if (match.criteria) {
                const cpeVersion = match.criteria.split(':')[5];
                if (cpeVersion && cpeVersion !== '*') {
                    processedVersions.add(this.normalizeVersion(cpeVersion));
                }
            }
        }
        
        return processedVersions;
    }

    /**
     * Calculate what percentage of versions are covered by existing matches
     */
    calculateVersionCoverage(existingMatches) {
        const totalVersions = this.versionData.versions.length;
        const coveredVersions = new Set();
        const rangeMatches = [];
        const exactMatches = [];
        
        for (const match of existingMatches) {
            if (match.versionStartIncluding || match.versionStartExcluding || 
                match.versionEndIncluding || match.versionEndExcluding) {
                rangeMatches.push(match);
            } else {
                // Exact version match
                const cpeVersion = match.criteria?.split(':')[5];
                if (cpeVersion && cpeVersion !== '*') {
                    exactMatches.push(cpeVersion);
                    coveredVersions.add(this.normalizeVersion(cpeVersion));
                }
            }
        }
        
        // For range matches, estimate coverage by checking if versions fall within ranges
        for (const version of this.versionData.versions) {
            if (version && version.version) {
                const normalizedVersion = this.normalizeVersion(version.version);
                
                for (const rangeMatch of rangeMatches) {
                    if (this.isVersionInRange(normalizedVersion, rangeMatch)) {
                        coveredVersions.add(normalizedVersion);
                        break;
                    }
                }
            }
        }
        
        return {
            totalVersions,
            coveredVersions: coveredVersions.size,
            coveragePercentage: (coveredVersions.size / totalVersions) * 100,
            rangeMatches: rangeMatches.length,
            exactMatches: exactMatches.length,
            uncoveredVersions: totalVersions - coveredVersions.size
        };
    }

    /**
     * Determine if a version should be processed by additional rules
     */
    shouldProcessAdditionalVersion(versionInfo, processedVersions, versionCoverage) {
        const versionKey = this.createVersionKey(versionInfo);
        
        // Always skip if this exact version was already processed
        if (processedVersions.has(this.normalizeVersion(versionInfo.version))) {
            return false;
        }
        
        // Apply additional rules if coverage is low (less than 80%)
        if (versionCoverage.coveragePercentage < 80) {
            return true;
        }
        
        // Apply additional rules for special version types that might need specific handling
        if (versionInfo.versionType && !['semver', 'string'].includes(versionInfo.versionType)) {
            return true;
        }
        
        // Apply additional rules for versions with complex patterns
        if (this.hasComplexVersionPattern(versionInfo.version)) {
            return true;
        }
        
        return false;
    }

    /**
     * Check if a per-version rule is applicable to a specific version
     */
    isRuleApplicableToVersion(rule, versionInfo) {
        // Create a minimal version data context for the shouldApply check
        const versionContext = {
            versions: [versionInfo]
        };
        
        try {
            return rule.shouldApply(versionContext, this.settings);
        } catch (error) {
            console.warn(`[Rule Engine] Error checking rule applicability for ${rule.name}: ${error.message}`);
            return false;
        }
    }

    /**
     * Filter out matches that would duplicate existing coverage
     */
    filterDuplicateMatches(newMatches, existingMatches, additionalMatches) {
        const allMatches = [...existingMatches, ...additionalMatches];
        const uniqueMatches = [];
        
        for (const newMatch of newMatches) {
            let isDuplicate = false;
            
            for (const existingMatch of allMatches) {
                if (this.areMatchesEquivalent(newMatch, existingMatch)) {
                    isDuplicate = true;
                    break;
                }
            }
            
            if (!isDuplicate) {
                uniqueMatches.push(newMatch);
            } else {
            }
        }
        
        return uniqueMatches;
    }

    /**
     * Helper methods for version analysis
     */
    createVersionKey(versionInfo) {
        return `${versionInfo.version || 'unknown'}_${versionInfo.status || 'unknown'}_${versionInfo.versionType || 'default'}`;
    }

    normalizeVersion(version) {
        return String(version).toLowerCase().trim();
    }

    hasComplexVersionPattern(version) {
        if (!version) return false;
        
        const complexPatterns = [
            /\*/,                    // Wildcards
            /[a-zA-Z]/,             // Contains letters (alpha, beta, etc.)
            /\s+/,                  // Contains spaces
            /-[a-zA-Z]/,            // Dash followed by letters
            /\+/                    // Plus signs
        ];
        
        return complexPatterns.some(pattern => pattern.test(version));
    }

    isVersionInRange(version, rangeMatch) {
        // Simplified range checking - would need more sophisticated version comparison in practice
        try {
            if (rangeMatch.versionStartIncluding && version < rangeMatch.versionStartIncluding) {
                return false;
            }
            if (rangeMatch.versionStartExcluding && version <= rangeMatch.versionStartExcluding) {
                return false;
            }
            if (rangeMatch.versionEndIncluding && version > rangeMatch.versionEndIncluding) {
                return false;
            }
            if (rangeMatch.versionEndExcluding && version >= rangeMatch.versionEndExcluding) {
                return false;
            }
            return true;
        } catch (error) {
            return false;
        }
    }

    areMatchesEquivalent(match1, match2) {
        return JSON.stringify(this.normalizeMatchForComparison(match1)) === 
               JSON.stringify(this.normalizeMatchForComparison(match2));
    }

    normalizeMatchForComparison(match) {
        return {
            criteria: match.criteria,
            vulnerable: match.vulnerable,
            versionStartIncluding: match.versionStartIncluding,
            versionStartExcluding: match.versionStartExcluding,
            versionEndIncluding: match.versionEndIncluding,
            versionEndExcluding: match.versionEndExcluding
        };
    }
}

/**
 * Create a CPE match object with update component
 * @param {string} cpeBase - Base CPE string (e.g., "cpe:2.3:a:*:*:*:*:*:*:*:*:*")
 * @param {string} version - Base version (e.g., "2.0.0")
 * @param {string} update - Update component (e.g., "patch.5")
 * @param {boolean} isVulnerable - Whether this version is vulnerable
 * @returns {Object} CPE match object with proper update component
 */
function createCpeMatchWithUpdate(cpeBase, version, update, isVulnerable) {
    // Parse the base CPE to extract components
    const cpeComponents = cpeBase.split(':');
    
    // Ensure we have all 13 components for CPE 2.3 format
    // cpe:2.3:part:vendor:product:version:update:edition:language:sw_edition:target_sw:target_hw:other
    while (cpeComponents.length < 13) {
        cpeComponents.push('*');
    }
    
    // Set the version (position 5) and update (position 6) fields
    cpeComponents[5] = version || '*';     // version (base version without update)
    cpeComponents[6] = update || '*';      // update (patch/hotfix/sp component)
    
    const cpeString = cpeComponents.join(':');
    return {
        criteria: cpeString,
        matchCriteriaId: generateMatchCriteriaId(),
        vulnerable: isVulnerable
    };
}

/**
 * Helper functions for gap processing (from cpe_json_handler.js)
 */

/**
 * Compare two version strings
 * @param {string} versionA - First version
 * @param {string} versionB - Second version
 * @returns {number} Comparison result (-1, 0, 1)
 */
function compareVersions(versionA, versionB) {
    const aParts = versionA.split('.').map(part => parseInt(part, 10) || 0);
    const bParts = versionB.split('.').map(part => parseInt(part, 10) || 0);
    
    // Compare version components
    for (let i = 0; i < Math.max(aParts.length, bParts.length); i++) {
        const aVal = i < aParts.length ? aParts[i] : 0;
        const bVal = i < bParts.length ? bParts[i] : 0;
        
        if (aVal !== bVal) {
            return aVal - bVal;
        }
    }
    
    return 0;
}

/**
 * Increment a version string slightly
 * @param {string} version - Version string
 * @returns {string} Incremented version
 */
function incrementVersion(version) {
    if (!version) return version;
    
    // For semantic versions
    if (version.includes('.')) {
        const parts = version.split('.');
        const lastPart = parseInt(parts[parts.length - 1], 10);
        
        if (!isNaN(lastPart)) {
            parts[parts.length - 1] = (lastPart + 1).toString();
            return parts.join('.');
        }
    }
    
    // For simple integer versions
    const numVersion = parseInt(version, 10);
    if (!isNaN(numVersion)) {
        return (numVersion + 1).toString();
    }
    
    return version;
}

/**
 * Generate a unique match criteria ID
 * @returns {string} A unique match criteria ID
 */
function generateMatchCriteriaId() {
    return 'generated_' + Math.random().toString(36).substr(2, 9).toUpperCase();
}

/**
 * Process gaps between unaffected ranges to create affected ranges
 * @param {string} cpeBase - Base CPE string
 * @param {Array} unaffectedVersions - Array of unaffected version info objects
 * @param {Array} affectedVersions - Array of explicitly affected version info objects
 * @param {Array} cpeMatches - Array to add new cpeMatch objects to
 */
function processGapsBetweenUnaffectedRanges(cpeBase, unaffectedVersions, affectedVersions, cpeMatches) {
    
    // First, organize the unaffected versions by their starting version and ending version
    const unaffectedRanges = [];
    
    for (const info of unaffectedVersions) {
        let startVer, endVer;
        
        // Determine start version
        if (info.version) {
            startVer = info.version;
        } else if (info.greaterThanOrEqual) {
            startVer = info.greaterThanOrEqual;
        } else if (info.greaterThan) {
            startVer = incrementVersion(info.greaterThan);
        } else {
            startVer = "0"; // Default to beginning
        }
        
        // Determine end version - this is the end of the unaffected range
        if (info.lessThan) {
            endVer = info.lessThan;
        } else if (info.lessThanOrEqual && info.lessThanOrEqual === "*") {
            endVer = null; // Unlimited
        } else if (info.lessThanOrEqual && info.lessThanOrEqual.includes("*")) {
            // Handle wildcards like 5.4.*
            const wildcard = info.lessThanOrEqual;
            
            // Extract the numeric part (like "5.4" from "5.4.*")
            const versionBase = wildcard.split("*")[0].replace(/\.$/, '');
            const parts = versionBase.split(".");
            
            if (parts.length >= 2) {
                // For 5.4.*, the end of the unaffected range is 5.5
                const majorVersion = parseInt(parts[0], 10);
                const minorVersion = parseInt(parts[1], 10);
                
                if (!isNaN(majorVersion) && !isNaN(minorVersion)) {
                    endVer = `${majorVersion}.${minorVersion + 1}`;
                } else {
                    endVer = incrementVersion(versionBase);
                }
            } else {
                endVer = incrementVersion(versionBase);
            }
        } else if (info.lessThanOrEqual) {
            endVer = incrementVersion(info.lessThanOrEqual);
        } else {
            // Single version, so end is next version
            endVer = incrementVersion(startVer);
        }
        
        unaffectedRanges.push({ start: startVer, end: endVer });
    }
    
    // Sort the ranges by start version
    unaffectedRanges.sort((a, b) => compareVersions(a.start, b.start));
    unaffectedRanges.forEach((range, i) => {
    });
    
    // Now find the gaps between unaffected ranges
    // First, set up the initial lower bound
    let previousRange = null;
    
    // Handle the special case for patched versions first - before the main loop
    // This ensures we correctly handle cases where version 5.4 is marked affected but 5.4.277 is unaffected
    const patchVersionCandidates = unaffectedRanges.filter(range => 
        range.start.includes(".") && range.start.split(".").length > 2
    );
    
    for (const patchRange of patchVersionCandidates) {
        // Get the base version from the patched version (5.4 from 5.4.277)
        const startParts = patchRange.start.split('.');
        const baseVersion = (startParts.length >= 2) ? `${startParts[0]}.${startParts[1]}` : startParts[0];
        
        // Check if this base version matches an affected version
        const matchingAffected = affectedVersions.find(av => 
            av.version && (av.version === baseVersion || av.version.startsWith(baseVersion + "."))
        );
        
        if (matchingAffected) {
            
            // Create a non-vulnerable range from base to patched version (inclusive)
            cpeMatches.push({
                criteria: cpeBase,
                matchCriteriaId: generateMatchCriteriaId(),
                vulnerable: false,
                versionStartIncluding: baseVersion,
                versionEndIncluding: patchRange.start
            });
            
            // Create a vulnerable range from patched version (exclusive) to the next minor
            if (patchRange.end) {
                cpeMatches.push({
                    criteria: cpeBase,
                    matchCriteriaId: generateMatchCriteriaId(),
                    vulnerable: true,
                    versionStartExcluding: patchRange.start,
                    versionEndExcluding: patchRange.end
                });
            }
        }
    }
    
    // Main loop for processing gaps between unaffected ranges
    for (let i = 0; i < unaffectedRanges.length; i++) {
        const currentRange = unaffectedRanges[i];
        
        // If we have a previous range and there's a gap between
        if (previousRange && previousRange.end && compareVersions(previousRange.end, currentRange.start) < 0) {
            
            // Skip creating affected ranges for gaps that overlap with our patch handling above
            let shouldCreateGapRange = true;
            
            // Check if this gap starts with a base version (like 5.4) that has special patched handling
            for (const patchRange of patchVersionCandidates) {
                const startParts = patchRange.start.split('.');
                const baseVersion = (startParts.length >= 2) ? `${startParts[0]}.${startParts[1]}` : startParts[0];
                
                // If the start of this gap matches a base version we've already handled
                if (previousRange.end === baseVersion) {
                    shouldCreateGapRange = false;
                    break;
                }
            }
            
            // Only create the gap range if we didn't handle it as a patch case
            if (shouldCreateGapRange) {
                cpeMatches.push({
                    criteria: cpeBase,
                    matchCriteriaId: generateMatchCriteriaId(),
                    vulnerable: true,
                    versionStartIncluding: previousRange.end,
                    versionEndExcluding: currentRange.start
                });
            }
        }
        
        previousRange = currentRange;
    }
    
    // If the last range doesn't extend to infinity, add a final affected range
    if (previousRange && previousRange.end) {
        
        cpeMatches.push({
            criteria: cpeBase,
            matchCriteriaId: generateMatchCriteriaId(),
            vulnerable: true,
            versionStartIncluding: previousRange.end
        });    }
}

// =============================================================================
// Global Exports - All window assignments consolidated here
// =============================================================================
window.ModularRuleEngine = ModularRuleEngine;
window.JSON_GENERATION_RULES = JSON_GENERATION_RULES;
window.generateMatchCriteriaId = generateMatchCriteriaId;
window.compareVersions = compareVersions;
window.incrementVersion = incrementVersion;


/**
 * CPE JSON Handler
 * 
 * Handles generation of CPE match objects and JSON configurations.
 * Uses shared utility functions from modular_rules.js for version comparison and ID generation.
 */

/**
 * Ensure CPE string has standard format with enough components
 * @param {string} cpeBase - The CPE string to normalize
 * @returns {string} Normalized CPE string
 */
function normalizeCpeString(cpeBase) {
    if (!cpeBase) return "cpe:2.3:a:*:*:*:*:*:*:*:*:*";
    
    // Split the CPE into its components
    const parts = cpeBase.split(':');
    
    // Check if we have the basic structure (cpe:2.3:part)
    if (parts.length < 3) {
        console.error("Invalid CPE string format:", cpeBase);
        return "cpe:2.3:a:*:*:*:*:*:*:*:*:*";
    }
    
    // Ensure it has part:vendor:product components
    while (parts.length < 5) {
        parts.push('*');
    }
    
    // Ensure it has version component so we can replace it later
    if (parts.length < 6) {
        parts.push('*');
    }
    
    // For complete format, ensure it has all 13 parts
    while (parts.length < 13) {
        parts.push('*');
    }
    
    return parts.join(':');
}

/**
 * Creates a CPE match object for a given CPE base string
 * @param {string} cpeBase - The base CPE string
 * @returns {Object} A CPE match object
 */
function createCpeMatchObject(cpeBase) {
    // Normalize the base CPE string if needed
    cpeBase = normalizeCpeString(cpeBase);
    
    return {
        "criteria": cpeBase,
        "matchCriteriaId": generateMatchCriteriaId(),
        "vulnerable": true
    };
}

/**
 * Process version data into cpeMatch objects
 * @param {string} cpeBase - The base CPE string
 * @param {Object} rawPlatformData - Raw platform data
 * @param {string} tableId - Table identifier for settings
 * @returns {Array} Array of cpeMatch objects
 */
function processVersionDataToCpeMatches(cpeBase, rawPlatformData, tableId) {
    // Get table-specific settings instead of global
    const tableSettings = window.rowSettings.get(tableId) || {};
      // Use table settings with conservative defaults
    const settings = {
        enableWildcardExpansion: tableSettings.enableWildcardExpansion !== undefined ? tableSettings.enableWildcardExpansion : false,
        enableVersionChanges: tableSettings.enableVersionChanges !== undefined ? tableSettings.enableVersionChanges : false,
        enableSpecialVersionTypes: tableSettings.enableSpecialVersionTypes !== undefined ? tableSettings.enableSpecialVersionTypes : false,
        enableInverseStatus: tableSettings.enableInverseStatus !== undefined ? tableSettings.enableInverseStatus : false,
        enableMultipleBranches: tableSettings.enableMultipleBranches !== undefined ? tableSettings.enableMultipleBranches : false,
        enableMixedStatus: tableSettings.enableMixedStatus !== undefined ? tableSettings.enableMixedStatus : false,
        enableGapProcessing: tableSettings.enableGapProcessing !== undefined ? tableSettings.enableGapProcessing : false,
        enableUpdatePatterns: tableSettings.enableUpdatePatterns !== undefined ? tableSettings.enableUpdatePatterns : false,  
        // Core features remain enabled
        enableStatusProcessing: true,
        enableRangeHandling: true
    };
    
    console.debug(`Processing ${tableId} with settings:`, settings);
    
    // Normalize the base CPE string if needed
    cpeBase = normalizeCpeString(cpeBase);
    
    // **CUSTOM CPE HANDLING** - Check if this is a custom CPE first
    if (window.customCPEHandlers && window.customCPEHandlers.has(cpeBase)) {
        console.debug(`Processing custom CPE: ${cpeBase}`);
        
        // Check for missing rawPlatformData
        if (!rawPlatformData) {
            console.error(`CRITICAL: No rawPlatformData available for custom CPE ${cpeBase}. This may cause issues in JSON generation.`);
            // For custom CPEs without platform data, return the basic custom match
            const handler = window.customCPEHandlers.get(cpeBase);
            return [handler.createMatch()];
        }
        
        // Custom CPEs use the same modular rules engine with the same settings
        console.debug(`Applying modular rules to custom CPE: ${cpeBase}`);
    }
    
    // Check if we have valid version data (for both custom and standard CPEs)
    if (!rawPlatformData || !rawPlatformData.versions || !Array.isArray(rawPlatformData.versions) || rawPlatformData.versions.length === 0) {
        console.debug("No version data available, using basic CPE match");
        
        // For custom CPEs, use their handler to create the basic match
        if (window.customCPEHandlers && window.customCPEHandlers.has(cpeBase)) {
            const handler = window.customCPEHandlers.get(cpeBase);
            return [handler.createMatch()];
        }
        
        // For standard CPEs, use the standard basic match
        const basicMatch = createCpeMatchObject(cpeBase);
        return [basicMatch];
    }
    
    console.debug(`Processing ${rawPlatformData.versions.length} versions for ${cpeBase}`);
      // **MODULAR RULES ENGINE** - Primary approach for JSON generation (works for both custom and standard CPEs)
    if (window.ModularRuleEngine) {
        console.debug("Using modular rules engine for JSON generation");
        const ruleEngine = new window.ModularRuleEngine(settings, rawPlatformData);
        const matches = ruleEngine.generateMatches(cpeBase);
        
        if (matches.length > 0) {
            console.debug(`Modular rules engine generated ${matches.length} matches for ${cpeBase}`);
            return matches;
        } else {
            console.warn(`Modular rules engine returned no matches for ${cpeBase}. This may indicate:
                - No applicable rules for the version data structure
                - All rules were disabled in settings
                - Version data may be malformed or empty`);
            console.debug("Raw platform data:", JSON.stringify(rawPlatformData, null, 2));
            console.debug("Settings:", JSON.stringify(settings, null, 2));
            
            // Return basic match as last resort
            if (window.customCPEHandlers && window.customCPEHandlers.has(cpeBase)) {
                const handler = window.customCPEHandlers.get(cpeBase);
                return [handler.createMatch()];
            }
            
            const basicMatch = createCpeMatchObject(cpeBase);
            console.debug("Returning basic CPE match as fallback");
            return [basicMatch];
        }
    } else {
        console.error("Modular rules engine (ModularRuleEngine) is not loaded. This is a critical dependency.");
        console.error("Please ensure modular_rules.js is properly loaded before cpe_json_handler.js");
        
        // Return basic match to prevent complete failure
        if (window.customCPEHandlers && window.customCPEHandlers.has(cpeBase)) {
            const handler = window.customCPEHandlers.get(cpeBase);
            return [handler.createMatch()];
        }
        
        const basicMatch = createCpeMatchObject(cpeBase);
        console.debug("Returning basic CPE match due to missing modular rules engine");
        return [basicMatch];    }
}


/**
 * Process basic version data into a configuration object
 * @param {Set} selectedCPEs - Set of selected CPE base strings or DOM elements
 * @param {Object} rawPlatformData - Raw platform data
 * @param {string} tableId - Table identifier for settings
 * @returns {Object} Configuration object
 */
function processBasicVersionData(selectedCPEs, rawPlatformData, tableId) {
    const config = {
        "operator": "OR",
        "negate": false,
        "cpeMatch": []
    };
    
    // Store the tableIndex in rawPlatformData for reference
    if (rawPlatformData && !rawPlatformData.tableIndex && rawPlatformData.elementId) {
        // Extract table index from element ID if present
        const match = rawPlatformData.elementId.match(/rawPlatformData_(\d+)/);
        if (match && match[1]) {
            rawPlatformData.tableIndex = match[1];
        }
    }
    
    // Process each selected CPE
    selectedCPEs.forEach(cpeRow => {
        let cpeBase;
        
        // Check if cpeRow is a DOM element or a string
        if (typeof cpeRow === 'string') {
            cpeBase = cpeRow;
        } else if (cpeRow && typeof cpeRow.getAttribute === 'function') {
            cpeBase = cpeRow.getAttribute('data-cpe-base');
        } else {
            console.warn("Invalid CPE row type:", typeof cpeRow);
            return;
        }
        
        if (!cpeBase) {
            console.warn("No CPE base found for row:", cpeRow);
            return;
        }
          // Process version data into cpeMatch objects
        const cpeMatches = processVersionDataToCpeMatches(cpeBase, rawPlatformData, tableId);
        
        console.debug(`Generated ${cpeMatches.length} CPE matches for ${cpeBase}`);
        
        // Add all cpeMatches to the configuration
        config.cpeMatch.push(...cpeMatches);
    });
    
    return config;
}



/**
 * Process JSON based on source type
 * @param {Set} selectedCPEs - Set of selected CPE base strings
 * @param {Object} rawPlatformData - Raw platform data
 * @param {Object} metadata - Table metadata
 * @param {string} tableId - Table identifier for settings
 * @returns {Object} Generated JSON
 */
function processJsonBasedOnSource(selectedCPEs, rawPlatformData, metadata, tableId) {
    // Create a base structure WITHOUT the outer wrapper
    let configs = [];
    
    try {
        console.debug(`Processing JSON based on ${metadata.dataResource} source with ${selectedCPEs.size} selected CPEs`);
        
        // Check if we have embedded configuration (for NVD data)
        if (metadata.dataResource === 'NVDAPI' && rawPlatformData && rawPlatformData.rawConfigData) {
            // For NVD API data, we have the complete configuration
            console.debug("Using embedded NVD configuration");
            // Wrap in nodes array to match allConfigurations format
            configs.push({
                nodes: [rawPlatformData.rawConfigData]
            });
        } 
        // Regular version data processing
        else {            console.debug("Processing version data for CPEs");            // Process the basic version data
            const config = processBasicVersionData(selectedCPEs, rawPlatformData, tableId);

            // Wrap config in nodes array
            configs.push({
                nodes: [config]
            });
        }
        
        return configs;
    } catch (e) {
        console.error("Error processing JSON:", e);
        
        // Return an empty array as fallback
        return [];
    }
}



/**
 * Generate JSON with all configurations from all tables
 * @returns {Array} Array of configurations
 */
function generateAllConfigurationsJson() {
    try {
        const allConfigs = [];
        
        // Add debugging to inspect the consolidatedJsons content
        console.debug("generateAllConfigurationsJson - entries in consolidatedJsons:", consolidatedJsons.size);
        
        // Add each table's configuration directly to the allConfigs array
        consolidatedJsons.forEach((json, tableId) => {
            console.debug(`Checking table ${tableId}, json type: ${typeof json}, is array: ${Array.isArray(json)}, length: ${json ? (Array.isArray(json) ? json.length : 'not array') : 'null'}`);
            
            // If json is not what we expect, log for debugging
            if (json && !Array.isArray(json)) {
                console.debug("Unexpected json structure:", JSON.stringify(json).substring(0, 200) + "...");
            }
            
            // If table has valid JSON, add all configs from this table
            if (json && Array.isArray(json) && json.length > 0) {
                // Each configuration is already properly structured with a nodes array,
                // so we can add them directly to allConfigs without additional wrapping
                json.forEach(config => {
                    allConfigs.push(config);
                });
                console.debug(`Added ${json.length} configs to allConfigs from table ${tableId}`);
            }
        });
        
        console.debug(`Total configurations in allConfigs: ${allConfigs.length}`);
        return allConfigs;
    } catch(e) {
        console.error("Error generating all configurations JSON:", e);
        return [];  // Return empty array as fallback
    }
}


/**
 * Extract metadata and rawPlatformData from the row data table
 * @param {string|number} tableIndex - Index of the table
 * @returns {Object} Extracted data including metadata and rawPlatformData
 */
function extractDataFromTable(tableIndex) {
    // Default metadata
    const result = {
        metadata: {
            dataResource: "Unknown",
            sourceId: "Unknown", 
            sourceRole: "Unknown"
        },
        rawPlatformData: null
    };
    
    // Get the row data table
    const rowDataTable = document.getElementById(`rowDataTable_${tableIndex}`);
    
    if (rowDataTable) {
        // Get all rows in the table
        const rows = rowDataTable.querySelectorAll('tr');
        
        // Process the first three rows to extract metadata
        for (let i = 0; i < rows.length && i < 3; i++) {
            const cells = rows[i].querySelectorAll('td');
            if (cells.length >= 2) {
                const labelCell = cells[0];
                const valueCell = cells[1];
                
                // Extract data source from first row
                if (i === 0 && labelCell.textContent.trim() === "Data Resource") {
                    result.metadata.dataResource = valueCell.textContent.trim();
                    console.debug(`Found dataResource: ${result.metadata.dataResource}`);
                }
                
                // Extract source ID from second row
                else if (i === 1 && labelCell.textContent.trim() === "Source ID") {
                    const spanWithTitle = valueCell.querySelector('span[title]');
                    if (spanWithTitle) {
                        const titleText = spanWithTitle.getAttribute('title');
                        console.debug(`Source ID title text: "${titleText}"`);
                        
                        // Match pattern: "Source Identifiers: something, UUID"
                        const uuidPattern = /Source Identifiers:.*?([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})/i;
                        const match = titleText.match(uuidPattern);
                        
                        if (match && match[1]) {
                            result.metadata.sourceId = match[1];
                            console.debug(`Found sourceId UUID: ${result.metadata.sourceId}`);
                        } else {
                            // If no UUID found, use the text content as fallback
                            result.metadata.sourceId = valueCell.textContent.trim();
                            console.debug(`UUID not found in title, using text as sourceId: ${result.metadata.sourceId}`);
                        }
                    } else {
                        // No span with title, just use the text content
                        result.metadata.sourceId = valueCell.textContent.trim();
                        console.debug(`No title attribute found, using text as sourceId: ${result.metadata.sourceId}`);
                    }
                }
                
                // Extract source role from third row
                else if (i === 2 && labelCell.textContent.trim() === "Source Role") {
                    result.metadata.sourceRole = valueCell.textContent.trim();
                    console.debug(`Found sourceRole: ${result.metadata.sourceRole}`);
                }
            }
        }
        
        // Direct access by ID for rawPlatformData - simple and reliable
        const rawDataElement = document.getElementById(`rawPlatformData_${tableIndex}`);
        if (rawDataElement && rawDataElement.textContent) {
            try {
                result.rawPlatformData = JSON.parse(rawDataElement.textContent);
                console.debug(`Raw platform data found for table ${tableIndex}`);
            } catch (parseError) {
                console.error(`Error parsing raw platform data for table ${tableIndex}:`, parseError);
            }
        } else {
            console.debug(`No raw platform data element found with ID rawPlatformData_${tableIndex}`);
        }
    } else {
        console.debug(`Row data table not found for index ${tableIndex}`);    }
    
    return result;
}

/**
 * Create a CPE match object from version info
 * @param {string} cpeBase - Base CPE string
 * @param {Object} versionInfo - Version info object
 * @param {boolean} isVulnerable - Vulnerability status
 * @returns {Object} CPE match object
 */
function createCpeMatchFromVersionInfo(cpeBase, versionInfo, isVulnerable) {
    // Check for "n/a" and similar values that should be treated like wildcards
    const nonSpecificVersions = ["n/a", "not available", "not applicable", "unavailable", "na", "nil", "none", "*"];
    
    // Handle single version with no range indicators
    if (versionInfo.version && !versionInfo.lessThan && !versionInfo.lessThanOrEqual && 
        !versionInfo.greaterThan && !versionInfo.greaterThanOrEqual) {
        
        // Special case: If version is a wildcard or n/a value, keep the wildcard in the criteria
        if (nonSpecificVersions.includes(versionInfo.version.toLowerCase())) {
            return {
                "criteria": cpeBase, // Keep base CPE with wildcard intact
                "matchCriteriaId": generateMatchCriteriaId(),
                "vulnerable": isVulnerable
            };
        }
        
        // Create a CPE match with explicit version embedded in the criteria
        const cpeParts = cpeBase.split(':');
        // Apply formatCPEComponent to properly encode the version
        cpeParts[5] = window.formatCPEComponent ? 
            window.formatCPEComponent(versionInfo.version) : 
            versionInfo.version; // Replace wildcard with encoded version
        
        return {
            "criteria": cpeParts.join(':'),
            "matchCriteriaId": generateMatchCriteriaId(),
            "vulnerable": isVulnerable
        };
    } else {
        // Range specification with potential wildcards
        const cpeMatch = {
            "criteria": cpeBase,
            "matchCriteriaId": generateMatchCriteriaId(),
            "vulnerable": isVulnerable
        };
        
        // Handle start version (lower bound)
        // If version is a wildcard or n/a value, don't include any start version constraint
        const hasNonSpecificStartVersion = versionInfo.version && nonSpecificVersions.includes(versionInfo.version.toLowerCase());
        if (versionInfo.version && !hasNonSpecificStartVersion) {
            cpeMatch.versionStartIncluding = window.formatCPEComponent ? 
                window.formatCPEComponent(versionInfo.version) : 
                versionInfo.version;
        } else if (versionInfo.greaterThan) {
            cpeMatch.versionStartExcluding = window.formatCPEComponent ? 
                window.formatCPEComponent(versionInfo.greaterThan) : 
                versionInfo.greaterThan;
        } else if (versionInfo.greaterThanOrEqual) {
            cpeMatch.versionStartIncluding = window.formatCPEComponent ? 
                window.formatCPEComponent(versionInfo.greaterThanOrEqual) : 
                versionInfo.greaterThanOrEqual;
        }
        
        // Handle end version (upper bound)
        // If lessThan/lessThanOrEqual is a wildcard or n/a value, don't include any end version constraint
        const hasNonSpecificLessThan = versionInfo.lessThan && nonSpecificVersions.includes(versionInfo.lessThan.toLowerCase());
        const hasNonSpecificLessThanOrEqual = versionInfo.lessThanOrEqual && nonSpecificVersions.includes(versionInfo.lessThanOrEqual.toLowerCase());
        
        if (versionInfo.lessThan && !hasNonSpecificLessThan) {
            cpeMatch.versionEndExcluding = window.formatCPEComponent ?                window.formatCPEComponent(versionInfo.lessThan) : 
                versionInfo.lessThan;
        } else if (versionInfo.lessThanOrEqual && !hasNonSpecificLessThanOrEqual) {
            cpeMatch.versionEndIncluding = window.formatCPEComponent ? 
                window.formatCPEComponent(versionInfo.lessThanOrEqual) : 
                versionInfo.lessThanOrEqual;
        }
        
        return cpeMatch;
    }
}

/**
 * Handle settings changes for a specific row (matchesTable)
 * @param {string} tableId - Table identifier (e.g., "matchesTable_0")
 */
function onRowSettingsChange(tableId) {
    const settingsKey = tableId;
    const rowSettings = window.rowSettings.get(settingsKey);
    console.debug(`Row settings changed for ${settingsKey}:`, rowSettings);
    
    // Regenerate JSON for this specific table if it has selections
    const selectedRows = window.tableSelections.get(tableId);
    if (selectedRows && selectedRows.size > 0) {
        updateConsolidatedJson(tableId);
    }
}

// =============================================================================
// Global Exports - All window assignments consolidated here
// =============================================================================
// Global maps to store selections and generated JSONs
window.tableSelections = window.tableSelections || new Map();
window.consolidatedJsons = window.consolidatedJsons || new Map();
window.rowSettings = window.rowSettings || new Map();

// Export functions for integration with other modules
window.normalizeCpeString = normalizeCpeString;
window.createCpeMatchObject = createCpeMatchObject;
window.processJsonBasedOnSource = processJsonBasedOnSource;



/**
 * UI Controller - Handles display updates and UI interactions
 */

/**
 * Count total CPE matches in a configuration
 * @param {Object} config - Configuration object
 * @returns {number} Count of CPE matches
 */
function getTotalCPEMatches(config) {
    let count = 0;
    if (config.nodes) {
        for (const node of config.nodes) {
            if (node.cpeMatch) {
                count += node.cpeMatch.length;
            }
        }
    } else if (config.cpeMatch) {
        count = config.cpeMatch.length;
    }
    return count;
}

/**
 * Get statistics string from JSON
 * @param {Object} json - The JSON to extract statistics from
 * @param {number} selectionCount - Number of selected items as fallback
 * @returns {string} Formatted statistics string
 */
function getStatisticsString(json, selectionCount) {
    if (!json || !json.configurations || !json.configurations.length || !json.configurations[0]) {
        return `${selectionCount} selected`;
    }
    
    // Get statistics from generatorData.matchStats
    if (json.configurations[0].generatorData && json.configurations[0].generatorData.matchStats) {
        const stats = json.configurations[0].generatorData.matchStats;
        return `${stats.selectedCriteria} Criteria, ${stats.totalMatches} versions` +
               ` (${stats.exactMatches} exact, ${stats.rangeMatches} ranges)`;
    }
    
    // Fallback to simple count
    return `${selectionCount} selected`;
}

// =============================================================================

/**
 * Update JSON display if it's currently visible
 * @param {string} tableId - ID of the table
 */
function updateJsonDisplayIfVisible(tableId) {
    try {
        const display = document.getElementById(`consolidatedJsonDisplay_${tableId}`);
        const content = document.getElementById(`consolidatedJsonContent_${tableId}`);
        
        // Use class check instead of style.display
        if (display && content && !display.classList.contains('collapsed')) {
            const selectedRows = tableSelections.get(tableId);
            const selectionCount = selectedRows ? selectedRows.size : 0;
            
            if (!selectedRows || selectedRows.size === 0) {
                content.textContent = 'No rows selected. Please select at least one row.';
                return;
            }
            
            // Get the consolidated JSON for this table
            const json = consolidatedJsons.get(tableId);
            
            if (json) {
                // json is now already an array, so just stringify it
                content.textContent = JSON.stringify(json, null, 2);
                
                // Add copy button if it doesn't exist
                if (!document.getElementById(`copyButton_${tableId}`)) {
                    const copyButton = document.createElement('button');
                    copyButton.id = `copyButton_${tableId}`;
                    copyButton.className = 'btn btn-sm btn-outline-secondary copy-button';
                    copyButton.innerHTML = '<i class="fas fa-copy"></i> Copy to Clipboard';
                    copyButton.onclick = function() { 
                        copyToClipboard(content.textContent, `copyButton_${tableId}`);
                    };
                    // Insert before the pre element
                    display.insertBefore(copyButton, content);
                }
            } else {
                content.textContent = 'No selections or error generating JSON.';
            }
            
            // Also update the button text
            updateJsonDisplay(tableId, json, selectionCount);
        }
    } catch(e) {
        console.error(`Error updating JSON display for table ${tableId}:`, e);
    }
}

/**
 * Update the JSON display and button based on the content
 * @param {string} tableId - ID of the table
 * @param {Object} json - The JSON to display
 * @param {number} selectionCount - Number of selected items
 */
function updateJsonDisplay(tableId, json, selectionCount) {
    try {
        const display = document.getElementById(`consolidatedJsonDisplay_${tableId}`);
        const content = document.getElementById(`consolidatedJsonContent_${tableId}`);
        const showButton = document.getElementById(`showConsolidatedJson_${tableId}`);
        
        if (display && content) {
            // Check if the display is already visible
            const isVisible = !display.classList.contains('collapsed');
            
            // Update the content
            if (json) {
                content.textContent = JSON.stringify(json, null, 2);
            } else {
                content.textContent = 'No selections or error generating JSON.';
            }
            
            // Update button text if it's found
            if (showButton) {
                // Get statistics string
                const statsStr = getStatisticsString(json, selectionCount);
                
                showButton.textContent = isVisible 
                    ? `Hide Consolidated JSON (${statsStr})` 
                    : `Show Consolidated JSON (${statsStr})`;
                
                // Update button styling
                if (isVisible) {
                    showButton.classList.remove('btn-primary');
                    showButton.classList.add('btn-success');
                } else {
                    showButton.classList.remove('btn-success');
                    showButton.classList.add('btn-primary');
                }
            }
        }
    } catch(e) {
        console.error(`Error updating JSON display for table ${tableId}:`, e);
    }
}

/**
 * Update the Export All Configurations button
 */
function updateExportAllButton() {
    try {
        // Check if any tables have selected rows
        let hasSelections = false;
        let totalSelections = 0;
        let configCount = 0;
        let configDetails = [];
        let totalVersions = 0;
        
        tableSelections.forEach((selections, tableId) => {
            if (selections.size > 0) {
                hasSelections = true;
                totalSelections += selections.size;
                configCount++;
                
                // Get version count from this table's JSON if available
                const json = consolidatedJsons.get(tableId);
                if (json && json.configurations && json.configurations.length > 0) {
                    const versionCount = json.configurations[0].cpeMatch.length;
                    configDetails.push(`${selections.size} Criteria, ${versionCount} versions`);
                    totalVersions += versionCount;
                } else {
                    configDetails.push(`${selections.size} criteria`);
                    totalVersions += selections.size; // Assume 1 version per Criteria if no detailed data
                }
            }
        });
        
        const container = document.getElementById('allConfigurationsContainer');
        const exportButton = document.getElementById('exportAllConfigurations');
        const configSummary = document.getElementById('configurationSummary');
        
        if (container && exportButton && configSummary) {
            // Always enable/disable the button based on selections
            exportButton.disabled = !hasSelections;
            
            if (hasSelections) {
                const display = document.getElementById('allConfigurationsDisplay');
                
                // Format the config summary
                const summaryText = `${configCount} config${configCount !== 1 ? 's' : ''} (${configDetails.join(', ')})`;
                
                // Update the summary text
                configSummary.textContent = summaryText;
                
                // Keep button text simple - just show/hide state
                exportButton.textContent = display && !display.classList.contains('collapsed') ? 
                    'Hide All Configurations' : 'Show All Configurations';
            } else {
                // No selections in any table
                configSummary.textContent = 'No CPEs selected yet';
                exportButton.textContent = 'Show All Configurations';
            }
            
            // Ensure the display is updated if it's open
            updateAllConfigurationsDisplay();
        }
    } catch(e) {
        console.error("Error updating export all button:", e);
    }
}

/**
 * Update the all configurations display
 */
function updateAllConfigurationsDisplay() {
    try {
        const display = document.getElementById('allConfigurationsDisplay');
        const content = document.getElementById('allConfigurationsContent');
        
        if (!display || !content) {
            console.warn('Could not find allConfigurations display elements');
            return;
        }
        
        // Check if display is currently visible
        const isDisplayVisible = !display.classList.contains('collapsed');
        if (!isDisplayVisible) return;
        
        // Generate all configurations JSON
        const allConfigs = generateAllConfigurationsJson();
        
        // Make sure we have configurations to display
        if (allConfigs && allConfigs.length > 0) {
            content.textContent = JSON.stringify(allConfigs, null, 2);
            
            // Add buttons container if it doesn't exist
            let buttonsContainer = document.getElementById('allConfigButtonsContainer');
            if (!buttonsContainer) {
                buttonsContainer = document.createElement('div');
                buttonsContainer.id = 'allConfigButtonsContainer';
                buttonsContainer.className = 'mb-2';
                // Insert before the pre element
                display.insertBefore(buttonsContainer, content);
                
                // Add copy button
                const copyButton = document.createElement('button');
                copyButton.id = 'copyAllConfigsButton';
                copyButton.className = 'btn btn-sm btn-outline-secondary me-2';
                copyButton.innerHTML = '<i class="fas fa-copy"></i> Copy to Clipboard';
                copyButton.onclick = function() { 
                    copyToClipboard(content.textContent, 'copyAllConfigsButton');
                };
                buttonsContainer.appendChild(copyButton);
                
                // Add export button
                const exportButton = document.createElement('button');
                exportButton.id = 'exportAllConfigsButton';
                exportButton.className = 'btn btn-sm btn-outline-primary';
                exportButton.innerHTML = '<i class="fas fa-download"></i> Export to File';
                exportButton.onclick = function() { 
                    exportToFile(content.textContent);
                };
                buttonsContainer.appendChild(exportButton);
            }
            
            // Update configuration summary with count of configurations
            const summary = document.getElementById('configurationSummary');
            if (summary) {
                let totalCPEMatches = 0;
                allConfigs.forEach(config => {
                    totalCPEMatches += getTotalCPEMatches(config);
                });
                
                summary.textContent = `${allConfigs.length} configurations with ${totalCPEMatches} total matches`;
            }
        } else {
            content.textContent = 'No configurations available. Please select rows from tables.';
        }
    } catch(e) {
        console.error('Error updating all configurations display:', e);
    }
}

/**
 * Copy content to clipboard and show feedback
 * @param {string} text - Text to copy
 * @param {string} buttonId - ID of button that was clicked
 */
function copyToClipboard(text, buttonId) {
    try {
        navigator.clipboard.writeText(text).then(() => {
            // Show success feedback on button
            const button = document.getElementById(buttonId);
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fas fa-check"></i> Copied!';
            button.classList.add('btn-success');
            button.classList.remove('btn-outline-secondary');
            
            // Reset button after delay
            setTimeout(() => {
                button.innerHTML = originalText;
                button.classList.remove('btn-success');
                button.classList.add('btn-outline-secondary');
            }, 2000);
        }).catch(err => {
            console.error('Could not copy text: ', err);
        });
    } catch(e) {
        console.error('Error copying to clipboard:', e);
    }
}

/**
 * Export JSON content to file
 * @param {string} content - Content to export
 */
function exportToFile(content) {
    try {
        // Get CVE ID directly from the element with id "cve-id"
        let cveId = "config";
        const cveElement = document.getElementById("cve-id");
        
        if (cveElement && cveElement.textContent) {
            cveId = cveElement.textContent.trim();
        }
        
        // Create blob and download link
        const blob = new Blob([content], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        
        const link = document.createElement('a');
        link.href = url;
        link.download = `${cveId}-configurations.json`;
        document.body.appendChild(link);
        link.click();
        
        // Clean up
        setTimeout(() => {
            URL.revokeObjectURL(url);
            document.body.removeChild(link);
        }, 100);
    } catch(e) {
        console.error('Error exporting to file:', e);
    }
}

// =============================================================================
// Global Exports - All window assignments consolidated here
// =============================================================================
window.getTotalCPEMatches = getTotalCPEMatches;
window.getStatisticsString = getStatisticsString;

/**
 * Function to handle tab navigation
 * @param {Event} evt - The click event
 * @param {string} tabName - The ID of the tab to open
 */
function openCity(evt, cityName) {
    let tabcontent = document.getElementsByClassName("tabcontent");
    for (let i = 0; i < tabcontent.length; i++) {
        tabcontent[i].classList.add('d-none');
    }
    
    let tablinks = document.getElementsByClassName("tablinks");
    for (let i = 0; i < tablinks.length; i++) {
        tablinks[i].classList.remove("active");
    }
    
    document.getElementById(cityName).classList.remove('d-none');
    evt.currentTarget.classList.add("active");
}



/**
 * Function to toggle row collapse state
 * @param {number} tableIndex - Index of the table
 * @param {string} action - Optional action: 'complete' or 'skip' 
 */
function toggleRowCollapse(tableIndex, action) {
    try {
        const rowDataTableContainer = document.getElementById(`rowDataTable_${tableIndex}_container`);
        const matchesTableContainer = document.getElementById(`matchesTable_${tableIndex}_container`);
        const collapseButton = document.getElementById(`collapseRowButton_${tableIndex}`);
        
        // Add arrow icon toggle for CPE Suggestions card
        const cpeHeaderArrow = document.querySelector(`#cpeHeader_${tableIndex} .arrow-icon`);
        const provenanceHeaderArrow = document.querySelector(`#provenanceHeader_${tableIndex} .arrow-icon`);
        
        if (rowDataTableContainer && matchesTableContainer && collapseButton) {
            // Check if currently collapsed
            const isCollapsed = rowDataTableContainer.classList.contains('collapsed');
            
            if (isCollapsed) {
                // Expand tables
                rowDataTableContainer.classList.remove('collapsed');
                matchesTableContainer.classList.remove('collapsed');
                
                // Also remove status classes when expanding
                rowDataTableContainer.classList.remove('completed-row');
                rowDataTableContainer.classList.remove('skipped-row');
                
                // Recreate the dropdown button and menu
                const btnGroup = collapseButton.closest('.btn-group') || collapseButton.parentNode;
                
                // Clear existing content
                if (btnGroup) {
                    btnGroup.innerHTML = '';
                    
                    // Create main button
                    const mainButton = document.createElement('button');
                    mainButton.id = `collapseRowButton_${tableIndex}`;
                    mainButton.className = 'btn btn-secondary dropdown-toggle btn-transition';
                    mainButton.innerHTML = 'Collapse Row <span class="caret"></span>';
                    mainButton.setAttribute('data-bs-toggle', 'dropdown');
                    mainButton.setAttribute('aria-haspopup', 'true');
                    mainButton.setAttribute('aria-expanded', 'false');
                    btnGroup.appendChild(mainButton);
                    
                    // Create dropdown menu
                    const dropdownMenu = document.createElement('ul');
                    dropdownMenu.className = 'dropdown-menu';
                    
                    // Create menu items
                    const completeItem = document.createElement('li');
                    const completeLink = document.createElement('a');
                    completeLink.className = 'dropdown-item';
                    completeLink.href = '#';
                    completeLink.textContent = 'Mark as Complete';
                    completeLink.onclick = function(e) {
                        e.preventDefault();
                        toggleRowCollapse(tableIndex, 'complete');
                    };
                    completeItem.appendChild(completeLink);
                    
                    const skipItem = document.createElement('li');
                    const skipLink = document.createElement('a');
                    skipLink.className = 'dropdown-item';
                    skipLink.href = '#';
                    skipLink.textContent = 'Mark as Skip';
                    skipLink.onclick = function(e) {
                        e.preventDefault();
                        toggleRowCollapse(tableIndex, 'skip');
                    };
                    skipItem.appendChild(skipLink);
                    
                    // Add items to menu
                    dropdownMenu.appendChild(completeItem);
                    dropdownMenu.appendChild(skipItem);
                      // Add menu to group
                    btnGroup.appendChild(dropdownMenu);
                } else {
                    // This shouldn't occur in normal operation - log and continue
                    console.warn(`Button group not found for table ${tableIndex}. This indicates a DOM structure issue.`);
                }
                
                // Enable collapse functionality for Bootstrap components
                const cpeCollapse = document.getElementById(`cpeCollapse_${tableIndex}`);
                if (cpeCollapse) {
                    cpeCollapse.classList.add('show');
                    if (cpeHeaderArrow) cpeHeaderArrow.innerHTML = "&darr;";
                }
                
                // Call the function from provenance_assistance.js
                if (typeof window.updateProvenanceState === 'function') {
                    window.updateProvenanceState(tableIndex, true);
                } else {
                    const provenanceCollapse = document.getElementById(`provenanceCollapse_${tableIndex}`);
                    const provenanceHeaderArrow = document.querySelector(`#provenanceHeader_${tableIndex} .arrow-icon`);
                    
                    if (provenanceCollapse) {
                        provenanceCollapse.classList.add('show');
                        if (provenanceHeaderArrow) provenanceHeaderArrow.innerHTML = "&darr;";
                    }
                }
                
                // Show CPE Suggestions div if it was hidden
                const cpeQueryContainer = document.getElementById(`cpe-query-container-${tableIndex}`);
                if (cpeQueryContainer) {
                    cpeQueryContainer.style.display = '';
                }
            } else {
                // If no action was provided but we're using the original onclick handler,
                // default to 'complete' to maintain backward compatibility
                if (!action) {
                    action = 'complete';
                }
                
                // Collapse tables with specified action
                rowDataTableContainer.classList.add('collapsed');
                matchesTableContainer.classList.add('collapsed');
                
                // Mark the row with the appropriate status class
                if (action === 'skip') {
                    rowDataTableContainer.classList.add('skipped-row');
                    rowDataTableContainer.classList.remove('completed-row');
                    collapseButton.textContent = 'Expand Row (Skipped)';
                    collapseButton.classList.remove('btn-secondary', 'dropdown-toggle');
                    collapseButton.classList.add('btn-warning', 'rounded'); // Add rounded class
                } else {
                    rowDataTableContainer.classList.add('completed-row');
                    rowDataTableContainer.classList.remove('skipped-row');
                    collapseButton.textContent = 'Expand Row (Completed)';
                    collapseButton.classList.remove('btn-secondary', 'dropdown-toggle');
                    collapseButton.classList.add('btn-success', 'rounded'); // Add rounded class
                }
                
                // Remove dropdown attributes if they exist
                collapseButton.removeAttribute('data-bs-toggle');
                collapseButton.removeAttribute('aria-haspopup');
                collapseButton.removeAttribute('aria-expanded');
                
                // Also collapse the Bootstrap collapse sections
                const cpeCollapse = document.getElementById(`cpeCollapse_${tableIndex}`);
                if (cpeCollapse) {
                    cpeCollapse.classList.remove('show');
                    if (cpeHeaderArrow) cpeHeaderArrow.innerHTML = "&uarr;";
                }
                
                // Call the function from provenance_assistance.js
                if (typeof window.updateProvenanceState === 'function') {
                    window.updateProvenanceState(tableIndex, false);
                } else {
                    const provenanceCollapse = document.getElementById(`provenanceCollapse_${tableIndex}`);
                    const provenanceHeaderArrow = document.querySelector(`#provenanceHeader_${tableIndex} .arrow-icon`);
                    
                    if (provenanceCollapse) {
                        provenanceCollapse.classList.remove('show');
                        if (provenanceHeaderArrow) provenanceHeaderArrow.innerHTML = "&uarr;";
                    }
                }
                
                // Also collapse JSON if it's visible
                const jsonDisplay = document.getElementById(`consolidatedJsonDisplay_matchesTable_${tableIndex}`);
                if (jsonDisplay && !jsonDisplay.classList.contains('collapsed')) {
                    toggleConsolidatedJson(`matchesTable_${tableIndex}`);
                }
                
                // Also hide CPE Suggestions div when row collapses
                const cpeQueryContainer = document.getElementById(`cpe-query-container-${tableIndex}`);
                if (cpeQueryContainer) {
                    cpeQueryContainer.style.display = 'none';
                }
                
                // Hide the dropdown menu when an option is selected (if using dropdown)
                const btnGroup = collapseButton.closest('.btn-group');
                if (btnGroup) {
                    const dropdownMenu = btnGroup.querySelector('.dropdown-menu');
                    if (dropdownMenu) {
                        dropdownMenu.style.display = 'none';
                    }
                }
                
                // Set the click handler for the expand button
                collapseButton.onclick = function() {
                    toggleRowCollapse(tableIndex);
                };
            }
            
            // Update completion tracker
            if (typeof window.updateCompletionTracker === 'function') {
                window.updateCompletionTracker();
            }
        }
    } catch(e) {
        console.error(`Error in toggleRowCollapse for tableIndex ${tableIndex}:`, e);
    }
}



/**
 * Toggle consolidated JSON display with improved state handling
 * @param {string} tableId - ID of the table
 */
function toggleConsolidatedJson(tableId) {
    try {
        const display = document.getElementById(`consolidatedJsonDisplay_${tableId}`);
        const showButton = document.getElementById(`showConsolidatedJson_${tableId}`);
        
        if (!display || !showButton) return;
        
        const selectedRows = window.tableSelections.get(tableId);
        const selectionCount = selectedRows ? selectedRows.size : 0;
        
        showButton.disabled = selectionCount === 0;
        
        if (selectionCount > 0) {
            // Toggle collapsed class only - no style manipulation
            display.classList.toggle('collapsed');
            const isCollapsed = display.classList.contains('collapsed');
            
            // Update button with stats and style
            const statsStr = getStatisticsString(consolidatedJsons.get(tableId), selectionCount);
            showButton.textContent = isCollapsed ? 
                `Show Consolidated JSON (${statsStr})` : 
                `Hide Consolidated JSON (${statsStr})`;
            
            // Toggle button classes
            if (isCollapsed) {
                showButton.classList.remove('btn-success');
                showButton.classList.add('btn-primary');
            } else {
                showButton.classList.remove('btn-primary');
                showButton.classList.add('btn-success');
                updateJsonDisplayIfVisible(tableId);
            }
        } else {
            // No selections case
            display.classList.add('collapsed');
            showButton.textContent = `Show Consolidated JSON (0 selected)`;
            showButton.classList.remove('btn-success');
            showButton.classList.add('btn-primary');
        }
    } catch(e) {
        console.error(`Error in toggleConsolidatedJson for tableId ${tableId}:`, e);
    }
}

/**
 * Update the consolidated JSON for a table
 * @param {string} tableId - ID of the table
 */
function updateConsolidatedJson(tableId) {
    try {
        // Get the selected rows for this table
        const selectedRows = window.tableSelections.get(tableId);
        
        if (!selectedRows || selectedRows.size === 0) {
            console.debug(`No rows selected for table ${tableId}`);
            consolidatedJsons.set(tableId, null);
            
            // Always update button state when there are no selections
            updateButton(tableId, false);
            
            // Update JSON display if it's visible
            updateJsonDisplayIfVisible(tableId);
            
            return;
        }
        
        // Extract the table index from the table ID
        const tableIndex = tableId.split('_')[1];
        
        // Extract metadata and raw platform data from the row data table
        const extractedData = extractDataFromTable(tableIndex);
        
        // Process the JSON based on the source
        // Generate JSON using the existing working processVersionDataToCpeMatches function
        const allCpeMatches = [];
        for (const cpeBase of selectedRows) {
            // Pass tableId to processing function
            const cpeMatches = processVersionDataToCpeMatches(cpeBase, extractedData.rawPlatformData, tableId);
            allCpeMatches.push(...cpeMatches);
        }
        
        // Store as single configuration object (original working structure)
        const json = {
            operator: "OR",
            negate: false,
            cpeMatch: allCpeMatches
        };
        
        // Store the consolidated JSON for this table
        consolidatedJsons.set(tableId, json);
        
        console.debug(`Updated consolidated JSON for table ${tableId}`);
        
        // Find the consolidated JSON button
        const showButton = document.getElementById(`showConsolidatedJson_${tableId}`);
        
        // Update button with selection information
        if (showButton) {
            const statsStr = getStatisticsString(json, selectedRows.size);
            
            // Check if the display is currently visible
            const display = document.getElementById(`consolidatedJsonDisplay_${tableId}`);
            const isVisible = !display.classList.contains('collapsed');
            
            // Update button text
            showButton.textContent = isVisible ? 
                `Hide Consolidated JSON (${statsStr})` : 
                `Show Consolidated JSON (${statsStr})`;
            
            // Update button state
            showButton.disabled = selectedRows.size === 0;
            
            // Update button styling based on display visibility
            if (isVisible) {
                showButton.classList.remove('btn-primary');
                showButton.classList.add('btn-success');
            } else {
                showButton.classList.remove('btn-success');
                showButton.classList.add('btn-primary');
            }
        }
        
        // Always update the JSON display if it's visible
        updateJsonDisplayIfVisible(tableId);
        
        // Also update the "Export All" button and configurations display
        updateExportAllButton();
        updateAllConfigurationsDisplay();
        
    } catch(e) {
        console.error(`Error updating consolidated JSON for table ${tableId}:`, e);
        consolidatedJsons.set(tableId, null);
    }
}



/**
 * Update the button state and text
 * @param {string} tableId - ID of the table
 * @param {boolean} hasSelections - Whether there are selections
 */
function updateButton(tableId, hasSelections) {
    try {
        const button = document.getElementById(`showConsolidatedJson_${tableId}`);
        
        if (button) {
            // Disable if there are no selections
            button.disabled = !hasSelections;
            
            // Update button text with selection count
            const statsStr = hasSelections ? 
                getStatisticsString(consolidatedJsons.get(tableId), window.tableSelections.get(tableId).size) : 
                "0 selected";
                
            // Check if the display is visible
            const display = document.getElementById(`consolidatedJsonDisplay_${tableId}`);
            const isVisible = !display.classList.contains('collapsed');
            
            button.textContent = isVisible ? 
                `Hide Consolidated JSON (${statsStr})` : 
                `Show Consolidated JSON (${statsStr})`;
                
            // Update button tooltip
            button.title = hasSelections ? 
                'Show/hide the consolidated JSON' : 
                'Select rows to generate JSON';
        }
    } catch(e) {
        console.error(`Error updating button for table ${tableId}:`, e);
    }
}

// Single consolidated initialization for all DOM elements
document.addEventListener('DOMContentLoaded', function() {
    // Find all matchesTables (there may be multiple)
    const tables = document.querySelectorAll('table[id^="matchesTable"]');
    
    // Add transition class to all tables
    tables.forEach((table, tableIndex) => {
        // Add transition class to the matches table
        if (!table.classList.contains('row-transition')) {
            table.classList.add('row-transition');
        }
        
        // Add transition class to the corresponding row data table
        const rowDataTable = document.getElementById(`rowDataTable_${tableIndex}`);
        if (rowDataTable && !rowDataTable.classList.contains('row-transition')) {
            rowDataTable.classList.add('row-transition');
        }
    });
    
    // Add a master "Export All Configurations" button at the top of cveListCPESuggester
    const cveListCPESuggester = document.getElementById('cveListCPESuggester');
    const cpeSuggesterHeader = document.getElementById('cpeSuggesterHeader');
    
    if (cveListCPESuggester && cpeSuggesterHeader) {
        // Create the Export All container
        const allContainer = document.createElement('div');
        allContainer.classList.add('all-configurations-container', 'mt-1', 'mb-1');
        allContainer.id = 'allConfigurationsContainer';
        allContainer.innerHTML = `
            <!-- Configuration summary above the button -->
            <div id="configurationSummary" class="text-center mb-2"></div>
            <div class="d-grid gap-2 col-12 mx-auto">
                <button id="exportAllConfigurations" class="btn btn-primary btn-transition">Show All Configurations</button>
            </div>
            <div id="allConfigurationsDisplay" class="mt-2 consolidated-json-container collapsed">
                <h4>Complete Configuration JSON</h4>
                <p class="text-muted">This combines all selected CPEs from all tables, with each table creating its own configuration node.</p>
                <pre id="allConfigurationsContent"></pre>
            </div>
        `;
        
        cpeSuggesterHeader.parentNode.insertBefore(allContainer, cpeSuggesterHeader.nextSibling);
        
        // Add click handler to the Export All button
        document.getElementById('exportAllConfigurations').addEventListener('click', function() {
            const display = document.getElementById('allConfigurationsDisplay');
            const content = document.getElementById('allConfigurationsContent');
            
            if (display && content) {
                // Toggle visibility class
                display.classList.toggle('collapsed');
                
                // Update button text based on collapsed state
                const isCollapsed = display.classList.contains('collapsed');
                this.textContent = isCollapsed ? 'Show All Configurations' : 'Hide All Configurations';
                
                // Toggle button styling with classes
                if (isCollapsed) {
                    this.classList.remove('btn-success');
                    this.classList.add('btn-primary');
                } else {
                    this.classList.remove('btn-primary');
                    this.classList.add('btn-success');
                    
                    // CHANGE: Explicitly call updateAllConfigurationsDisplay when showing
                    updateAllConfigurationsDisplay();
                }
            }
        });
    } else {
        console.error('Error: Could not find required elements for container positioning', {
            cveListCPESuggester: !!cveListCPESuggester,
            cpeSuggesterHeader: !!cpeSuggesterHeader
        });
    }

    // Initialize each table
    tables.forEach((table, tableIndex) => {
        const tableId = table.id;
        
        // Initialize selections for this table
        window.tableSelections.set(tableId, new Set());
        
        // Add click handlers to all CPE rows in this table
        const rows = table.querySelectorAll('.cpe-row');
        rows.forEach(function(row) {
            row.addEventListener('click', function(event) {
                // Don't handle clicks on elements with their own handlers
                if (event.target.tagName === 'BUTTON' || 
                    event.target.tagName === 'A' ||
                    event.target.closest('button') ||
                    event.target.closest('a')) {
                    return;
                }
                
                // Toggle row selection
                let cpeBase = row.getAttribute('data-cpe-base');
                
                // Normalize CPE base string when getting it from the row
                cpeBase = normalizeCpeString(cpeBase);
                
                const selections = window.tableSelections.get(tableId);
                
                if (selections.has(cpeBase)) {
                    selections.delete(cpeBase);
                    row.classList.remove('table-active');
                } else {
                    selections.add(cpeBase);
                    row.classList.add('table-active');
                }
                
                // Update the consolidated JSON for this table
                updateConsolidatedJson(tableId);
                
                // Update the Export All button (this will also update configSummary)
                updateExportAllButton();
            });
        });
        
        // Find the existing button container
        const buttonContainer = document.getElementById(`buttonContainer_${tableIndex}`);
        if (buttonContainer) {
            // Clear any existing collapse button
            const existingButton = document.getElementById(`collapseRowButton_${tableIndex}`);
            if (existingButton) {
                buttonContainer.removeChild(existingButton);
            }
            
            // Create dropdown group
            const dropdownGroup = document.createElement('div');
            dropdownGroup.className = 'btn-group';
            
            // Create main button
            const mainButton = document.createElement('button');
            mainButton.id = `collapseRowButton_${tableIndex}`;
            mainButton.className = 'btn btn-secondary dropdown-toggle btn-transition';
            mainButton.innerHTML = 'Collapse Row <span class="caret"></span>';
            mainButton.setAttribute('data-bs-toggle', 'dropdown');
            mainButton.setAttribute('aria-haspopup', 'true');
            mainButton.setAttribute('aria-expanded', 'false');
            dropdownGroup.appendChild(mainButton);
            
            // Create dropdown menu
            const dropdownMenu = document.createElement('ul');
            dropdownMenu.className = 'dropdown-menu';
            
            // Create menu items
            const completeItem = document.createElement('li');
            const completeLink = document.createElement('a');
            completeLink.className = 'dropdown-item';
            completeLink.href = '#';
            completeLink.textContent = 'Mark as Complete';
            completeLink.onclick = function(e) {
                e.preventDefault();
                toggleRowCollapse(tableIndex, 'complete');
            };
            completeItem.appendChild(completeLink);
            
            const skipItem = document.createElement('li');
            const skipLink = document.createElement('a');
            skipLink.className = 'dropdown-item';
            skipLink.href = '#';
            skipLink.textContent = 'Mark as Skip';
            skipLink.onclick = function(e) {
                e.preventDefault();
                toggleRowCollapse(tableIndex, 'skip');
            };
            skipItem.appendChild(skipLink);
            
            // Add items to menu
            dropdownMenu.appendChild(completeItem);
            dropdownMenu.appendChild(skipItem);
            
            // Add menu to group
            dropdownGroup.appendChild(dropdownMenu);
            
            // Add the group to the container
            buttonContainer.appendChild(dropdownGroup);
        }
        
        // Find the row data table's container - it's in the first cell of the row
        const rowDataTable = document.getElementById(`rowDataTable_${tableIndex}`);
        let containerTarget = null;
        
        if (rowDataTable) {
            // Get the parent TD element where the rowDataTable is located
            const parentCell = rowDataTable.closest('td');
            if (parentCell) {
                containerTarget = parentCell;
            } else {
                containerTarget = rowDataTable.parentNode; // Fallback
            }
            
            rowDataTable.classList.add('collapsible-content');
        }
        
        // Convert the matchesTable to use the new collapsible structure
        table.classList.add('collapsible-content');
        
        // Create a container for consolidated JSON right after the row data table
        const container = document.createElement('div');
        container.classList.add('json-container', 'mt-3', 'mb-4');
        container.id = `jsonContainer_${tableId}`;
        container.setAttribute('data-index', tableIndex);
        container.innerHTML = `
            <div id="consolidatedJsonDisplay_${tableId}" class="json-display-container collapsed">
                <!-- JSON Generation Settings Shell (populated by Python) -->
                <div id="jsonSettings_${tableId}" class="json-settings-container mb-3" style="display: none;">
                    <!-- Settings content will be populated by initializeJsonSettings() -->
                </div>
                
                <!-- Existing JSON Display -->
                <h4>Consolidated Configuration JSON</h4>
                <pre id="consolidatedJsonContent_${tableId}"></pre>
            </div>
        `;
        
        // Place the container before the rowDataTable in the first cell
        if (containerTarget && rowDataTable) {
            // Insert before the rowDataTable instead of after
            rowDataTable.insertAdjacentElement('beforebegin', container);
        } else {
            // Fallback to original placement after the table
            table.parentNode.insertBefore(container, table.nextSibling);
        }
        
        // Create the consolidated JSON button and place it next to the collapse button
        const jsonButton = document.createElement('button');
        jsonButton.id = `showConsolidatedJson_${tableId}`;
        jsonButton.className = 'btn btn-primary';
        // Disable by default since there are no selections initially
        jsonButton.disabled = true;
        // Add the btn-transition class
        jsonButton.classList.add('btn-transition');
        jsonButton.textContent = 'Show Consolidated JSON (0 selected)';

        // Find the button container and add the JSON button
        const collapseButtonContainer = document.getElementById(`buttonContainer_${tableIndex}`);
        if (collapseButtonContainer) {
            collapseButtonContainer.appendChild(jsonButton);
        }
        
        // Add click handler to the button - find it first since it's already in the DOM
        const showButton = document.getElementById(`showConsolidatedJson_${tableId}`);
        if (showButton) {
            showButton.addEventListener('click', function() {
                try {
                    toggleConsolidatedJson(tableId);
                } catch(e) {
                    console.error(`Error toggling JSON display for table ${tableId}:`, e);
                }
            });
        }
    });
    
    // Initial update of Export All button visibility
    updateExportAllButton();
    
    // Initialize button transitions
    document.querySelectorAll('[id^="collapseRowButton_"], [id^="showConsolidatedJson_"], #exportAllConfigurations').forEach(button => {
        button.classList.add('btn-transition');
    });
    
    // Initialize JSON display containers
    document.querySelectorAll('[id^="consolidatedJsonDisplay_"]').forEach(container => {
        container.classList.add('json-display-container');
    });
    
    // Check for any tables that need to start collapsed
    const tableButtons = document.querySelectorAll('[id^="collapseRowButton_"]');
    tableButtons.forEach(button => {
        if (button.textContent.includes('Expand Row')) {
            // Extract index from button ID
            const index = button.id.replace('collapseRowButton_', '');
            const rowDataTableContainer = document.getElementById(`rowDataTable_${index}_container`);
            const matchesTableContainer = document.getElementById(`matchesTable_${index}_container`);
            
            // Apply collapsed state to containers
            if (rowDataTableContainer) rowDataTableContainer.classList.add('collapsed');
            if (matchesTableContainer) matchesTableContainer.classList.add('collapsed');        }
    });
    
    // Modify the mutation observer to only handle CPE sections
    const observer = new MutationObserver((mutations) => {
        mutations.forEach(mutation => {
            if (mutation.attributeName === 'class') {
                const target = mutation.target;
                if (target.id && target.id.startsWith('cpeCollapse_')) {
                    const index = target.id.split('_')[1];
                    const arrowElement = document.querySelector(`#cpeHeader_${index} .arrow-icon`);
                    
                    if (arrowElement) {
                        // Use HTML entities and innerHTML instead of Unicode and textContent
                        const isShown = target.classList.contains('show');
                        arrowElement.innerHTML = isShown ? "&darr;" : "&uarr;";
                    }
                }
            }
        });
    });
    
    // Apply the observer to CPE collapse sections only
    const cpeCollapseSections = document.querySelectorAll('[id^="cpeCollapse_"]');
    cpeCollapseSections.forEach(section => {
        observer.observe(section, { attributes: true });
    });
    
    // Initialize CPE arrow icons with HTML entities
    document.querySelectorAll('#cpeHeader_\\d+ .arrow-icon').forEach(arrow => {
        const parentHeader = arrow.closest('.card-header');
        if (!parentHeader) return;
        
        const targetId = parentHeader.getAttribute('data-bs-target');
        if (!targetId) return;
        
        const target = document.querySelector(targetId);
        if (!target) return;
        
        // Set initial state using HTML entities
        const isShown = target.classList.contains('show');
        arrow.innerHTML = isShown ? "&darr;" : "&uarr;";
    });

    // Initialize provenance description containers
    document.querySelectorAll('[id^="description_"]').forEach(container => {
        container.classList.add('description-container', 'collapsed');
        
        // Find associated button and update its text/style
        const buttonId = container.id.replace('description_', 'toggle_');
        const button = document.getElementById(buttonId);
        if (button) {
            button.textContent = 'Show Description';
            button.classList.add('btn-transition', 'btn-info');
        }
    });
    
    // Initialize JSON settings for all tables
    tables.forEach((table, tableIndex) => {
        const tableId = table.id;
        initializeJsonSettings(tableId);
    });
});



/**
 * Initialize JSON settings for a specific table using server-generated HTML
 * @param {string} tableId - ID of the table (e.g., "matchesTable_0")
 */
function initializeJsonSettings(tableId) {
    const settingsContainer = document.getElementById(`jsonSettings_${tableId}`);
    if (!settingsContainer) return;
    
    // Get the settings HTML from the global variable populated by Python
    const settingsHTML = window.JSON_SETTINGS_HTML && window.JSON_SETTINGS_HTML[tableId];
    
    if (settingsHTML) {
        settingsContainer.innerHTML = settingsHTML;
        
        // Show the container
        settingsContainer.style.display = 'block';
        
        // Initialize Bootstrap tooltips for the enhanced settings descriptions
        const tooltipElements = settingsContainer.querySelectorAll('[data-bs-toggle="tooltip"]');
        tooltipElements.forEach(element => {
            if (typeof bootstrap !== 'undefined' && bootstrap.Tooltip) {
                new bootstrap.Tooltip(element);
            }
        });
        
        // Initialize event handlers for this table's settings
        initializeRowJsonSettings(tableId);
        
        console.debug(`Initialized JSON settings for ${tableId} with ${tooltipElements.length} tooltips`);
    } else {
        console.warn(`No settings HTML found for ${tableId}`);
    }
}

/**
 * Initialize settings event handlers for a specific table
 * @param {string} tableId - Table identifier
 */
function initializeRowJsonSettings(tableId) {
    const settingsKey = tableId;
    
    // Initialize settings if they don't exist
    if (!window.rowSettings.has(settingsKey)) {
        let initialSettings = {};
        
        // Use intelligent settings from Python
        if (window.INTELLIGENT_SETTINGS && window.INTELLIGENT_SETTINGS[tableId]) {
            initialSettings = { ...window.INTELLIGENT_SETTINGS[tableId] };
            console.debug(`Using intelligent settings for ${tableId}:`, initialSettings);
            
            // Apply intelligent settings to actual checkbox elements
            Object.entries(initialSettings).forEach(([setting, value]) => {
                const checkbox = document.querySelector(`[data-table-id="${tableId}"][data-setting="${setting}"]`);
                if (checkbox && checkbox.type === 'checkbox') {
                    checkbox.checked = value;
                    console.debug(`Set ${setting} to ${value} for ${tableId}`);
                }
            });
        }
        
        window.rowSettings.set(settingsKey, initialSettings);
    }
    
    // Add event listeners to all row-setting elements for this specific table
    const settingElements = document.querySelectorAll(`[data-table-id="${tableId}"].row-setting`);
    
    settingElements.forEach(element => {
        element.addEventListener('change', function() {
            const setting = this.dataset.setting;
            const tableId = this.dataset.tableId;
            const settingsKey = tableId;
            
            // Get current settings
            const currentSettings = window.rowSettings.get(settingsKey) || {};
            
            // Update the specific setting
            if (this.type === 'checkbox') {
                currentSettings[setting] = this.checked;
            } else if (this.type === 'radio' && this.checked) {
                currentSettings[setting] = this.value;
            }
            
            // Save updated settings
            window.rowSettings.set(settingsKey, currentSettings);
            
            // Trigger the change handler
            onRowSettingsChange(tableId);
            
            console.debug(`Updated ${setting} for ${settingsKey}:`, currentSettings[setting]);
        });
    });
}



// =============================================================================
// Global Exports - All window assignments consolidated here
// =============================================================================
window.openCity = openCity;
window.toggleRowCollapse = toggleRowCollapse;
window.updateConsolidatedJson = updateConsolidatedJson;
window.tableSelections = new Map();

/**
 * Timestamp Handler
 * Manages the generator timestamp for CPE JSON data and timestamp display
 */

// Module for handling timestamp-related operations
(function() {
    // Store the timestamp globally for use in other modules
    let generatorTimestamp = "";
    
    // Initialize timestamp functionality
    function initTimestampHandler(timestamp) {
        // Store the timestamp globally
        generatorTimestamp = timestamp;
        
        // Format and display the timestamp when the document is ready
        document.addEventListener('DOMContentLoaded', function() {
            formatAndDisplayTimestamp();
        });
    }
    
    // Format and display the timestamp in the user's local timezone
    function formatAndDisplayTimestamp() {
        const timeElement = document.querySelector('#generationTimestamp time');
        if (!timeElement) return;
        
        const utcTime = new Date(generatorTimestamp);
        const options = { 
            year: 'numeric', 
            month: 'short', 
            day: 'numeric', 
            hour: '2-digit', 
            minute: '2-digit', 
            second: '2-digit',
            timeZoneName: 'short' 
        };
        timeElement.textContent = utcTime.toLocaleString(undefined, options);
    }
    
    // Get the stored timestamp
    function getTimestamp() {
        return generatorTimestamp;
    }    
    // =============================================================================
    // Global Exports - All window assignments consolidated here
    // =============================================================================
    window.timestampHandler = {
        init: initTimestampHandler,
        getTimestamp: getTimestamp
    };
})();

/**
 * Handle description buttons in provenance assistance sections
 */

/**
 * Get CVE description data from the global metadata
 * @returns {Array} Array of description data objects
 */
function getDescriptionData() {
    const metadataDiv = document.getElementById('global-cve-metadata');
    if (!metadataDiv || !metadataDiv.hasAttribute('data-cve-metadata')) {
        return [];
    }
    
    try {
        const metadata = JSON.parse(metadataDiv.getAttribute('data-cve-metadata'));
        return metadata && metadata.descriptionData ? metadata.descriptionData : [];
    } catch (e) {
        console.error('Error parsing CVE metadata:', e);
        return [];
    }
}

/**
 * Create description source cards with language buttons
 * @param {number} rowIndex - The row index
 */
function createDescriptionButtons(rowIndex) {
    const descriptionData = getDescriptionData();
    if (!descriptionData || descriptionData.length === 0) {
        return;
    }
    
    const buttonContainer = document.getElementById(`descriptionButtons_${rowIndex}`);
    if (!buttonContainer) {
        return;
    }
    
    // Wrap all buttons and content in a container that can be collapsed
    buttonContainer.innerHTML = '<div class="description-buttons-container mb-2"></div>';
    const buttonsWrapper = buttonContainer.querySelector('.description-buttons-container');
    
    // Initialize the description area with collapsed class instead of inline style
    const contentArea = document.getElementById(`descriptionContent_${rowIndex}`);
    if (contentArea) {
        contentArea.classList.add('description-content', 'collapsed');
        // Remove any direct style.display setting
        contentArea.style.display = '';
    }
    
    // Clear existing buttons
    buttonsWrapper.innerHTML = '';
    
    // Create source cards with language buttons
    descriptionData.forEach((source, sourceIndex) => {
        if (!source.descriptions || source.descriptions.length === 0) {
            return;
        }
        
        // Create a card for this source
        const card = document.createElement('div');
        card.className = 'card source-card me-2 mb-2';
        
        // Create the card header
        const header = document.createElement('div');
        header.className = 'card-header py-1';
        header.innerHTML = `<strong>${source.sourceRole} Description(s)</strong>`;
        card.appendChild(header);
        
        // Create the card body
        const body = document.createElement('div');
        
        // If there's only one language, use center alignment like repo cards
        if (source.descriptions.length === 1) {
            body.className = 'card-body py-2 px-2 d-flex align-items-center justify-content-center';
        } else {
            body.className = 'card-body py-2 px-2 d-flex flex-wrap gap-1 has-multiple-buttons';
        }
        
        // Create buttons for each language
        source.descriptions.forEach((desc, descIndex) => {
            const button = document.createElement('button');
            button.id = `descBtn_${rowIndex}_${sourceIndex}_${descIndex}`;
            button.className = 'btn btn-sm btn-outline-secondary language-button';
            if (source.descriptions.length > 1 && descIndex < source.descriptions.length - 1) {
                button.className += ' mb-2';  // Add margin bottom except for last button
            }
            button.textContent = desc.lang || 'unknown';
            button.setAttribute('data-row-index', rowIndex);
            button.setAttribute('data-source-index', sourceIndex);
            button.setAttribute('data-desc-index', descIndex);
            button.onclick = function() {
                toggleDescription(this);
            };
            body.appendChild(button);
        });
        
        // Add the body to the card
        card.appendChild(body);
        
        // Add the card to the container
        buttonsWrapper.appendChild(card);
    });
}

/**
 * Toggle the selected description visibility
 * @param {Element} button - The clicked button
 */
function toggleDescription(button) {
    // Get indices
    const rowIndex = button.getAttribute('data-row-index');
    const sourceIndex = button.getAttribute('data-source-index');
    const descIndex = button.getAttribute('data-desc-index');
    
    // Get the content area
    const contentArea = document.getElementById(`descriptionContent_${rowIndex}`);
    if (!contentArea) {
        return;
    }
    
    // Check if this button is already active
    const isActive = button.classList.contains('active');
    
    // Clear all active buttons
    const allButtons = document.querySelectorAll(`[id^="descBtn_${rowIndex}_"]`);
    allButtons.forEach(btn => btn.classList.remove('active'));
    
    // If the button was already active, hide the content area and exit
    if (isActive) {
        // Use class toggle for smooth animation
        contentArea.classList.add('collapsed');
        // Remove spacing classes when collapsed
        contentArea.classList.remove('mt-3', 'border-top', 'pt-3');
        return;
    }
    
    // When showing content, add back spacing classes
    contentArea.classList.remove('collapsed');
    contentArea.classList.add('mt-3', 'border-top', 'pt-3');
    
    // Otherwise, mark this button as active
    button.classList.add('active');
    
    // Get description data
    const descriptionData = getDescriptionData();
    if (!descriptionData || descriptionData.length === 0) {
        return;
    }
    
    // Get the specific description
    const source = descriptionData[sourceIndex];
    if (!source || !source.descriptions || !source.descriptions[descIndex]) {
        return;
    }
    
    const description = source.descriptions[descIndex];
    
    // Simple approach - just replace newlines with <br> tags
    const displayText = description.value ? 
        description.value.replace(/\n/g, '<br>') : 
        "(No description provided)";
    
    // Update the content then show it with animation
    contentArea.innerHTML = `
        <h6 class="mb-3 text-muted">
            ${source.sourceRole}: ${source.sourceId} (${description.lang})
        </h6>
        <div class="description-text">
            ${displayText}
        </div>
    `;
    
    // Remove collapsed class for smooth animation
    contentArea.classList.remove('collapsed');
}

/**
 * Initialize all provenance assistance sections in the page
 */
function setupProvenanceStructure() {
    // Populate description buttons for each row
    const rows = document.querySelectorAll('.cpe-query-container');
    rows.forEach(row => {
        const rowIndex = row.id.replace('cpe-query-container-', '');
        if (rowIndex) {
            createDescriptionButtons(rowIndex);
            addProvenanceLinks(rowIndex);
        }
    });
}

/**
 * Add WordPress-specific provenance links if applicable for the row
 * @param {number} rowIndex - The row index
 * @param {object} platformData - The raw platform data for the row
 * @param {Element} linksContainer - The container to add cards to
 */
function addWordPressProvenanceLinks(rowIndex, platformData, linksContainer) {
    // Check if this is WordPress-related based on URL or source ID
    const isWordPressURL = 
        (platformData.collectionURL && platformData.collectionURL.includes('wordpress.org')) || 
        (platformData.repo && platformData.repo.includes('wordpress.org'));
    
    // Identify WordPress-related sources from CVE metadata
    const metadataDiv = document.getElementById('global-cve-metadata');
    let isWordPressSource = false;
    
    if (metadataDiv && metadataDiv.hasAttribute('data-cve-metadata')) {
        try {
            const metadata = JSON.parse(metadataDiv.getAttribute('data-cve-metadata'));
            
            if (metadata && metadata.sourceData && Array.isArray(metadata.sourceData)) {
                // Check if any of the sources are WordPress-related
                isWordPressSource = metadata.sourceData.some(source => 
                    source.sourceId === 'b15e7b5b-3da4-40ae-a43c-f7aa60e62599' || // WordFence
                    source.sourceId === '1bfdd5d7-9bf6-4a53-96ea-42e2716d7a81'    // WP Scan
                );
            }
        } catch (e) {
            console.error('Error checking WordPress sources:', e);
        }
    }
    
    // Exit if not WordPress-related
    if (!isWordPressURL && !isWordPressSource) {
        return;
    }
    
    // Create a WordPress Platform card
    const wpCard = document.createElement('div');
    wpCard.className = 'card source-card me-2 mb-2';
    
    // Create the card header
    const wpHeader = document.createElement('div');
    wpHeader.className = 'card-header py-1';
    wpHeader.innerHTML = '<strong>WordPress Platform</strong>';
    wpCard.appendChild(wpHeader);
    
    // Create the card body
    const wpBody = document.createElement('div');
    wpBody.className = 'card-body py-2 px-2 d-flex flex-column has-multiple-buttons';
    
    // Add Maintainer Profile button if vendor is available
    if (platformData.vendor) {
        const profileButton = document.createElement('button');
        profileButton.className = 'btn btn-sm btn-outline-secondary provenance-button mb-2';
        profileButton.textContent = 'Maintainer Profile';
        
        const profileUrl = `https://profiles.wordpress.org/${platformData.vendor}/#content-plugins`;
        profileButton.title = profileUrl;
        profileButton.onclick = function() {
            window.open(profileUrl, '_blank');
        };
        
        wpBody.appendChild(profileButton);
    }
    
    // Add Plugin Tracking (Product) button if product is available
    if (platformData.product) {
        const productButton = document.createElement('button');
        productButton.className = 'btn btn-sm btn-outline-secondary provenance-button mb-2';
        productButton.textContent = 'Plugin Tracking (Product)';
        
        const productUrl = `https://plugins.trac.wordpress.org/browser/${platformData.product}`;
        productButton.title = productUrl;
        productButton.onclick = function() {
            window.open(productUrl, '_blank');
        };
        
        wpBody.appendChild(productButton);
        
        // Add Changelog button using product name
        const changelogButton = document.createElement('button');
        changelogButton.className = 'btn btn-sm btn-outline-secondary provenance-button mb-2';
        changelogButton.textContent = 'Plugin Changelog (Product)';
        
        const changelogUrl = `https://wordpress.org/plugins/${platformData.product}/#developers`;
        changelogButton.title = changelogUrl;
        changelogButton.onclick = function() {
            window.open(changelogUrl, '_blank');
        };
        
        wpBody.appendChild(changelogButton);
    }
    
    // Add Plugin Tracking (Package Name) button if packageName is available and different from product
    if (platformData.packageName && 
        (!platformData.product || platformData.packageName !== platformData.product)) {
        
        const packageButton = document.createElement('button');
        packageButton.className = 'btn btn-sm btn-outline-secondary provenance-button mb-2';
        packageButton.textContent = 'Plugin Tracking (Package Name)';
        
        const packageUrl = `https://plugins.trac.wordpress.org/browser/${platformData.packageName}`;
        packageButton.title = packageUrl;
        packageButton.onclick = function() {
            window.open(packageUrl, '_blank');
        };
        
        wpBody.appendChild(packageButton);
        
        // Add Changelog button using packageName if different from product
        const changelogPackageButton = document.createElement('button');
        changelogPackageButton.className = 'btn btn-sm btn-outline-secondary provenance-button mb-2';
        changelogPackageButton.textContent = 'Plugin Changelog (Package)';
        
        const changelogPackageUrl = `https://wordpress.org/plugins/${platformData.packageName}/#developers`;
        changelogPackageButton.title = changelogPackageUrl;
        changelogPackageButton.onclick = function() {
            window.open(changelogPackageUrl, '_blank');
        };
        
        wpBody.appendChild(changelogPackageButton);
    }
    
    // Only add the card if it has any buttons
    if (wpBody.children.length > 0) {
        wpCard.appendChild(wpBody);
        linksContainer.appendChild(wpCard);
    }
}

/**
 * Add Maven-specific provenance links for a row
 * @param {number} rowIndex - The row index
 * @param {object} platformData - The raw platform data for the row
 * @param {Element} linksContainer - The container to add cards to
 */
function addMavenProvenanceLinks(rowIndex, platformData, linksContainer) {
    // Parse the Maven package name (format: groupId:artifactId)
    const packageParts = platformData.packageName.split(':');
    if (packageParts.length < 2) {
        // Fallback to generic handling if not proper Maven format
        addGenericCollectionLinks(rowIndex, platformData, linksContainer);
        return;
    }
    
    const groupId = packageParts[0];
    const artifactId = packageParts[1];
    
    // Create a source-card style card for Maven Repository
    const mavenCard = document.createElement('div');
    mavenCard.className = 'card source-card me-2 mb-2';
    
    // Create the card header
    const mavenHeader = document.createElement('div');
    mavenHeader.className = 'card-header py-1';
    mavenHeader.innerHTML = '<strong>Maven Repository</strong>';
    mavenCard.appendChild(mavenHeader);
    
    // Create the card body
    const mavenBody = document.createElement('div');
    mavenBody.className = 'card-body py-2 px-2 d-flex flex-column has-multiple-buttons';
    
    // Add Official Search Interface button
    const searchButton = document.createElement('button');
    searchButton.className = 'btn btn-sm btn-outline-secondary provenance-button mb-2';
    searchButton.textContent = 'Official Search Interface';
    
    const searchUrl = `https://central.sonatype.com/artifact/${groupId}/${artifactId}`;
    searchButton.title = searchUrl;
    searchButton.onclick = function() {
        window.open(searchUrl, '_blank');
    };
    
    // Add Central Repository button
    const repoButton = document.createElement('button');
    repoButton.className = 'btn btn-sm btn-outline-secondary provenance-button';
    repoButton.textContent = 'Central Repository';
    
    // Convert groupId dots to slashes for repository path
    const groupPath = groupId.replace(/\./g, '/');
    const repoUrl = `https://repo.maven.apache.org/maven2/${groupPath}/${artifactId}/`;
    repoButton.title = repoUrl;
    repoButton.onclick = function() {
        window.open(repoUrl, '_blank');
    };
    
    // Add buttons to card body
    mavenBody.appendChild(searchButton);
    mavenBody.appendChild(repoButton);
    mavenCard.appendChild(mavenBody);
    linksContainer.appendChild(mavenCard);
}

/**
 * Add generic collection URL links for non-Maven repositories
 * @param {number} rowIndex - The row index
 * @param {object} platformData - The raw platform data for the row
 * @param {Element} linksContainer - The container to add cards to
 */
function addGenericCollectionLinks(rowIndex, platformData, linksContainer) {
    // Create a source-card style card for Collection URL
    const collectionCard = document.createElement('div');
    collectionCard.className = 'card source-card me-2 mb-2';
    
    // Create the card header
    const collectionHeader = document.createElement('div');
    collectionHeader.className = 'card-header py-1';
    collectionHeader.innerHTML = '<strong>Collection URL</strong>';
    collectionCard.appendChild(collectionHeader);
    
    // Create the card body
    const collectionBody = document.createElement('div');
    collectionBody.className = 'card-body py-2 px-2 d-flex flex-column has-multiple-buttons';
    
    // Add URL-only button
    const urlOnlyButton = document.createElement('button');
    urlOnlyButton.className = 'btn btn-sm btn-outline-secondary provenance-button mb-2';
    urlOnlyButton.textContent = 'Collection URL Only';
    urlOnlyButton.title = platformData.collectionURL;
    urlOnlyButton.onclick = function() {
        window.open(platformData.collectionURL, '_blank');
    };
    
    // Add combined URL button
    const combinedButton = document.createElement('button');
    combinedButton.className = 'btn btn-sm btn-outline-secondary provenance-button';
    combinedButton.textContent = 'Combined with Package Name';
    
    // Combine URL and package name
    let combinedUrl = platformData.collectionURL;
    if (!combinedUrl.endsWith('/')) {
        combinedUrl += '/';
    }
    combinedUrl += platformData.packageName;
    
    combinedButton.title = combinedUrl;
    combinedButton.onclick = function() {
        window.open(combinedUrl, '_blank');
    };
    
    // Add buttons to card body
    collectionBody.appendChild(urlOnlyButton);
    collectionBody.appendChild(combinedButton);
    collectionCard.appendChild(collectionBody);
    linksContainer.appendChild(collectionCard);
}

/**
 * Add provenance links cards (repository, collection URL) for a row
 * @param {number} rowIndex - The row index
 */
function addProvenanceLinks(rowIndex) {
    // Direct access by ID for rawPlatformData
    const rawDataElement = document.getElementById(`rawPlatformData_${rowIndex}`);
    if (!rawDataElement || !rawDataElement.textContent) {
        return;
    }
    
    let platformData;
    try {
        platformData = JSON.parse(rawDataElement.textContent);
    } catch (e) {
        console.error(`Error parsing platform data for row ${rowIndex}:`, e);
        return;
    }
    
    // Get the links container
    const linksContainer = document.getElementById(`provenanceLinks_${rowIndex}`);
    if (!linksContainer) {
        return;
    }
    
    // Add WordPress-specific provenance links if applicable
    addWordPressProvenanceLinks(rowIndex, platformData, linksContainer);
    
    // Add repository link if available
    if (platformData.repo) {
        // Create a source-card style card for Repository
        const repoCard = document.createElement('div');
        repoCard.className = 'card source-card me-2 mb-2';
        
        // Create the card header
        const repoHeader = document.createElement('div');
        repoHeader.className = 'card-header py-1';
        repoHeader.innerHTML = '<strong>Repository</strong>';
        repoCard.appendChild(repoHeader);
        
        // Create the card body
        const repoBody = document.createElement('div');
        repoBody.className = 'card-body py-2 px-2 d-flex align-items-center justify-content-center';
        
        // Create a button
        const repoButton = document.createElement('button');
        repoButton.className = 'btn btn-sm btn-outline-secondary provenance-button';
        repoButton.textContent = 'Open';
        repoButton.title = platformData.repo;
        repoButton.onclick = function() {
            window.open(platformData.repo, '_blank');
        };
        
        repoBody.appendChild(repoButton);
        repoCard.appendChild(repoBody);
        linksContainer.appendChild(repoCard);
    }    
    
    // Add collection URL if both collectionURL and packageName are available
    if (platformData.collectionURL && platformData.packageName) {
        // Check if this is a Maven repository using comprehensive detection
        const isMavenRepo = isMavenRepository(platformData.collectionURL, platformData.packageName);
        
        if (isMavenRepo && platformData.packageName.includes(':')) {
            // Handle Maven repository with proper URL generation
            addMavenProvenanceLinks(rowIndex, platformData, linksContainer);
        } else {
            // Handle non-Maven repositories with the original logic
            addGenericCollectionLinks(rowIndex, platformData, linksContainer);
        }
    }
}

/**
 * Add a link card to the container
 * @param {Element} container - The container to add the card to
 * @param {string} label - The label for the card
 * @param {string} url - The URL to open when clicked
 */
function addLinkCard(container, label, url) {
    // Create the card
    const card = document.createElement('div');
    card.className = 'card link-card me-3 mb-3';
    card.style.cursor = 'pointer';
    card.onclick = function() {
        window.open(url, '_blank');
    };
    
    // Create the card body
    const cardBody = document.createElement('div');
    cardBody.className = 'card-body py-2';
    cardBody.textContent = label;
    
    // Add the card body to the card
    card.appendChild(cardBody);
    
    // Add the card to the container
    container.appendChild(card);
}

// Initialize the provenance assistance module
function processProvenanceMetadata() {
    // Get global CVE metadata if available
    const metadataContainer = document.getElementById('global-cve-metadata');
    if (!metadataContainer) return;
    
    const metadataJson = metadataContainer.getAttribute('data-cve-metadata');
    if (!metadataJson) return;
    
    try {
        const metadata = JSON.parse(metadataJson);
        
        // Get all provenance containers in the document
        const provenanceContainers = document.querySelectorAll('[id^="provenanceCollapse_"]');
        provenanceContainers.forEach(container => {
            // Get the index number from the container ID
            const index = container.id.split('_')[1];
            
            // Process descriptions
            if (metadata.descriptionData && metadata.descriptionData.length > 0) {
                createDescriptionButtons(index);
            }
            
            // Process references - new section
            if (metadata.referencesData && metadata.referencesData.length > 0) {
                createReferenceCards(index, metadata.referencesData);
            }

        });
    } catch (error) {
        console.error('Error processing provenance metadata:', error);
    }
}

/**
 * Create reference cards based on tags
 * @param {number} rowIndex - The row index
 * @param {Array} referencesData - Array of reference data objects
 */
function createReferenceCards(rowIndex, referencesData) {
    console.debug("Creating reference cards for row", rowIndex);
    console.debug("References data:", referencesData);
    
    // Target div where we'll add the reference cards
    const referenceLinksContainer = document.getElementById(`provenanceLinks_${rowIndex}`);
    if (!referenceLinksContainer) {
        console.error(`Container provenanceLinks_${rowIndex} not found!`);
        return;
    }
    
    // Debug: Log ALL tags we find to see what's available
    const allFoundTags = new Set();
    referencesData.forEach(sourceData => {
        (sourceData.references || []).forEach(reference => {
            (reference.tags || []).forEach(tag => {
                allFoundTags.add(tag);
            });
        });
    });
    console.debug("All available tags in the data:", Array.from(allFoundTags));
    
    // Define the tags we're interested in
    const targetTags = ['patch', 'mitigation', 'product', 'issue-tracking'];
    
    // Group references by tag and URL (to handle duplicates)
    const referencesByTag = {};
    targetTags.forEach(tag => referencesByTag[tag] = new Map()); // Map to store by URL
    
    // Track if we found any references with our target tags
    let foundTargetTagReferences = false;
    
    // Process all references from all sources
    referencesData.forEach(sourceData => {
        const sourceId = sourceData.sourceId || 'Unknown';
        const sourceRole = sourceData.sourceRole || 'Unknown';
        
        // Process each reference in this source
        (sourceData.references || []).forEach(reference => {
            const url = reference.url;
            const name = reference.name || url;
            const tags = reference.tags || [];
            
            console.debug(`Processing reference: ${name}, tags:`, tags);
            
            // Only process references that have one of our target tags
            tags.forEach(tag => {
                if (targetTags.includes(tag) && url) {
                    foundTargetTagReferences = true;
                    // Create a unique key for the URL
                    const urlKey = url.toLowerCase();
                    
                    // Check if we've seen this URL before for this tag
                    if (referencesByTag[tag].has(urlKey)) {
                        // Add this source to the existing reference
                        const existingRef = referencesByTag[tag].get(urlKey);
                        existingRef.sources.push({
                            sourceId,
                            sourceRole,
                            tags: reference.tags || []
                        });
                    } else {
                        // Create a new reference entry
                        referencesByTag[tag].set(urlKey, {
                            url,
                            name,
                            sources: [{
                                sourceId,
                                sourceRole,
                                tags: reference.tags || []
                            }]
                        });
                    }
                }
            });
        });
    });
    
    if (!foundTargetTagReferences) {
        console.log("No references with patch, mitigation, product, or issue-tracking tags found for row ", rowIndex);
        return;
    }
    
    console.debug("References by tag:", referencesByTag);
    
    // Create a card for each tag that has references
    targetTags.forEach(tag => {
        const references = Array.from(referencesByTag[tag].values());
        if (references.length === 0) return;
        
        console.debug(`Creating card for tag ${tag} with ${references.length} references`);
        
        // Create a source-card style card for consistency
        const card = document.createElement('div');
        card.className = 'card source-card me-2 mb-2';
        
        // Create the card header using the same style as other cards
        const header = document.createElement('div');
        header.className = 'card-header py-1';
        
        // Format the tag name for display (capitalize, replace hyphens)
        const displayName = tag.charAt(0).toUpperCase() + tag.slice(1).replace('-', ' ');
        header.innerHTML = `<strong>${displayName}</strong>`;
        card.appendChild(header);
        
        // Create the card body with consistent styling
        const body = document.createElement('div');
        
        if (references.length === 1) {
            // If there's only one reference, use center alignment like repo cards
            body.className = 'card-body py-2 px-2 d-flex align-items-center justify-content-center';
        } else {
            body.className = 'card-body py-2 px-2 d-flex flex-wrap gap-1';
        }
        
        // Create buttons for each reference
        references.forEach((ref, idx) => {
            const button = document.createElement('button');
            button.className = 'btn btn-sm btn-outline-secondary provenance-button';
            
            // Add margin to all but the last button if there are multiple
            if (references.length > 1 && idx < references.length - 1) {
                button.className += ' mb-2';
            }
            
            // Truncate long names
            const displayName = ref.name.length > 25 
                ? ref.name.substring(0, 22) + '...' 
                : ref.name;
            
            button.textContent = displayName;
            button.onclick = function() {
                window.open(ref.url, '_blank');
            };
            
            // Create comprehensive tooltip with all info
            let tooltip = '';
            
            // Add each source's information to the tooltip
            ref.sources.forEach((source, i) => {
                if (i > 0) tooltip += '\n\n'; // Add spacing between sources
                
                tooltip += `Source: ${source.sourceRole} (${source.sourceId})\n`;
                tooltip += `Name: ${ref.name}\n`;
                tooltip += `URL: ${ref.url}\n`;
                
                if (source.tags && source.tags.length > 0) {
                    tooltip += `Tags: ${source.tags.join(', ')}`;
                }
            });
            
            button.title = tooltip;
            body.appendChild(button);
        });
        
        // Add the body to the card
        card.appendChild(body);
        referenceLinksContainer.appendChild(card);
        console.debug(`Card for tag ${tag} added to container`);
    });
}

/**
 * Toggle provenance description visibility with smooth animation
 * @param {string} buttonId - ID of the toggle button
 */
function toggleProvenanceDescription(buttonId) {
    try {
        const descriptionId = buttonId.replace('toggle_', 'description_');
        const descriptionElement = document.getElementById(descriptionId);
        const button = document.getElementById(buttonId);
        
        if (!descriptionElement || !button) return;
        
        // Toggle the collapsed class for animation
        descriptionElement.classList.toggle('collapsed');
        const isCollapsed = descriptionElement.classList.contains('collapsed');
        
        // Update the button text and styling
        button.textContent = isCollapsed ? 'Show Description' : 'Hide Description';
        if (isCollapsed) {
            button.classList.remove('btn-success');
            button.classList.add('btn-info');
        } else {
            button.classList.remove('btn-info');
            button.classList.add('btn-success');
        }    } catch(e) {
        console.error(`Error toggling provenance description for ${buttonId}:`, e);
    }
}

/**
 * Update provenance collapse state
 * @param {string} tableIndex - The table index
 * @param {boolean} expand - Whether to expand (true) or collapse (false)
 */
function updateProvenanceState(tableIndex, expand) {
    const provenanceCollapse = document.getElementById(`provenanceCollapse_${tableIndex}`);
    const provenanceHeaderArrow = document.querySelector(`#provenanceHeader_${tableIndex} .arrow-icon`);
    
    if (provenanceCollapse) {
        if (expand) {
            provenanceCollapse.classList.add('show');
            if (provenanceHeaderArrow) provenanceHeaderArrow.innerHTML = "&darr;";
        } else {
            provenanceCollapse.classList.remove('show');
            if (provenanceHeaderArrow) provenanceHeaderArrow.innerHTML = "&uarr;";
        }
    }
}

// Combine into a single DOMContentLoaded event listener:
document.addEventListener('DOMContentLoaded', function() {
    // Initialization functions
    setupProvenanceStructure();
    processProvenanceMetadata();
    
    // Initialize provenance description containers
    document.querySelectorAll('[id^="description_"]').forEach(container => {
        container.classList.add('description-container', 'collapsed');
        
        // Find associated button and update its text/style
        const buttonId = container.id.replace('description_', 'toggle_');
        const button = document.getElementById(buttonId);
        if (button) {
            button.textContent = 'Show Description';
            button.classList.add('btn-transition', 'btn-info');
        }
    });
    
    // Also check for description content areas
    document.querySelectorAll('.description-content').forEach(content => {
        // Make sure they have the proper transition classes
        if (!content.classList.contains('collapsed')) {
            content.classList.add('collapsed');
        }
    });
    
    // Add a single mutation observer for provenance collapse sections
    const observer = new MutationObserver((mutations) => {
        mutations.forEach(mutation => {
            if (mutation.attributeName === 'class') {
                const target = mutation.target;
                if (target.id && target.id.startsWith('provenanceCollapse_')) {
                    const index = target.id.split('_')[1];
                    const arrowElement = document.querySelector(`#provenanceHeader_${index} .arrow-icon`);
                    
                    if (arrowElement) {
                        // Use HTML entities and innerHTML instead of Unicode and textContent
                        const isShown = target.classList.contains('show');
                        arrowElement.innerHTML = isShown ? "&darr;" : "&uarr;";
                    }
                }
            }
        });
    });
    
    // Apply the observer to all provenance collapse sections
    const provenanceCollapseSections = document.querySelectorAll('[id^="provenanceCollapse_"]');
    provenanceCollapseSections.forEach(section => {
        observer.observe(section, { attributes: true });
    });
    
    // Initialize all provenance arrow icons with HTML entities
    document.querySelectorAll('#provenanceHeader_\\d+ .arrow-icon').forEach(arrow => {
        const parentHeader = arrow.closest('.card-header');
        if (!parentHeader) return;
        
        const targetId = parentHeader.getAttribute('data-bs-target');
        if (!targetId) return;
        
        const target = document.querySelector(targetId);
        if (!target) return;        
        // Set initial state using HTML entities
        const isShown = target.classList.contains('show');
        arrow.innerHTML = isShown ? "&darr;" : "&uarr;";
    });
});

/**
 * Comprehensive Maven repository detection
 * @param {string} collectionURL - The collection URL to check
 * @param {string} packageName - The package name to verify Maven format
 * @returns {boolean} - True if this appears to be a Maven repository
 */
function isMavenRepository(collectionURL, packageName) {
    if (!collectionURL || !packageName) {
        return false;
    }
    
    const url = collectionURL.toLowerCase();
    
    // Primary Maven repository patterns
    const mavenPatterns = [
        // Official Maven Central
        'repo1.maven.org',
        'repo.maven.apache.org', 
        'central.maven.org',
        'search.maven.org',
        
        // Maven path indicators
        '/maven2/',
        '/maven/',
        '/m2/',
        
        // Common enterprise Maven repository patterns
        '/repository/maven',
        '/artifactory/',
        '/nexus/',
        
        // Sonatype repositories
        'oss.sonatype.org',
        'central.sonatype.com',
        
        // Other Maven-compatible repositories
        'jcenter.bintray.com',
        'jitpack.io',
        'clojars.org',
        
        // Generic Maven repository indicators
        '/libs-release',
        '/libs-snapshot',
        '/maven-public',
        '/maven-central'
    ];
    
    // Check if URL matches any Maven patterns
    const hasKnownMavenPattern = mavenPatterns.some(pattern => url.includes(pattern));
    
    // Additional heuristic: Maven packages typically use groupId:artifactId format
    const hasMavenPackageFormat = packageName.includes(':') && 
                                  packageName.split(':').length >= 2 &&
                                  // Basic validation that it looks like a Maven coordinate
                                  /^[a-zA-Z0-9\-_.]+:[a-zA-Z0-9\-_.]+/.test(packageName);
    
    // Strong indicators (if any of these match, it's likely Maven)
    const strongMavenIndicators = [
        'maven',
        'artifactory',
        'nexus',
        'sonatype'
    ];
    
    const hasStrongIndicator = strongMavenIndicators.some(indicator => url.includes(indicator));
      // Return true if:
    // 1. URL has known Maven patterns, OR
    // 2. URL has strong indicators AND package format looks like Maven
    return hasKnownMavenPattern || 
           (hasStrongIndicator && hasMavenPackageFormat);
}

// =============================================================================
// Global Exports - All window assignments consolidated here
// =============================================================================
window.toggleProvenanceDescription = toggleProvenanceDescription;
window.updateProvenanceState = updateProvenanceState;

/**
 * Completion tracker module for CVE analysis tool
 * 
 * This module provides source data management functions and completion tracking.
 */

/**
 * Update the completion tracker with source-specific information
 */
function updateCompletionTracker() {
    try {
        const tableContainers = document.querySelectorAll('div[id^="rowDataTable_"][id$="_container"]');
        let completedCount = 0;
        let skippedCount = 0;
        const totalCount = tableContainers.length;
        
        // Track completion by source
        const sourceStats = {};
        const sourceNames = {};
        
        // Get source data from global metadata
        const sourceData = getSourceData();
        
        // First pass: examine all tables to find source identifiers
        tableContainers.forEach(container => {
            const isCompleted = container.classList.contains('collapsed') && container.classList.contains('completed-row');
            const isSkipped = container.classList.contains('collapsed') && container.classList.contains('skipped-row');
            const tableIndex = container.id.replace('rowDataTable_', '').replace('_container', '');
            
            // Get the actual table
            const rowDataTable = document.getElementById(`rowDataTable_${tableIndex}`);
            if (!rowDataTable) return;
            
            // Find source information - specifically look for Source ID row
            const sourceRows = rowDataTable.querySelectorAll('tr');
            let sourceId = null;
            
            // First try to find Source ID row with UUID
            for (const row of sourceRows) {
                const firstCell = row.querySelector('td:first-child');
                if (!firstCell || firstCell.textContent.trim() !== 'Source ID') continue;
                
                const sourceCell = row.querySelector('td:nth-child(2) span[title]');
                if (!sourceCell || !sourceCell.title) continue;
                
                const titleText = sourceCell.title;
                
                // Check if this is the NIST source (special case)
                if (titleText.includes('Contact Email: nvd@nist.gov')) {
                    sourceId = 'nvd@nist.gov';
                    break;
                }
                
                // Extract all UUIDs from Source Identifiers section
                const identifiersSection = titleText.match(/Source Identifiers:\s*([^]*?)(?=\n|$)/);
                if (identifiersSection && identifiersSection[1]) {
                    // Split by comma and trim whitespace
                    const identifiers = identifiersSection[1].split(',').map(id => id.trim());
                    
                    // Find a valid UUID format in the identifiers
                    for (const id of identifiers) {
                        if (id.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i)) {
                            sourceId = id;
                            break;
                        }
                    }
                    
                    // If we found a UUID, break out of the row loop
                    if (sourceId) break;
                }
            }
            
            // Skip if no source ID found
            if (!sourceId) {
                console.debug(`No source ID found for table ${tableIndex}`);
                return;
            }
            
            // Initialize source stats if not already tracked
            if (!sourceStats[sourceId]) {
                sourceStats[sourceId] = { total: 0, completed: 0, skipped: 0 };
                
                // Get source name from global metadata
                const sourceInfo = getSourceById(sourceId);
                sourceNames[sourceId] = sourceInfo ? sourceInfo.name : sourceId;
            }
            
            // Update source stats
            sourceStats[sourceId].total++;
            
            if (isCompleted) {
                sourceStats[sourceId].completed++;
                completedCount++;
            } else if (isSkipped) {
                sourceStats[sourceId].skipped++;
                skippedCount++;
            }
        });
        
        // Calculate percentage - include both completed and skipped in progress
        const processedCount = completedCount + skippedCount;
        const percentage = totalCount > 0 ? Math.round((processedCount / totalCount) * 100) : 0;
        
        // Update UI
        const progressBar = document.getElementById('completionProgressBar');
        const completedRowsCount = document.getElementById('completedRowsCount');
        const totalRowsCount = document.getElementById('totalRowsCount');
        
        if (progressBar && completedRowsCount && totalRowsCount) {
            progressBar.style.width = `${percentage}%`;
            progressBar.textContent = `${percentage}%`;
            progressBar.setAttribute('aria-valuenow', percentage);
            
            const displayElements = [];
            
            // Add the overall completion count
            displayElements.push(`${processedCount}/${totalCount} rows`);
            
            // Add completed/skipped breakdown if there are any skipped rows
            if (skippedCount > 0) {
                displayElements.push(`${skippedCount} skipped`);
            }
            
            // Sort sources by name for consistent display
            const sortedSourceIds = Object.keys(sourceStats).sort((a, b) => 
                sourceNames[a].localeCompare(sourceNames[b])
            );
            
            // Add each source with its completion status
            if (sortedSourceIds.length > 0) {
                const sourceElements = [];
                
                sortedSourceIds.forEach(sourceId => {
                    const stats = sourceStats[sourceId];
                    const sourceName = sourceNames[sourceId];
                    
                    // Count both completed and skipped for the source's progress
                    const processedForSource = stats.completed + stats.skipped;
                    
                    // Use plain text for status indicators to avoid encoding issues
                    let indicator;
                    if (processedForSource === stats.total) {
                        indicator = 'Done';
                    } else {
                        indicator = `${processedForSource}/${stats.total}`;
                    }
                    
                    // If there are skipped items, add details in parentheses using ASCII
                    if (stats.skipped > 0) {
                        indicator += ` (${stats.skipped} skipped)`;
                    }
                    
                    sourceElements.push(`${sourceName}: ${indicator}`);
                });
                
                // Join the source elements with commas
                if (sourceElements.length > 0) {
                    displayElements.push(`Sources: ${sourceElements.join(', ')}`);
                }
            }
            
            // Update the text content with all elements
            completedRowsCount.textContent = displayElements.join(' | ');
            
            // Hide the separate total count as it's now incorporated
            totalRowsCount.textContent = '';
        }
    } catch(e) {
        console.error('Error updating completion tracker:', e);
    }
}

/**
 * Get the source data from the global metadata
 * @returns {Array|null} The source data array or null if not found
 */
function getSourceData() {
    try {
        const metadataDiv = document.getElementById('global-cve-metadata');
        if (!metadataDiv || !metadataDiv.hasAttribute('data-cve-metadata')) {
            return null;
        }
        
        const metadata = JSON.parse(metadataDiv.getAttribute('data-cve-metadata'));
        return metadata.sourceData || [];  // Return as array instead of object
    } catch (e) {
        console.error('Error retrieving source data:', e);
        return [];  // Return empty array instead of empty object
    }
}

/**
 * Get source information by ID from the global metadata
 * @param {string} sourceId - The source ID to look for
 * @returns {Object|null} Source information or null if not found
 */
function getSourceById(sourceId) {
    try {
        const sourceData = getSourceData();
        if (!sourceData || !Array.isArray(sourceData)) {
            console.warn(`No source data available when looking up sourceId: ${sourceId}`);
            return null;
        }
        
        // First try exact match on sourceId
        let source = sourceData.find(source => source.sourceId === sourceId);
        
        // If not found, try checking sourceIdentifiers
        if (!source) {
            source = sourceData.find(source => 
                source.sourceIdentifiers && 
                Array.isArray(source.sourceIdentifiers) && 
                source.sourceIdentifiers.includes(sourceId)
            );
        }
        
        // Log when source is not found
        if (!source) {
            console.warn(`Source not found for ID: ${sourceId}`);
            // Debug: dump all available source IDs to help troubleshooting
            console.debug('Available source IDs:', 
                sourceData.map(s => ({id: s.sourceId, name: s.name, identifiers: s.sourceIdentifiers}))
            );
        }
        
        return source;
    } catch (e) {
        console.error(`Error retrieving source data for ID ${sourceId}:`, e);
        return null;
    }
}

/**
 * Create the completion tracker UI elements
 * @param {number} totalTables - Total number of tables to track
 */
function initializeCompletionTracker(totalTables) {
    const completionTrackerContainer = document.createElement('div');
    completionTrackerContainer.classList.add('completion-tracker-container', 'mt-1', 'mb-1', 'p-3', 'border', 'rounded');
    completionTrackerContainer.id = 'completionTrackerContainer';
    completionTrackerContainer.innerHTML = `
        <h4>Completion Progress</h4>
        <div class="progress mb-2">
            <div id="completionProgressBar" class="progress-bar bg-success" role="progressbar" style="width: 0%" 
                 aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
        </div>
        <div class="d-flex justify-content-between">
            <span id="completedRowsCount">0 rows completed</span>
            <span id="totalRowsCount">${totalTables} total rows</span>
        </div>
    `;

    return completionTrackerContainer;
}

// Initialize completion tracker on document load
document.addEventListener('DOMContentLoaded', function() {
    try {
        // Find all matchesTables (there may be multiple)
        const tables = document.querySelectorAll('table[id^="matchesTable"]');
        
        // Check if the completion tracker container already exists
        if (!document.getElementById('completionTrackerContainer')) {
            // Find where to insert the tracker
            const cpeSuggesterHeader = document.getElementById('cpeSuggesterHeader');
            const allContainer = document.getElementById('allConfigurationsContainer');
            
            if (cpeSuggesterHeader) {
                // Create tracker container
                const completionTrackerContainer = initializeCompletionTracker(tables.length);
                
                // Insert the completion tracker in the DOM
                if (allContainer) {
                    cpeSuggesterHeader.parentNode.insertBefore(completionTrackerContainer, allContainer);
                } else {
                    cpeSuggesterHeader.parentNode.insertBefore(
                        completionTrackerContainer, 
                        cpeSuggesterHeader.nextSibling
                    );
                }
                
                // Initial tracker update
                updateCompletionTracker();
            }        }
    } catch(e) {
        console.error('Error initializing completion tracker:', e);
    }
});

// =============================================================================
// Global Exports - All window assignments consolidated here
// =============================================================================
window.getSourceData = getSourceData;
window.getSourceById = getSourceById;
window.updateCompletionTracker = updateCompletionTracker;
window.initializeCompletionTracker = initializeCompletionTracker;

/**
 * Custom CPE Builder functionality
 * Allows users to create custom CPE base strings when automatic suggestions fail
 */

/**
 * Patch the CPE JSON processing function to handle custom CPEs
 */
function patchCpeJsonProcessing() {
    if (window.cpeJsonProcessingPatched) return;
    
    console.log("Custom CPE support enabled - processVersionDataToCpeMatches already handles custom CPEs");
    
    // CRITICAL FIX: Ensure we have a global consolidatedJsons map
    if (typeof window.consolidatedJsons === 'undefined') {
        window.consolidatedJsons = consolidatedJsons || new Map();
    }
    
    // Patch updateConsolidatedJson to use both global tableSelections and consolidatedJsons
    if (typeof updateConsolidatedJson === 'function') {
        window.originalUpdateConsolidatedJson = updateConsolidatedJson;
        
        window.updateConsolidatedJson = function(tableId) {
            try {
                // Use GLOBAL tableSelections instead of local one
                const selectedRows = window.tableSelections.get(tableId);
                
                console.log(`Using global tableSelections for ${tableId} with ${selectedRows ? selectedRows.size : 0} entries`);
                
                if (!selectedRows || selectedRows.size === 0) {
                    console.debug(`No rows selected for table ${tableId}`);
                    
                    // CRITICAL: Update BOTH local and global consolidatedJsons
                    window.consolidatedJsons.set(tableId, null);
                    if (typeof consolidatedJsons !== 'undefined') {
                        consolidatedJsons.set(tableId, null);
                    }
                    
                    // Find the consolidated JSON button
                    const showButton = document.getElementById(`showConsolidatedJson_${tableId}`);
                    
                    // Update button
                    if (showButton) {
                        showButton.disabled = true;
                        showButton.textContent = `Show Consolidated JSON (0 selected)`;
                    }
                    
                    // Update JSON display if it's visible
                    updateJsonDisplayIfVisible(tableId);
                    
                    return;
                }
                
                // Extract the table index from the table ID
                const tableIndex = tableId.split('_')[1];
                
                // Extract metadata and raw platform data from the row data table
                const extractedData = extractDataFromTable(tableIndex);
                  // Process the JSON based on the source
                const json = processJsonBasedOnSource(
                    selectedRows, 
                    extractedData.rawPlatformData, 
                    extractedData.metadata,
                    tableId
                );
                
                // CRITICAL: Store the consolidated JSON in BOTH maps
                window.consolidatedJsons.set(tableId, json);
                if (typeof consolidatedJsons !== 'undefined') {
                    consolidatedJsons.set(tableId, json);
                }
                
                console.debug(`Updated consolidated JSON for table ${tableId}`, json);
                
                // Find the consolidated JSON button
                const showButton = document.getElementById(`showConsolidatedJson_${tableId}`);
                
                // Update button with selection information
                if (showButton) {
                    const statsStr = getStatisticsString(json, selectedRows.size);
                    
                    // Check if the display is currently visible
                    const display = document.getElementById(`consolidatedJsonDisplay_${tableId}`);
                    const isVisible = display && !display.classList.contains('collapsed');
                    
                    // Update button text
                    showButton.textContent = isVisible ? 
                        `Hide Consolidated JSON (${statsStr})` : 
                        `Show Consolidated JSON (${statsStr})`;
                    
                    // Update button state
                    showButton.disabled = false;
                    
                    // Update button styling based on display visibility
                    if (isVisible) {
                        showButton.classList.remove('btn-primary');
                        showButton.classList.add('btn-success');
                    } else {
                        showButton.classList.remove('btn-success');
                        showButton.classList.add('btn-primary');
                    }
                }
                
                // Always update the JSON display if it's visible
                updateJsonDisplayIfVisible(tableId);
                
                // Also update the "Export All" button and configurations display
                if (typeof updateExportAllButton === 'function') {
                    updateExportAllButton();
                }
                
                if (typeof updateAllConfigurationsDisplay === 'function') {
                    updateAllConfigurationsDisplay();
                }
                
                return true;
            } catch(e) {
                console.error(`Error updating consolidated JSON for table ${tableId}:`, e);
                return window.originalUpdateConsolidatedJson(tableId);
            }
        };
        
        console.log("Patched updateConsolidatedJson to use global tableSelections");
    }
    
    // CRITICAL FIX: Patch updateJsonDisplayIfVisible to use window.consolidatedJsons
    if (typeof updateJsonDisplayIfVisible === 'function') {
        window.originalUpdateJsonDisplayIfVisible = updateJsonDisplayIfVisible;
        
        window.updateJsonDisplayIfVisible = function(tableId) {
            try {
                const display = document.getElementById(`consolidatedJsonDisplay_${tableId}`);
                const content = document.getElementById(`consolidatedJsonContent_${tableId}`);
                
                // Use class check instead of style.display
                if (display && content && !display.classList.contains('collapsed')) {
                    // Get the consolidated JSON from GLOBAL map
                    const selectedRows = window.tableSelections.get(tableId);
                    const selectionCount = selectedRows ? selectedRows.size : 0;
                    
                    // Debug log which json source we're using
                    console.log(`Updating JSON display for ${tableId}, selections: ${selectionCount}`);
                    
                    if (!selectedRows || selectedRows.size === 0) {
                        content.textContent = `No CPE Base String(s) selected.`;
                        return;
                    }
                    
                    // Get the consolidated JSON from GLOBAL map
                    const json = window.consolidatedJsons.get(tableId);
                    console.log(`Found JSON for display:`, json);
                    
                    if (json) {
                        // Format the JSON with indentation for readability
                        content.textContent = JSON.stringify(json, null, 2);
                    } else {
                        content.textContent = 'No JSON available. Please select CPE rows.';
                    }
                    
                    // Also update the button text
                    updateJsonDisplay(tableId, json, selectionCount);
                }
            } catch(e) {
                console.error(`Error updating JSON display for table ${tableId}:`, e);
                return window.originalUpdateJsonDisplayIfVisible(tableId);
            }
        };
        
        console.log("Patched updateJsonDisplayIfVisible to use global consolidatedJsons");
    }
    
    // CRITICAL FIX: Ensure display elements exist
    function ensureJsonDisplayElementsExist(tableId) {
        const jsonContainer = document.getElementById(`jsonContainer_${tableId}`);
        if (!jsonContainer) {
            console.error(`JSON container for ${tableId} not found`);
            return;
        }
        
        const display = document.getElementById(`consolidatedJsonDisplay_${tableId}`);
        if (!display) {
            console.error(`JSON display for ${tableId} not found`);
            return;
        }
        
        // Make sure the content element exists
        let content = document.getElementById(`consolidatedJsonContent_${tableId}`);
        if (!content) {
            console.log(`Creating missing consolidatedJsonContent for ${tableId}`);
            content = document.createElement('pre');
            content.id = `consolidatedJsonContent_${tableId}`;
            content.className = 'json-content';
            display.appendChild(content);
        }
    }
    
    // Add function to ensure all display elements are properly set up
    document.querySelectorAll('table[id^="matchesTable"]').forEach(table => {
        const tableId = table.id;
        setTimeout(() => ensureJsonDisplayElementsExist(tableId), 100);
    });
    
    // Patch toggleConsolidatedJson to show/hide JSON
    if (typeof toggleConsolidatedJson === 'function') {
        window.originalToggleConsolidatedJson = toggleConsolidatedJson;
        
        window.toggleConsolidatedJson = function(tableId) {
            try {
                const display = document.getElementById(`consolidatedJsonDisplay_${tableId}`);
                const showButton = document.getElementById(`showConsolidatedJson_${tableId}`);
                
                if (!display || !showButton) return;
                
                // Make sure content element exists
                ensureJsonDisplayElementsExist(tableId);
                
                // Get selections from GLOBAL map
                const selectedRows = window.tableSelections.get(tableId);
                const selectionCount = selectedRows ? selectedRows.size : 0;
                
                if (selectionCount > 0) {
                    // Toggle collapsed class
                    display.classList.toggle('collapsed');
                    const isCollapsed = display.classList.contains('collapsed');
                    
                    // Get the JSON from GLOBAL map
                    const json = window.consolidatedJsons.get(tableId);
                    const statsStr = getStatisticsString(json, selectionCount);
                    
                    // Update button text and style
                    showButton.textContent = isCollapsed ? 
                        `Show Consolidated JSON (${statsStr})` : 
                        `Hide Consolidated JSON (${statsStr})`;
                        
                    if (isCollapsed) {
                        showButton.classList.remove('btn-success');
                        showButton.classList.add('btn-primary');
                    } else {
                        showButton.classList.remove('btn-primary');
                        showButton.classList.add('btn-success');
                        
                        // Update the content when showing
                        updateJsonDisplayIfVisible(tableId);
                    }
                } else {
                    // No selections case
                    display.classList.add('collapsed');
                    showButton.textContent = `Show Consolidated JSON (0 selected)`;
                    showButton.classList.remove('btn-success');
                    showButton.classList.add('btn-primary');
                    showButton.disabled = true;
                }
            } catch(e) {
                console.error(`Error in toggleConsolidatedJson for ${tableId}:`, e);
                return window.originalToggleConsolidatedJson(tableId);
            }
        };
        
        console.log("Patched toggleConsolidatedJson for better display handling");
    }
    
    console.log("Custom CPE Builder initialized successfully");
    window.cpeJsonProcessingPatched = true;
}

/**
 * Initialize the Custom CPE Builder UI and functionality
 */
function initializeCustomCPEBuilder() {
    console.log("Initializing Custom CPE Builder...");
    
    // Set up customCPEHandlers if not already defined
    if (typeof window.customCPEHandlers === 'undefined') {
        window.customCPEHandlers = new Map();
    }
    
    // Apply patching for CPE JSON processing
    patchCpeJsonProcessing();
    
    // Find all customCPEBuilder divs and populate them
    const builderContainers = document.querySelectorAll('.customCPEBuilder');
    console.log(`Found ${builderContainers.length} custom CPE builder containers`);
    
    builderContainers.forEach((container, i) => {
        console.log(`Processing container ${i+1}:`, container.id);
        // Only initialize containers that haven't been set up yet
        if (!container.hasAttribute('data-initialized')) {
            console.log(`Populating container ${container.id}`);
            populateCustomCPEBuilder(container);
            container.setAttribute('data-initialized', 'true');
        } else {
            console.log(`Container ${container.id} already initialized`);
        }
    });

    // Set up event delegation for the document to handle future interactions
    document.removeEventListener('input', handleCustomCPEInputEvents); // Remove any existing handlers
    document.removeEventListener('change', handleCustomCPEInputEvents);
    document.removeEventListener('click', handleCustomCPEButtonClicks);
    
    document.addEventListener('input', handleCustomCPEInputEvents);
    document.addEventListener('change', handleCustomCPEInputEvents);
    document.addEventListener('click', handleCustomCPEButtonClicks);
    
    console.log("Custom CPE Builder initialization complete");
}

/**
 * Populate a custom CPE builder container with the necessary form elements
 * @param {HTMLElement} container - The container element to populate
 */
function populateCustomCPEBuilder(container) {
    // Extract index from container ID
    const containerId = container.id;
    const match = containerId.match(/customCPEBuilder-content-(\d+)/);
    
    if (!match || !match[1]) {
        console.error("Could not extract index from container ID:", containerId);
        return;
    }
    
    const index = match[1];
    
    // Create the form HTML
    const formHTML = `
        <div class="row mb-3">
            <div class="col-md-4">
                <label for="custom-cpe-part-${index}" class="form-label">Part</label>
                <select id="custom-cpe-part-${index}" class="form-select custom-cpe-part">
                    <option value="a">Application (a)</option>
                    <option value="o">Operating System (o)</option>
                    <option value="h">Hardware (h)</option>
                </select>
            </div>
            <div class="col-md-8">
                <label for="custom-cpe-vendor-${index}" class="form-label">Vendor</label>
                <input type="text" class="form-control custom-cpe-vendor" id="custom-cpe-vendor-${index}" placeholder="Enter vendor name">
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-12">
                <label for="custom-cpe-product-${index}" class="form-label">Product</label>
                <input type="text" class="form-control custom-cpe-product" id="custom-cpe-product-${index}" placeholder="Enter product name">
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-4">
                <label for="custom-cpe-target-sw-${index}" class="form-label">Target Software</label>
                <input type="text" class="form-control custom-cpe-target-sw" id="custom-cpe-target-sw-${index}" placeholder="*">
            </div>
            <div class="col-md-4">
                <label for="custom-cpe-target-hw-${index}" class="form-label">Target Hardware</label>
                <input type="text" class="form-control custom-cpe-target-hw" id="custom-cpe-target-hw-${index}" placeholder="*">
            </div>
            <div class="col-md-4">
                <label for="custom-cpe-other-${index}" class="form-label">Other</label>
                <input type="text" class="form-control custom-cpe-other" id="custom-cpe-other-${index}" placeholder="*">
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-12">
                <label for="custom-cpe-preview-${index}" class="form-label">CPE Base String Preview</label>
                <div class="input-group">
                    <input type="text" class="form-control custom-cpe-preview" id="custom-cpe-preview-${index}" readonly>
                    <button class="btn btn-outline-secondary copy-cpe-btn" type="button" data-index="${index}">
                        <i class="bi bi-clipboard"></i> Copy
                    </button>
                </div>
                <div class="form-text">This is the CPE base string in the standard CPE 2.3 format</div>
            </div>
        </div>
        <div class="row mt-3">
            <div class="col-12 d-grid">
                <button type="button" class="btn btn-primary apply-custom-cpe-btn" data-index="${index}">
                    Apply Custom CPE
                </button>
            </div>
        </div>
    `;
    
    // Set the HTML content
    container.innerHTML = formHTML;
    
    // Initialize the preview with default values
    updateCustomCPEPreview(index);
}

/**
 * Handle input and change events for custom CPE inputs
 * @param {Event} event - The input or change event
 */
function handleCustomCPEInputEvents(event) {
    // Check if the event originated from one of our input fields
    if (event.target.classList.contains('custom-cpe-part') ||
        event.target.classList.contains('custom-cpe-vendor') ||
        event.target.classList.contains('custom-cpe-product') ||
        event.target.classList.contains('custom-cpe-target-sw') ||
        event.target.classList.contains('custom-cpe-target-hw') ||
        event.target.classList.contains('custom-cpe-other')) {
        
        const idParts = event.target.id.split('-');
        const index = idParts[idParts.length - 1];
        updateCustomCPEPreview(index);
    }
}

/**
 * Handle button clicks for custom CPE buttons
 * @param {Event} event - The click event
 */
function handleCustomCPEButtonClicks(event) {
    // Copy button
    if (event.target.closest('.copy-cpe-btn')) {
        const button = event.target.closest('.copy-cpe-btn');
        const index = button.getAttribute('data-index');
        copyCustomCPEToClipboard(index);
    }
    
    // Apply button
    if (event.target.closest('.apply-custom-cpe-btn')) {
        const button = event.target.closest('.apply-custom-cpe-btn');
        const index = button.getAttribute('data-index');
        applyCustomCPE(index);
    }
}

/**
 * Update the CPE base string preview based on the current form values
 * @param {string} index - The index of the form
 */
function updateCustomCPEPreview(index) {
    // Get form values
    const part = document.getElementById(`custom-cpe-part-${index}`).value;
    const vendor = document.getElementById(`custom-cpe-vendor-${index}`).value;
    const product = document.getElementById(`custom-cpe-product-${index}`).value;
    const targetSw = document.getElementById(`custom-cpe-target-sw-${index}`).value || '*';
    const targetHw = document.getElementById(`custom-cpe-target-hw-${index}`).value || '*';
    const other = document.getElementById(`custom-cpe-other-${index}`).value || '*';
    
    // Format values according to CPE 2.3 rules
    const formattedVendor = formatCPEComponent(vendor);
    const formattedProduct = formatCPEComponent(product);
    const formattedTargetSw = formatCPEComponent(targetSw);
    const formattedTargetHw = formatCPEComponent(targetHw);
    const formattedOther = formatCPEComponent(other);
    
    // Construct CPE base string
    // Format: cpe:2.3:part:vendor:product:*:*:*:*:*:target-sw:target-hw:other
    const cpeBaseString = `cpe:2.3:${part}:${formattedVendor}:${formattedProduct}:*:*:*:*:*:${formattedTargetSw}:${formattedTargetHw}:${formattedOther}`;
    
    // Update preview
    const previewElement = document.getElementById(`custom-cpe-preview-${index}`);
    if (previewElement) {
        previewElement.value = cpeBaseString;
    }
    
    // Update apply button state
    const applyButton = document.querySelector(`.apply-custom-cpe-btn[data-index="${index}"]`);
    if (applyButton) {
        // Only enable if vendor and product are provided
        applyButton.disabled = !formattedVendor || !formattedProduct;
    }
}

/**
 * Format a CPE component according to CPE 2.3 specification
 * @param {string} value - Raw user input value
 * @returns {string} Properly encoded value for CPE 2.3
 */
function formatCPEComponent(value) {
    // Return wildcard for empty/null values
    if (!value || value.trim() === '') return '*';
    
    // Trim and convert to lowercase (CPE spec requires lowercase)
    let formatted = value.trim().toLowerCase();
    
    // If the value is just an asterisk, return it directly as a wildcard
    if (formatted === '*') return '*';
    
    // Replace spaces with underscores (per CPE spec)
    formatted = formatted.replace(/\s+/g, '_');
    
    // Proper CPE 2.3 character encoding for special characters
    // Order matters - escape backslash first, then other characters
    formatted = formatted
        // First escape the backslash itself
        .replace(/\\/g, '\\\\')
        // Then escape other special characters, including asterisks that are not standalone wildcards
        .replace(/\!/g, '\\!')
        .replace(/\"/g, '\\"')
        .replace(/\#/g, '\\#')
        .replace(/\$/g, '\\$')
        .replace(/\%/g, '\\%')
        .replace(/\&/g, '\\&')
        .replace(/\'/g, "\\'")
        .replace(/\(/g, '\\(')
        .replace(/\)/g, '\\)')
        .replace(/\*/g, '\\*') // Always escape * within text (e.g., "version*2" becomes "version\*2")
        .replace(/\+/g, '\\+')
        .replace(/\,/g, '\\,')
        .replace(/\//g, '\\/')
        .replace(/\:/g, '\\:')
        .replace(/\;/g, '\\;')
        .replace(/\</g, '\\<')
        .replace(/\=/g, '\\=')
        .replace(/\>/g, '\\>')
        .replace(/\@/g, '\\@')
        .replace(/\[/g, '\\[')
        .replace(/\]/g, '\\]')
        .replace(/\^/g, '\\^')
        .replace(/\`/g, '\\`')
        .replace(/\{/g, '\\{')
        .replace(/\|/g, '\\|')
        .replace(/\}/g, '\\}')
        .replace(/\~/g, '\\~');
    
    return formatted;
}

/**
 * Copy the custom CPE base string to the clipboard
 * @param {string} index - The index of the form
 */
function copyCustomCPEToClipboard(index) {
    const previewElement = document.getElementById(`custom-cpe-preview-${index}`);
    if (previewElement) {
        previewElement.select();
        document.execCommand('copy');
        
        // Show brief visual feedback
        const copyButton = document.querySelector(`.copy-cpe-btn[data-index="${index}"]`);
        const originalHTML = copyButton.innerHTML;
        copyButton.innerHTML = '<i class="bi bi-check"></i> Copied!';
        setTimeout(() => {
            copyButton.innerHTML = originalHTML;
        }, 1500);
    }
}

/**
 * Apply the custom CPE to the selections and matchesTable
 * @param {string} index - The index of the form
 */
function applyCustomCPE(index) {
    try {
        // Get the CPE string from the preview (already properly encoded)
        const previewElement = document.getElementById(`custom-cpe-preview-${index}`);
        if (!previewElement) {
            console.error(`No preview element found for index ${index}`);
            return;
        }
        
        // Get the properly encoded CPE string directly from the preview element
        const cpeBaseString = previewElement.value;
        
        // Use the encoded string directly - it's already properly formatted
        const normalizedCpeBase = cpeBaseString;
        
        // Get table ID
        const builderContainer = document.getElementById(`customCPEBuilder-content-${index}`);
        if (!builderContainer) {
            console.error(`No builder container found for index ${index}`);
            return;
        }
        
        const tableIndex = index;
        const tableId = `matchesTable_${tableIndex}`;
        
        console.log(`Applying custom CPE for table ${tableId}: ${normalizedCpeBase}`);
        
        // Register custom CPE handler
        registerCustomCpeHandler(normalizedCpeBase, tableId);
        
        // Add a row to the table for this CPE
        const customRow = addCustomCPERowToTable(tableId, cpeBaseString);
        if (!customRow) {
            console.error(`Failed to add custom CPE row to table ${tableId}`);
            return;
        }
        
        // Add to tableSelections directly
        if (!window.tableSelections.has(tableId)) {
            window.tableSelections.set(tableId, new Set());
        }
        
        // CRITICAL: Add the CPE to the selections and add debugging
        window.tableSelections.get(tableId).add(normalizedCpeBase);
        
        // Debug logging to check selections
        console.log(`TRACE: After adding custom CPE to tableSelections`);
        console.log(`TRACE: tableSelections has tableId? ${window.tableSelections.has(tableId)}`);
        console.log(`TRACE: tableSelections.get(tableId) type: ${typeof window.tableSelections.get(tableId)}`);
        console.log(`TRACE: tableSelections.get(tableId) is Set? ${window.tableSelections.get(tableId) instanceof Set}`);
        console.log(`TRACE: tableSelections.get(tableId).size = ${window.tableSelections.get(tableId).size}`);
        console.log(`TRACE: tableSelections.get(tableId) has our CPE? ${window.tableSelections.get(tableId).has(normalizedCpeBase)}`);
        console.log(`TRACE: Current selections for ${tableId}:`, Array.from(window.tableSelections.get(tableId)));
        
        // Make sure the row is marked as selected
        customRow.classList.add('table-active');
        
        try {
            if (typeof updateConsolidatedJson === 'function') {
                console.log(`Calling updateConsolidatedJson for ${tableId}`);
                updateConsolidatedJson(tableId);
            } else {
                console.error('updateConsolidatedJson function not available');
            }
        } catch (e) {
            console.error(`Error updating consolidated JSON: ${e.message}`);
        }
        
        console.log(`Attempted to apply custom CPE: ${cpeBaseString}`);
        return true;
    } catch (e) {
        console.error("Error applying custom CPE:", e);
        return false;
    }
}

/**
 * Register a handler for custom CPEs
 * @param {string} cpeBaseString - The normalized CPE base string
 */
function registerCustomCpeHandler(cpeBaseString, tableId) {
    // Get the table index from tableId
    const tableIndex = tableId.split('_')[1];
    
    // Get rawPlatformData for the correct table
    const extractedData = extractDataFromTable(tableIndex);
    const rawPlatformData = extractedData.rawPlatformData;
      window.customCPEHandlers.set(cpeBaseString, {
        createMatch: function() {
            // Process all versions like the standard handler does
            if (rawPlatformData && rawPlatformData.versions && rawPlatformData.versions.length > 0) {
                // Create array to hold all cpeMatches
                const cpeMatches = [];
                
                // Process all versions using standard processing
                for (const versionInfo of rawPlatformData.versions) {
                    if (!versionInfo) continue;
                    
                    // Determine if this version is vulnerable based on status
                    const isVulnerable = versionInfo.status === "affected";
                    
                    // Create cpeMatch using the consolidated function
                    const cpeMatch = createCpeMatchFromVersionInfo(cpeBaseString, versionInfo, isVulnerable);
                    cpeMatches.push(cpeMatch);
                }
                
                if (cpeMatches.length === 0) {
                    return [createCpeMatchObject(cpeBaseString)];
                }
                
                return cpeMatches;
            } else {
                // Fallback to basic match if no version info
                return [createCpeMatchObject(cpeBaseString)];
            }
        }
    });
    
    console.log(`Registered custom CPE handler for ${cpeBaseString}`);
}

/**
 * Add a custom CPE row to the matchesTable
 * @param {string} tableId - The table ID to add the row to
 * @param {string} cpeBaseString - The properly encoded CPE base string
 * @returns {HTMLTableRowElement|null} - The created row element or null if failed
 */
function addCustomCPERowToTable(tableId, cpeBaseString) {
    console.log(`Adding new row for custom CPE: ${cpeBaseString}`);
    
    // Get the table
    const table = document.getElementById(tableId);
    if (!table) {
        console.error(`Table ${tableId} not found`);
        return null;
    }
    
    // Check if this CPE already has a row
    const existingRow = Array.from(table.querySelectorAll('tr[data-cpe-base]')).find(
        row => row.getAttribute('data-cpe-base') === cpeBaseString
    );
    
    if (existingRow) {
        console.log(`Row for ${cpeBaseString} already exists, selecting it`);
        existingRow.classList.add('table-active');
        return existingRow;
    }
    
    // Create a new row with the same structure as standard rows
    const row = document.createElement('tr');
    row.className = 'cpe-row'; 
    row.setAttribute('role', 'button');
    row.setAttribute('data-cpe-base', cpeBaseString);
    
    // Create CPE string cell (first column)
    const cpeCell = document.createElement('td');
    cpeCell.className = 'text-break';
    cpeCell.textContent = cpeBaseString;
    
    // Create matches details cell (second column)
    const detailsCell = document.createElement('td');
    
    // Create div for badges
    const badgesDiv = document.createElement('div');
    badgesDiv.className = 'd-flex flex-wrap gap-1 align-items-center';
    
    // Add a single badge for custom CPE
    const customBadge = document.createElement('span');
    customBadge.className = 'badge rounded-pill bg-primary';
    customBadge.textContent = 'Custom CPE';
    customBadge.title = 'Added via Custom CPE Builder';
    
    badgesDiv.appendChild(customBadge);
    detailsCell.appendChild(badgesDiv);
    
    // Add cells to row
    row.appendChild(cpeCell);
    row.appendChild(detailsCell);
    
    // CRITICAL FIX: Custom click handler for reliable selection/deselection
    row.style.cursor = 'pointer';
    row.addEventListener('click', function(event) {
        // Don't handle clicks on elements with their own handlers
        if (event.target.tagName === 'BUTTON' || 
            event.target.tagName === 'A' ||
            event.target.closest('button') ||
            event.target.closest('a')) {
            return;
        }
        
        // Toggle selection directly
        console.log(`Click on custom CPE row: ${cpeBaseString}`);
        
        // Get current selections
        if (!window.tableSelections.has(tableId)) {
            window.tableSelections.set(tableId, new Set());
        }
        const selections = window.tableSelections.get(tableId);
        
        // Track before state for debugging
        console.log(`Before click - Row has table-active class: ${this.classList.contains('table-active')}`);
        console.log(`Before click - Selections contains CPE: ${selections.has(cpeBaseString)}`);
        console.log(`Before click - Selections size: ${selections.size}`);
        
        // Toggle selection state
        if (selections.has(cpeBaseString)) {
            // DESELECT
            selections.delete(cpeBaseString);
            this.classList.remove('table-active');
            console.log(`Removed ${cpeBaseString} from selections`);
        } else {
            // SELECT
            selections.add(cpeBaseString);
            this.classList.add('table-active');
            console.log(`Added ${cpeBaseString} to selections`);
        }
        
        // Track after state for debugging
        console.log(`After click - Row has table-active class: ${this.classList.contains('table-active')}`);
        console.log(`After click - Selections contains CPE: ${selections.has(cpeBaseString)}`);
        console.log(`After click - Selections size: ${selections.size}`);
        
        // Update the JSON display
        if (typeof updateConsolidatedJson === 'function') {
            console.log(`Calling updateConsolidatedJson for ${tableId}`);
            updateConsolidatedJson(tableId);
        } else {
            console.error('updateConsolidatedJson function not available');
        }
        
        // Also update Export All button
        if (typeof updateExportAllButton === 'function') {
            updateExportAllButton();
        }
    });
    
    // Add the row to the table at the top
    if (table.tBodies.length > 0) {
        table.tBodies[0].insertBefore(row, table.tBodies[0].firstChild);
    } else {
        // Create tbody if it doesn't exist
        const tbody = document.createElement('tbody');
        tbody.appendChild(row);
        table.appendChild(tbody);
    }    
    console.log(`Added custom CPE row to table ${tableId}`);
    return row;
}





// Automatically initialize the Custom CPE Builder when the DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
    console.log("DOM loaded, initializing Custom CPE Builder...");
    initializeCustomCPEBuilder();
});

/**
 * Get default modular settings for custom CPE processing
 */
function getDefaultModularSettings() {
    return {
        enableWildcardExpansion: true,
        enableVersionChanges: false,
        enableSpecialVersionTypes: false,
        enableInverseStatus: false,
        enableMultipleBranches: true,
        enableMixedStatus: true,
        enableGapProcessing: true,
        enableUpdatePatterns: false
    };
}

/**
 * Get current modular settings for a specific CPE (finds the table it belongs to)
 */
function getCurrentModularSettings(cpeBase) {
    // Find which table this CPE belongs to by checking tableSelections
    if (window.tableSelections) {
        for (const [tableId, selections] of window.tableSelections.entries()) {
            if (selections && selections.has(cpeBase)) {
                // Found the table, get its settings
                const tableSettings = window.rowSettings ? window.rowSettings.get(tableId) : {};
                  return {
                    enableWildcardExpansion: tableSettings.enableWildcardExpansion !== undefined ? tableSettings.enableWildcardExpansion : false,
                    enableVersionChanges: tableSettings.enableVersionChanges !== undefined ? tableSettings.enableVersionChanges : false,
                    enableSpecialVersionTypes: tableSettings.enableSpecialVersionTypes !== undefined ? tableSettings.enableSpecialVersionTypes : false,
                    enableInverseStatus: tableSettings.enableInverseStatus !== undefined ? tableSettings.enableInverseStatus : false,
                    enableMultipleBranches: tableSettings.enableMultipleBranches !== undefined ? tableSettings.enableMultipleBranches : false,
                    enableMixedStatus: tableSettings.enableMixedStatus !== undefined ? tableSettings.enableMixedStatus : false,
                    enableGapProcessing: tableSettings.enableGapProcessing !== undefined ? tableSettings.enableGapProcessing : false,
                    enableUpdatePatterns: tableSettings.enableUpdatePatterns !== undefined ? tableSettings.enableUpdatePatterns : false,
                    // Core features remain enabled
                    enableStatusProcessing: true,
                    enableRangeHandling: true
                };
            }
        }
    }    
    // Fallback to default settings
    console.log(`Could not find table for CPE ${cpeBase}, using default settings`);
    return getDefaultModularSettings();
}

// =============================================================================
// Global Exports - All window assignments consolidated here
// =============================================================================
window.initializeCustomCPEBuilder = initializeCustomCPEBuilder;
window.updateCustomCPEPreview = updateCustomCPEPreview;
window.formatCPEComponent = formatCPEComponent;
window.applyCustomCPE = applyCustomCPE;
window.getCurrentModularSettings = getCurrentModularSettings;


    // JSON Settings HTML generated by Python and injected on page load
    window.JSON_SETTINGS_HTML = {"matchesTable_0": "    <div class=\"card\">        <div class=\"card-header d-flex justify-content-between align-items-center\"              style=\"cursor: pointer;\"             data-bs-toggle=\"collapse\"              data-bs-target=\"#settingsCollapse_matchesTable_0\">            <h6 class=\"mb-0\">                <i class=\"fas fa-cog\"></i> JSON Generation Settings            </h6>            <span class=\"arrow-icon\">&uarr;</span>        </div>        <div id=\"settingsCollapse_matchesTable_0\" class=\"collapse\">            <div class=\"card-body\">                <div class=\"row\">                    <div class=\"col-md-6\">                        <h6 class=\"text-muted mb-2\">Processing Features</h6>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableWildcards_matchesTable_0\"                                    data-setting=\"enableWildcardExpansion\"                                   data-table-id=\"matchesTable_0\"                                    >                            <label class=\"form-check-label\" for=\"enableWildcards_matchesTable_0\"                                    data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Converts wildcard patterns into version ranges. For example, '5.4.*' becomes a range from '5.4.0' to '5.5.0' (exclusive). Useful when version data contains wildcard patterns that need to be expanded into precise ranges for matching.\">                                <small>Expand Wildcards                                     <span class=\"text-muted\">(5.4.* \u2192 ranges)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasWildcards\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableGaps_matchesTable_0\"                                    data-setting=\"enableGapProcessing\"                                   data-table-id=\"matchesTable_0\"                                    checked>                            <label class=\"form-check-label\" for=\"enableGaps_matchesTable_0\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Fills gaps between unaffected version ranges by inferring affected versions. For example, if 1.0-2.0 and 4.0-5.0 are unaffected, it infers that 2.1-3.9 is affected. Particularly useful when vulnerability data specifies what's NOT affected rather than what IS affected.\">                                <small>Fill Gaps                                     <span class=\"text-muted\">(infer affected ranges)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasGapProcessing\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enablePatches_matchesTable_0\"                                    data-setting=\"enableVersionChanges\"                                   data-table-id=\"matchesTable_0\"                                    >                            <label class=\"form-check-label\" for=\"enablePatches_matchesTable_0\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Processes version.changes arrays to extract patch and fix information. For example, if a version has changes: [status: 'fixed', at: '1.2.3'], it creates a vulnerable range from the base version up to (but not including) the fix version. Essential for handling detailed patching timelines.\">                                <small>Process Patches                                     <span class=\"text-muted\">(version.changes)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasVersionChanges\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableSpecialTypes_matchesTable_0\"                                    data-setting=\"enableSpecialVersionTypes\"                                   data-table-id=\"matchesTable_0\"                                    checked>                            <label class=\"form-check-label\" for=\"enableSpecialTypes_matchesTable_0\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles non-standard version types beyond semantic versioning. Examples include date-based versions (20231201), commit hashes (abc123def), custom version schemes, or version types marked with special versionType fields. Required when dealing with diverse software versioning schemes.\">                                <small>Special Version Types                                     <span class=\"text-muted\">(dates, commits)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasSpecialVersionTypes\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableMultipleBranches_matchesTable_0\"                                    data-setting=\"enableMultipleBranches\"                                   data-table-id=\"matchesTable_0\"                                    >                            <label class=\"form-check-label\" for=\"enableMultipleBranches_matchesTable_0\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles products with multiple version families or branches (\u22653 major.minor combinations). For example, a product with versions 1.0.x, 2.1.x, 3.0.x, and 4.2.x has multiple branches. Groups and processes each branch separately to handle complex version trees with parallel development streams.\">                                <small>Multiple Branches                                     <span class=\"text-muted\">(\u22653 version families)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasMultipleBranches\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableUpdatePatterns_matchesTable_0\"                                    data-setting=\"enableUpdatePatterns\"                                   data-table-id=\"matchesTable_0\"                                    checked>                            <label class=\"form-check-label\" for=\"enableUpdatePatterns_matchesTable_0\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Recognizes and processes update patterns in version strings. Handles formats like '3.1.0 p7' (patch 7), '2.0.0 sp1' (service pack 1), '1.0.0-hotfix.2', or '4.0 update 3'. Transforms these into proper CPE format with update components for accurate vulnerability matching.\">                                <small>Update Pattern Processing                                     <span class=\"text-muted\">(patch, service pack, hotfix)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasUpdatePatterns\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                    </div>                    <div class=\"col-md-6\">                        <h6 class=\"text-muted mb-2\">Status Processing</h6>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableInverseStatus_matchesTable_0\"                                    data-setting=\"enableInverseStatus\"                                   data-table-id=\"matchesTable_0\"                                    checked>                            <label class=\"form-check-label\" for=\"enableInverseStatus_matchesTable_0\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles cases where defaultStatus='unaffected' with explicit affected entries. Instead of assuming all versions are vulnerable, it processes only the specifically marked affected versions while treating everything else as unaffected. Common in advisories that list specific vulnerable versions.\">                                <small>Inverse Status                                     <span class=\"text-muted\">(default unaffected)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasInverseStatus\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableMixedStatus_matchesTable_0\"                                    data-setting=\"enableMixedStatus\"                                   data-table-id=\"matchesTable_0\"                                    >                            <label class=\"form-check-label\" for=\"enableMixedStatus_matchesTable_0\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles complex scenarios with both affected and multiple unaffected versions in the same dataset. Processes mixed status combinations where some versions are explicitly marked as affected while others are marked as unaffected. Useful for complex vulnerability patterns with scattered affected versions.\">                                <small>Mixed Status                                     <span class=\"text-muted\">(multiple unaffected)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasMixedStatus\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                    </div>                </div>            </div>        </div>    </div>    ", "matchesTable_1": "    <div class=\"card\">        <div class=\"card-header d-flex justify-content-between align-items-center\"              style=\"cursor: pointer;\"             data-bs-toggle=\"collapse\"              data-bs-target=\"#settingsCollapse_matchesTable_1\">            <h6 class=\"mb-0\">                <i class=\"fas fa-cog\"></i> JSON Generation Settings            </h6>            <span class=\"arrow-icon\">&uarr;</span>        </div>        <div id=\"settingsCollapse_matchesTable_1\" class=\"collapse\">            <div class=\"card-body\">                <div class=\"row\">                    <div class=\"col-md-6\">                        <h6 class=\"text-muted mb-2\">Processing Features</h6>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableWildcards_matchesTable_1\"                                    data-setting=\"enableWildcardExpansion\"                                   data-table-id=\"matchesTable_1\"                                    checked>                            <label class=\"form-check-label\" for=\"enableWildcards_matchesTable_1\"                                    data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Converts wildcard patterns into version ranges. For example, '5.4.*' becomes a range from '5.4.0' to '5.5.0' (exclusive). Useful when version data contains wildcard patterns that need to be expanded into precise ranges for matching.\">                                <small>Expand Wildcards                                     <span class=\"text-muted\">(5.4.* \u2192 ranges)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasWildcards\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableGaps_matchesTable_1\"                                    data-setting=\"enableGapProcessing\"                                   data-table-id=\"matchesTable_1\"                                    checked>                            <label class=\"form-check-label\" for=\"enableGaps_matchesTable_1\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Fills gaps between unaffected version ranges by inferring affected versions. For example, if 1.0-2.0 and 4.0-5.0 are unaffected, it infers that 2.1-3.9 is affected. Particularly useful when vulnerability data specifies what's NOT affected rather than what IS affected.\">                                <small>Fill Gaps                                     <span class=\"text-muted\">(infer affected ranges)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasGapProcessing\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enablePatches_matchesTable_1\"                                    data-setting=\"enableVersionChanges\"                                   data-table-id=\"matchesTable_1\"                                    >                            <label class=\"form-check-label\" for=\"enablePatches_matchesTable_1\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Processes version.changes arrays to extract patch and fix information. For example, if a version has changes: [status: 'fixed', at: '1.2.3'], it creates a vulnerable range from the base version up to (but not including) the fix version. Essential for handling detailed patching timelines.\">                                <small>Process Patches                                     <span class=\"text-muted\">(version.changes)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasVersionChanges\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableSpecialTypes_matchesTable_1\"                                    data-setting=\"enableSpecialVersionTypes\"                                   data-table-id=\"matchesTable_1\"                                    checked>                            <label class=\"form-check-label\" for=\"enableSpecialTypes_matchesTable_1\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles non-standard version types beyond semantic versioning. Examples include date-based versions (20231201), commit hashes (abc123def), custom version schemes, or version types marked with special versionType fields. Required when dealing with diverse software versioning schemes.\">                                <small>Special Version Types                                     <span class=\"text-muted\">(dates, commits)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasSpecialVersionTypes\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableMultipleBranches_matchesTable_1\"                                    data-setting=\"enableMultipleBranches\"                                   data-table-id=\"matchesTable_1\"                                    checked>                            <label class=\"form-check-label\" for=\"enableMultipleBranches_matchesTable_1\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles products with multiple version families or branches (\u22653 major.minor combinations). For example, a product with versions 1.0.x, 2.1.x, 3.0.x, and 4.2.x has multiple branches. Groups and processes each branch separately to handle complex version trees with parallel development streams.\">                                <small>Multiple Branches                                     <span class=\"text-muted\">(\u22653 version families)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasMultipleBranches\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableUpdatePatterns_matchesTable_1\"                                    data-setting=\"enableUpdatePatterns\"                                   data-table-id=\"matchesTable_1\"                                    >                            <label class=\"form-check-label\" for=\"enableUpdatePatterns_matchesTable_1\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Recognizes and processes update patterns in version strings. Handles formats like '3.1.0 p7' (patch 7), '2.0.0 sp1' (service pack 1), '1.0.0-hotfix.2', or '4.0 update 3'. Transforms these into proper CPE format with update components for accurate vulnerability matching.\">                                <small>Update Pattern Processing                                     <span class=\"text-muted\">(patch, service pack, hotfix)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasUpdatePatterns\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                    </div>                    <div class=\"col-md-6\">                        <h6 class=\"text-muted mb-2\">Status Processing</h6>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableInverseStatus_matchesTable_1\"                                    data-setting=\"enableInverseStatus\"                                   data-table-id=\"matchesTable_1\"                                    >                            <label class=\"form-check-label\" for=\"enableInverseStatus_matchesTable_1\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles cases where defaultStatus='unaffected' with explicit affected entries. Instead of assuming all versions are vulnerable, it processes only the specifically marked affected versions while treating everything else as unaffected. Common in advisories that list specific vulnerable versions.\">                                <small>Inverse Status                                     <span class=\"text-muted\">(default unaffected)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasInverseStatus\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableMixedStatus_matchesTable_1\"                                    data-setting=\"enableMixedStatus\"                                   data-table-id=\"matchesTable_1\"                                    checked>                            <label class=\"form-check-label\" for=\"enableMixedStatus_matchesTable_1\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles complex scenarios with both affected and multiple unaffected versions in the same dataset. Processes mixed status combinations where some versions are explicitly marked as affected while others are marked as unaffected. Useful for complex vulnerability patterns with scattered affected versions.\">                                <small>Mixed Status                                     <span class=\"text-muted\">(multiple unaffected)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasMixedStatus\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                    </div>                </div>            </div>        </div>    </div>    ", "matchesTable_2": "    <div class=\"card\">        <div class=\"card-header d-flex justify-content-between align-items-center\"              style=\"cursor: pointer;\"             data-bs-toggle=\"collapse\"              data-bs-target=\"#settingsCollapse_matchesTable_2\">            <h6 class=\"mb-0\">                <i class=\"fas fa-cog\"></i> JSON Generation Settings            </h6>            <span class=\"arrow-icon\">&uarr;</span>        </div>        <div id=\"settingsCollapse_matchesTable_2\" class=\"collapse\">            <div class=\"card-body\">                <div class=\"row\">                    <div class=\"col-md-6\">                        <h6 class=\"text-muted mb-2\">Processing Features</h6>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableWildcards_matchesTable_2\"                                    data-setting=\"enableWildcardExpansion\"                                   data-table-id=\"matchesTable_2\"                                    >                            <label class=\"form-check-label\" for=\"enableWildcards_matchesTable_2\"                                    data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Converts wildcard patterns into version ranges. For example, '5.4.*' becomes a range from '5.4.0' to '5.5.0' (exclusive). Useful when version data contains wildcard patterns that need to be expanded into precise ranges for matching.\">                                <small>Expand Wildcards                                     <span class=\"text-muted\">(5.4.* \u2192 ranges)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasWildcards\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableGaps_matchesTable_2\"                                    data-setting=\"enableGapProcessing\"                                   data-table-id=\"matchesTable_2\"                                    checked>                            <label class=\"form-check-label\" for=\"enableGaps_matchesTable_2\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Fills gaps between unaffected version ranges by inferring affected versions. For example, if 1.0-2.0 and 4.0-5.0 are unaffected, it infers that 2.1-3.9 is affected. Particularly useful when vulnerability data specifies what's NOT affected rather than what IS affected.\">                                <small>Fill Gaps                                     <span class=\"text-muted\">(infer affected ranges)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasGapProcessing\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enablePatches_matchesTable_2\"                                    data-setting=\"enableVersionChanges\"                                   data-table-id=\"matchesTable_2\"                                    >                            <label class=\"form-check-label\" for=\"enablePatches_matchesTable_2\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Processes version.changes arrays to extract patch and fix information. For example, if a version has changes: [status: 'fixed', at: '1.2.3'], it creates a vulnerable range from the base version up to (but not including) the fix version. Essential for handling detailed patching timelines.\">                                <small>Process Patches                                     <span class=\"text-muted\">(version.changes)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasVersionChanges\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableSpecialTypes_matchesTable_2\"                                    data-setting=\"enableSpecialVersionTypes\"                                   data-table-id=\"matchesTable_2\"                                    checked>                            <label class=\"form-check-label\" for=\"enableSpecialTypes_matchesTable_2\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles non-standard version types beyond semantic versioning. Examples include date-based versions (20231201), commit hashes (abc123def), custom version schemes, or version types marked with special versionType fields. Required when dealing with diverse software versioning schemes.\">                                <small>Special Version Types                                     <span class=\"text-muted\">(dates, commits)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasSpecialVersionTypes\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableMultipleBranches_matchesTable_2\"                                    data-setting=\"enableMultipleBranches\"                                   data-table-id=\"matchesTable_2\"                                    >                            <label class=\"form-check-label\" for=\"enableMultipleBranches_matchesTable_2\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles products with multiple version families or branches (\u22653 major.minor combinations). For example, a product with versions 1.0.x, 2.1.x, 3.0.x, and 4.2.x has multiple branches. Groups and processes each branch separately to handle complex version trees with parallel development streams.\">                                <small>Multiple Branches                                     <span class=\"text-muted\">(\u22653 version families)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasMultipleBranches\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableUpdatePatterns_matchesTable_2\"                                    data-setting=\"enableUpdatePatterns\"                                   data-table-id=\"matchesTable_2\"                                    >                            <label class=\"form-check-label\" for=\"enableUpdatePatterns_matchesTable_2\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Recognizes and processes update patterns in version strings. Handles formats like '3.1.0 p7' (patch 7), '2.0.0 sp1' (service pack 1), '1.0.0-hotfix.2', or '4.0 update 3'. Transforms these into proper CPE format with update components for accurate vulnerability matching.\">                                <small>Update Pattern Processing                                     <span class=\"text-muted\">(patch, service pack, hotfix)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasUpdatePatterns\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                    </div>                    <div class=\"col-md-6\">                        <h6 class=\"text-muted mb-2\">Status Processing</h6>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableInverseStatus_matchesTable_2\"                                    data-setting=\"enableInverseStatus\"                                   data-table-id=\"matchesTable_2\"                                    checked>                            <label class=\"form-check-label\" for=\"enableInverseStatus_matchesTable_2\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles cases where defaultStatus='unaffected' with explicit affected entries. Instead of assuming all versions are vulnerable, it processes only the specifically marked affected versions while treating everything else as unaffected. Common in advisories that list specific vulnerable versions.\">                                <small>Inverse Status                                     <span class=\"text-muted\">(default unaffected)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasInverseStatus\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableMixedStatus_matchesTable_2\"                                    data-setting=\"enableMixedStatus\"                                   data-table-id=\"matchesTable_2\"                                    >                            <label class=\"form-check-label\" for=\"enableMixedStatus_matchesTable_2\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles complex scenarios with both affected and multiple unaffected versions in the same dataset. Processes mixed status combinations where some versions are explicitly marked as affected while others are marked as unaffected. Useful for complex vulnerability patterns with scattered affected versions.\">                                <small>Mixed Status                                     <span class=\"text-muted\">(multiple unaffected)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasMixedStatus\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                    </div>                </div>            </div>        </div>    </div>    ", "matchesTable_3": "    <div class=\"card\">        <div class=\"card-header d-flex justify-content-between align-items-center\"              style=\"cursor: pointer;\"             data-bs-toggle=\"collapse\"              data-bs-target=\"#settingsCollapse_matchesTable_3\">            <h6 class=\"mb-0\">                <i class=\"fas fa-cog\"></i> JSON Generation Settings            </h6>            <span class=\"arrow-icon\">&uarr;</span>        </div>        <div id=\"settingsCollapse_matchesTable_3\" class=\"collapse\">            <div class=\"card-body\">                <div class=\"row\">                    <div class=\"col-md-6\">                        <h6 class=\"text-muted mb-2\">Processing Features</h6>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableWildcards_matchesTable_3\"                                    data-setting=\"enableWildcardExpansion\"                                   data-table-id=\"matchesTable_3\"                                    >                            <label class=\"form-check-label\" for=\"enableWildcards_matchesTable_3\"                                    data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Converts wildcard patterns into version ranges. For example, '5.4.*' becomes a range from '5.4.0' to '5.5.0' (exclusive). Useful when version data contains wildcard patterns that need to be expanded into precise ranges for matching.\">                                <small>Expand Wildcards                                     <span class=\"text-muted\">(5.4.* \u2192 ranges)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasWildcards\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableGaps_matchesTable_3\"                                    data-setting=\"enableGapProcessing\"                                   data-table-id=\"matchesTable_3\"                                    >                            <label class=\"form-check-label\" for=\"enableGaps_matchesTable_3\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Fills gaps between unaffected version ranges by inferring affected versions. For example, if 1.0-2.0 and 4.0-5.0 are unaffected, it infers that 2.1-3.9 is affected. Particularly useful when vulnerability data specifies what's NOT affected rather than what IS affected.\">                                <small>Fill Gaps                                     <span class=\"text-muted\">(infer affected ranges)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasGapProcessing\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enablePatches_matchesTable_3\"                                    data-setting=\"enableVersionChanges\"                                   data-table-id=\"matchesTable_3\"                                    >                            <label class=\"form-check-label\" for=\"enablePatches_matchesTable_3\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Processes version.changes arrays to extract patch and fix information. For example, if a version has changes: [status: 'fixed', at: '1.2.3'], it creates a vulnerable range from the base version up to (but not including) the fix version. Essential for handling detailed patching timelines.\">                                <small>Process Patches                                     <span class=\"text-muted\">(version.changes)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasVersionChanges\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableSpecialTypes_matchesTable_3\"                                    data-setting=\"enableSpecialVersionTypes\"                                   data-table-id=\"matchesTable_3\"                                    >                            <label class=\"form-check-label\" for=\"enableSpecialTypes_matchesTable_3\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles non-standard version types beyond semantic versioning. Examples include date-based versions (20231201), commit hashes (abc123def), custom version schemes, or version types marked with special versionType fields. Required when dealing with diverse software versioning schemes.\">                                <small>Special Version Types                                     <span class=\"text-muted\">(dates, commits)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasSpecialVersionTypes\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableMultipleBranches_matchesTable_3\"                                    data-setting=\"enableMultipleBranches\"                                   data-table-id=\"matchesTable_3\"                                    >                            <label class=\"form-check-label\" for=\"enableMultipleBranches_matchesTable_3\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles products with multiple version families or branches (\u22653 major.minor combinations). For example, a product with versions 1.0.x, 2.1.x, 3.0.x, and 4.2.x has multiple branches. Groups and processes each branch separately to handle complex version trees with parallel development streams.\">                                <small>Multiple Branches                                     <span class=\"text-muted\">(\u22653 version families)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasMultipleBranches\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableUpdatePatterns_matchesTable_3\"                                    data-setting=\"enableUpdatePatterns\"                                   data-table-id=\"matchesTable_3\"                                    >                            <label class=\"form-check-label\" for=\"enableUpdatePatterns_matchesTable_3\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Recognizes and processes update patterns in version strings. Handles formats like '3.1.0 p7' (patch 7), '2.0.0 sp1' (service pack 1), '1.0.0-hotfix.2', or '4.0 update 3'. Transforms these into proper CPE format with update components for accurate vulnerability matching.\">                                <small>Update Pattern Processing                                     <span class=\"text-muted\">(patch, service pack, hotfix)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasUpdatePatterns\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                    </div>                    <div class=\"col-md-6\">                        <h6 class=\"text-muted mb-2\">Status Processing</h6>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableInverseStatus_matchesTable_3\"                                    data-setting=\"enableInverseStatus\"                                   data-table-id=\"matchesTable_3\"                                    >                            <label class=\"form-check-label\" for=\"enableInverseStatus_matchesTable_3\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles cases where defaultStatus='unaffected' with explicit affected entries. Instead of assuming all versions are vulnerable, it processes only the specifically marked affected versions while treating everything else as unaffected. Common in advisories that list specific vulnerable versions.\">                                <small>Inverse Status                                     <span class=\"text-muted\">(default unaffected)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasInverseStatus\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableMixedStatus_matchesTable_3\"                                    data-setting=\"enableMixedStatus\"                                   data-table-id=\"matchesTable_3\"                                    >                            <label class=\"form-check-label\" for=\"enableMixedStatus_matchesTable_3\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles complex scenarios with both affected and multiple unaffected versions in the same dataset. Processes mixed status combinations where some versions are explicitly marked as affected while others are marked as unaffected. Useful for complex vulnerability patterns with scattered affected versions.\">                                <small>Mixed Status                                     <span class=\"text-muted\">(multiple unaffected)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasMixedStatus\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                    </div>                </div>            </div>        </div>    </div>    ", "matchesTable_4": "    <div class=\"card\">        <div class=\"card-header d-flex justify-content-between align-items-center\"              style=\"cursor: pointer;\"             data-bs-toggle=\"collapse\"              data-bs-target=\"#settingsCollapse_matchesTable_4\">            <h6 class=\"mb-0\">                <i class=\"fas fa-cog\"></i> JSON Generation Settings            </h6>            <span class=\"arrow-icon\">&uarr;</span>        </div>        <div id=\"settingsCollapse_matchesTable_4\" class=\"collapse\">            <div class=\"card-body\">                <div class=\"row\">                    <div class=\"col-md-6\">                        <h6 class=\"text-muted mb-2\">Processing Features</h6>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableWildcards_matchesTable_4\"                                    data-setting=\"enableWildcardExpansion\"                                   data-table-id=\"matchesTable_4\"                                    >                            <label class=\"form-check-label\" for=\"enableWildcards_matchesTable_4\"                                    data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Converts wildcard patterns into version ranges. For example, '5.4.*' becomes a range from '5.4.0' to '5.5.0' (exclusive). Useful when version data contains wildcard patterns that need to be expanded into precise ranges for matching.\">                                <small>Expand Wildcards                                     <span class=\"text-muted\">(5.4.* \u2192 ranges)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasWildcards\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableGaps_matchesTable_4\"                                    data-setting=\"enableGapProcessing\"                                   data-table-id=\"matchesTable_4\"                                    >                            <label class=\"form-check-label\" for=\"enableGaps_matchesTable_4\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Fills gaps between unaffected version ranges by inferring affected versions. For example, if 1.0-2.0 and 4.0-5.0 are unaffected, it infers that 2.1-3.9 is affected. Particularly useful when vulnerability data specifies what's NOT affected rather than what IS affected.\">                                <small>Fill Gaps                                     <span class=\"text-muted\">(infer affected ranges)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasGapProcessing\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enablePatches_matchesTable_4\"                                    data-setting=\"enableVersionChanges\"                                   data-table-id=\"matchesTable_4\"                                    >                            <label class=\"form-check-label\" for=\"enablePatches_matchesTable_4\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Processes version.changes arrays to extract patch and fix information. For example, if a version has changes: [status: 'fixed', at: '1.2.3'], it creates a vulnerable range from the base version up to (but not including) the fix version. Essential for handling detailed patching timelines.\">                                <small>Process Patches                                     <span class=\"text-muted\">(version.changes)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasVersionChanges\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableSpecialTypes_matchesTable_4\"                                    data-setting=\"enableSpecialVersionTypes\"                                   data-table-id=\"matchesTable_4\"                                    >                            <label class=\"form-check-label\" for=\"enableSpecialTypes_matchesTable_4\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles non-standard version types beyond semantic versioning. Examples include date-based versions (20231201), commit hashes (abc123def), custom version schemes, or version types marked with special versionType fields. Required when dealing with diverse software versioning schemes.\">                                <small>Special Version Types                                     <span class=\"text-muted\">(dates, commits)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasSpecialVersionTypes\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableMultipleBranches_matchesTable_4\"                                    data-setting=\"enableMultipleBranches\"                                   data-table-id=\"matchesTable_4\"                                    >                            <label class=\"form-check-label\" for=\"enableMultipleBranches_matchesTable_4\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles products with multiple version families or branches (\u22653 major.minor combinations). For example, a product with versions 1.0.x, 2.1.x, 3.0.x, and 4.2.x has multiple branches. Groups and processes each branch separately to handle complex version trees with parallel development streams.\">                                <small>Multiple Branches                                     <span class=\"text-muted\">(\u22653 version families)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasMultipleBranches\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableUpdatePatterns_matchesTable_4\"                                    data-setting=\"enableUpdatePatterns\"                                   data-table-id=\"matchesTable_4\"                                    >                            <label class=\"form-check-label\" for=\"enableUpdatePatterns_matchesTable_4\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Recognizes and processes update patterns in version strings. Handles formats like '3.1.0 p7' (patch 7), '2.0.0 sp1' (service pack 1), '1.0.0-hotfix.2', or '4.0 update 3'. Transforms these into proper CPE format with update components for accurate vulnerability matching.\">                                <small>Update Pattern Processing                                     <span class=\"text-muted\">(patch, service pack, hotfix)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasUpdatePatterns\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                    </div>                    <div class=\"col-md-6\">                        <h6 class=\"text-muted mb-2\">Status Processing</h6>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableInverseStatus_matchesTable_4\"                                    data-setting=\"enableInverseStatus\"                                   data-table-id=\"matchesTable_4\"                                    >                            <label class=\"form-check-label\" for=\"enableInverseStatus_matchesTable_4\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles cases where defaultStatus='unaffected' with explicit affected entries. Instead of assuming all versions are vulnerable, it processes only the specifically marked affected versions while treating everything else as unaffected. Common in advisories that list specific vulnerable versions.\">                                <small>Inverse Status                                     <span class=\"text-muted\">(default unaffected)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasInverseStatus\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableMixedStatus_matchesTable_4\"                                    data-setting=\"enableMixedStatus\"                                   data-table-id=\"matchesTable_4\"                                    >                            <label class=\"form-check-label\" for=\"enableMixedStatus_matchesTable_4\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles complex scenarios with both affected and multiple unaffected versions in the same dataset. Processes mixed status combinations where some versions are explicitly marked as affected while others are marked as unaffected. Useful for complex vulnerability patterns with scattered affected versions.\">                                <small>Mixed Status                                     <span class=\"text-muted\">(multiple unaffected)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasMixedStatus\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                    </div>                </div>            </div>        </div>    </div>    ", "matchesTable_5": "    <div class=\"card\">        <div class=\"card-header d-flex justify-content-between align-items-center\"              style=\"cursor: pointer;\"             data-bs-toggle=\"collapse\"              data-bs-target=\"#settingsCollapse_matchesTable_5\">            <h6 class=\"mb-0\">                <i class=\"fas fa-cog\"></i> JSON Generation Settings            </h6>            <span class=\"arrow-icon\">&uarr;</span>        </div>        <div id=\"settingsCollapse_matchesTable_5\" class=\"collapse\">            <div class=\"card-body\">                <div class=\"row\">                    <div class=\"col-md-6\">                        <h6 class=\"text-muted mb-2\">Processing Features</h6>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableWildcards_matchesTable_5\"                                    data-setting=\"enableWildcardExpansion\"                                   data-table-id=\"matchesTable_5\"                                    >                            <label class=\"form-check-label\" for=\"enableWildcards_matchesTable_5\"                                    data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Converts wildcard patterns into version ranges. For example, '5.4.*' becomes a range from '5.4.0' to '5.5.0' (exclusive). Useful when version data contains wildcard patterns that need to be expanded into precise ranges for matching.\">                                <small>Expand Wildcards                                     <span class=\"text-muted\">(5.4.* \u2192 ranges)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasWildcards\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableGaps_matchesTable_5\"                                    data-setting=\"enableGapProcessing\"                                   data-table-id=\"matchesTable_5\"                                    >                            <label class=\"form-check-label\" for=\"enableGaps_matchesTable_5\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Fills gaps between unaffected version ranges by inferring affected versions. For example, if 1.0-2.0 and 4.0-5.0 are unaffected, it infers that 2.1-3.9 is affected. Particularly useful when vulnerability data specifies what's NOT affected rather than what IS affected.\">                                <small>Fill Gaps                                     <span class=\"text-muted\">(infer affected ranges)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasGapProcessing\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enablePatches_matchesTable_5\"                                    data-setting=\"enableVersionChanges\"                                   data-table-id=\"matchesTable_5\"                                    >                            <label class=\"form-check-label\" for=\"enablePatches_matchesTable_5\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Processes version.changes arrays to extract patch and fix information. For example, if a version has changes: [status: 'fixed', at: '1.2.3'], it creates a vulnerable range from the base version up to (but not including) the fix version. Essential for handling detailed patching timelines.\">                                <small>Process Patches                                     <span class=\"text-muted\">(version.changes)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasVersionChanges\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableSpecialTypes_matchesTable_5\"                                    data-setting=\"enableSpecialVersionTypes\"                                   data-table-id=\"matchesTable_5\"                                    >                            <label class=\"form-check-label\" for=\"enableSpecialTypes_matchesTable_5\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles non-standard version types beyond semantic versioning. Examples include date-based versions (20231201), commit hashes (abc123def), custom version schemes, or version types marked with special versionType fields. Required when dealing with diverse software versioning schemes.\">                                <small>Special Version Types                                     <span class=\"text-muted\">(dates, commits)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasSpecialVersionTypes\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableMultipleBranches_matchesTable_5\"                                    data-setting=\"enableMultipleBranches\"                                   data-table-id=\"matchesTable_5\"                                    >                            <label class=\"form-check-label\" for=\"enableMultipleBranches_matchesTable_5\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles products with multiple version families or branches (\u22653 major.minor combinations). For example, a product with versions 1.0.x, 2.1.x, 3.0.x, and 4.2.x has multiple branches. Groups and processes each branch separately to handle complex version trees with parallel development streams.\">                                <small>Multiple Branches                                     <span class=\"text-muted\">(\u22653 version families)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasMultipleBranches\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableUpdatePatterns_matchesTable_5\"                                    data-setting=\"enableUpdatePatterns\"                                   data-table-id=\"matchesTable_5\"                                    >                            <label class=\"form-check-label\" for=\"enableUpdatePatterns_matchesTable_5\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Recognizes and processes update patterns in version strings. Handles formats like '3.1.0 p7' (patch 7), '2.0.0 sp1' (service pack 1), '1.0.0-hotfix.2', or '4.0 update 3'. Transforms these into proper CPE format with update components for accurate vulnerability matching.\">                                <small>Update Pattern Processing                                     <span class=\"text-muted\">(patch, service pack, hotfix)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasUpdatePatterns\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                    </div>                    <div class=\"col-md-6\">                        <h6 class=\"text-muted mb-2\">Status Processing</h6>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableInverseStatus_matchesTable_5\"                                    data-setting=\"enableInverseStatus\"                                   data-table-id=\"matchesTable_5\"                                    >                            <label class=\"form-check-label\" for=\"enableInverseStatus_matchesTable_5\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles cases where defaultStatus='unaffected' with explicit affected entries. Instead of assuming all versions are vulnerable, it processes only the specifically marked affected versions while treating everything else as unaffected. Common in advisories that list specific vulnerable versions.\">                                <small>Inverse Status                                     <span class=\"text-muted\">(default unaffected)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasInverseStatus\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                        <div class=\"form-check mb-1\">                            <input class=\"form-check-input row-setting\" type=\"checkbox\"                                    id=\"enableMixedStatus_matchesTable_5\"                                    data-setting=\"enableMixedStatus\"                                   data-table-id=\"matchesTable_5\"                                    >                            <label class=\"form-check-label\" for=\"enableMixedStatus_matchesTable_5\"                                   data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"                                    title=\"Handles complex scenarios with both affected and multiple unaffected versions in the same dataset. Processes mixed status combinations where some versions are explicitly marked as affected while others are marked as unaffected. Useful for complex vulnerability patterns with scattered affected versions.\">                                <small>Mixed Status                                     <span class=\"text-muted\">(multiple unaffected)</span>                                    <span class=\"feature-indicator\" data-feature=\"hasMixedStatus\"></span>                                    <i class=\"fas fa-info-circle text-muted ms-1\"></i>                                </small>                            </label>                        </div>                    </div>                </div>            </div>        </div>    </div>    "};
    console.log('Loaded JSON settings HTML for', Object.keys(window.JSON_SETTINGS_HTML).length, 'tables');
    
        // Intelligent settings computed by Python
        window.INTELLIGENT_SETTINGS = {"matchesTable_0": {"enableWildcardExpansion": false, "enableVersionChanges": false, "enableSpecialVersionTypes": true, "enableInverseStatus": true, "enableMultipleBranches": false, "enableMixedStatus": false, "enableGapProcessing": true, "enableUpdatePatterns": true}, "matchesTable_1": {"enableWildcardExpansion": true, "enableVersionChanges": false, "enableSpecialVersionTypes": true, "enableInverseStatus": false, "enableMultipleBranches": true, "enableMixedStatus": true, "enableGapProcessing": true, "enableUpdatePatterns": false}, "matchesTable_2": {"enableWildcardExpansion": false, "enableVersionChanges": false, "enableSpecialVersionTypes": true, "enableInverseStatus": true, "enableMultipleBranches": false, "enableMixedStatus": false, "enableGapProcessing": true, "enableUpdatePatterns": false}, "matchesTable_3": {"enableWildcardExpansion": false, "enableVersionChanges": false, "enableSpecialVersionTypes": false, "enableInverseStatus": false, "enableMultipleBranches": false, "enableMixedStatus": false, "enableGapProcessing": false, "enableUpdatePatterns": false}, "matchesTable_4": {"enableWildcardExpansion": false, "enableVersionChanges": false, "enableSpecialVersionTypes": false, "enableInverseStatus": false, "enableMultipleBranches": false, "enableMixedStatus": false, "enableGapProcessing": false, "enableUpdatePatterns": false}, "matchesTable_5": {"enableWildcardExpansion": false, "enableVersionChanges": false, "enableSpecialVersionTypes": false, "enableInverseStatus": false, "enableMultipleBranches": false, "enableMixedStatus": false, "enableGapProcessing": false, "enableUpdatePatterns": false}};
        console.log('Loaded intelligent settings for', Object.keys(window.INTELLIGENT_SETTINGS).length, 'tables');
        
</script>
    <!-- Tool Info Header -->
    <div class="header" style="margin-left: 10px;">
        <h1>CVE Analysis Tools</h1><h2><small>Hashmire/Analysis_Tools version: 0.1.0</small>
    </div>
    
        <!-- Hidden div containing global CVE metadata for Provenance Assistance -->
        <div id="global-cve-metadata" style="display:none;" data-cve-metadata='{&quot;cveId&quot;: &quot;CVE-2022-48655&quot;, &quot;descriptionData&quot;: [{&quot;sourceId&quot;: &quot;416baaa9-dc9f-4396-8d5f-8c081fb06d67&quot;, &quot;sourceRole&quot;: &quot;CNA&quot;, &quot;descriptions&quot;: [{&quot;lang&quot;: &quot;en&quot;, &quot;value&quot;: &quot;In the Linux kernel, the following vulnerability has been resolved:\n\nfirmware: arm_scmi: Harden accesses to the reset domains\n\nAccessing reset domains descriptors by the index upon the SCMI drivers\nrequests through the SCMI reset operations interface can potentially\nlead to out-of-bound violations if the SCMI driver misbehave.\n\nAdd an internal consistency check before any such domains descriptors\naccesses.&quot;}]}], &quot;referencesData&quot;: [{&quot;sourceId&quot;: &quot;416baaa9-dc9f-4396-8d5f-8c081fb06d67&quot;, &quot;sourceRole&quot;: &quot;CNA&quot;, &quot;references&quot;: [{&quot;url&quot;: &quot;https://git.kernel.org/stable/c/7184491fc515f391afba23d0e9b690caaea72daf&quot;, &quot;name&quot;: &quot;&quot;, &quot;tags&quot;: []}, {&quot;url&quot;: &quot;https://git.kernel.org/stable/c/f2277d9e2a0d092c13bae7ee82d75432bb8b5108&quot;, &quot;name&quot;: &quot;&quot;, &quot;tags&quot;: []}, {&quot;url&quot;: &quot;https://git.kernel.org/stable/c/1f08a1b26cfc53b7715abc46857c6023bb1b87de&quot;, &quot;name&quot;: &quot;&quot;, &quot;tags&quot;: []}, {&quot;url&quot;: &quot;https://git.kernel.org/stable/c/8e65edf0d37698f7a6cb174608d3ec7976baf49e&quot;, &quot;name&quot;: &quot;&quot;, &quot;tags&quot;: []}, {&quot;url&quot;: &quot;https://git.kernel.org/stable/c/e9076ffbcaed5da6c182b144ef9f6e24554af268&quot;, &quot;name&quot;: &quot;&quot;, &quot;tags&quot;: []}]}, {&quot;sourceId&quot;: &quot;af854a3a-2127-422b-91ae-364da2661108&quot;, &quot;sourceRole&quot;: &quot;ADP&quot;, &quot;references&quot;: [{&quot;url&quot;: &quot;https://git.kernel.org/stable/c/7184491fc515f391afba23d0e9b690caaea72daf&quot;, &quot;name&quot;: &quot;&quot;, &quot;tags&quot;: [&quot;x_transferred&quot;]}, {&quot;url&quot;: &quot;https://git.kernel.org/stable/c/f2277d9e2a0d092c13bae7ee82d75432bb8b5108&quot;, &quot;name&quot;: &quot;&quot;, &quot;tags&quot;: [&quot;x_transferred&quot;]}, {&quot;url&quot;: &quot;https://git.kernel.org/stable/c/1f08a1b26cfc53b7715abc46857c6023bb1b87de&quot;, &quot;name&quot;: &quot;&quot;, &quot;tags&quot;: [&quot;x_transferred&quot;]}, {&quot;url&quot;: &quot;https://git.kernel.org/stable/c/8e65edf0d37698f7a6cb174608d3ec7976baf49e&quot;, &quot;name&quot;: &quot;&quot;, &quot;tags&quot;: [&quot;x_transferred&quot;]}, {&quot;url&quot;: &quot;https://git.kernel.org/stable/c/e9076ffbcaed5da6c182b144ef9f6e24554af268&quot;, &quot;name&quot;: &quot;&quot;, &quot;tags&quot;: [&quot;x_transferred&quot;]}, {&quot;url&quot;: &quot;https://lists.debian.org/debian-lts-announce/2024/06/msg00019.html&quot;, &quot;name&quot;: &quot;&quot;, &quot;tags&quot;: [&quot;x_transferred&quot;]}, {&quot;url&quot;: &quot;https://security.netapp.com/advisory/ntap-20240912-0008/&quot;, &quot;name&quot;: &quot;&quot;, &quot;tags&quot;: []}]}], &quot;sourceData&quot;: [{&quot;sourceId&quot;: &quot;&quot;, &quot;name&quot;: &quot;NIST&quot;, &quot;contactEmail&quot;: &quot;nvd@nist.gov&quot;, &quot;sourceIdentifiers&quot;: [&quot;nvd@nist.gov&quot;]}, {&quot;sourceId&quot;: &quot;nvd@nist.gov&quot;, &quot;name&quot;: &quot;NIST&quot;, &quot;contactEmail&quot;: &quot;nvd@nist.gov&quot;, &quot;sourceIdentifiers&quot;: [&quot;nvd@nist.gov&quot;]}, {&quot;sourceId&quot;: &quot;416baaa9-dc9f-4396-8d5f-8c081fb06d67&quot;, &quot;name&quot;: &quot;kernel.org&quot;, &quot;contactEmail&quot;: &quot;cve@kernel.org&quot;, &quot;sourceIdentifiers&quot;: [&quot;416baaa9-dc9f-4396-8d5f-8c081fb06d67&quot;]}, {&quot;sourceId&quot;: &quot;af854a3a-2127-422b-91ae-364da2661108&quot;, &quot;name&quot;: &quot;CVE&quot;, &quot;contactEmail&quot;: &quot;cve-request@mitre.org&quot;, &quot;sourceIdentifiers&quot;: [&quot;af854a3a-2127-422b-91ae-364da2661108&quot;]}, {&quot;sourceId&quot;: &quot;134c704f-9b21-4f2e-91b3-4a467353bcc0&quot;, &quot;name&quot;: &quot;CISA-ADP&quot;, &quot;contactEmail&quot;: &quot;cisa@example.com&quot;, &quot;sourceIdentifiers&quot;: [&quot;134c704f-9b21-4f2e-91b3-4a467353bcc0&quot;]}]}'></div>
        
    
    <!-- Tab links -->
    <div class="tab">
        <button class="tablinks" onclick="openCity(event, 'cveListCPESuggester')">CVE List CPE Suggester</button>
    </div>
    
    <div class="d-flex align-items-center justify-content-between" style="margin-left: 10px; margin-right: 10px;">
        <h3 id="cve-id" style="margin-bottom: 0px;"><b>CVE-2022-48655</b></h3>
        <span id="generationTimestamp" class="text-muted">Generated: <time datetime="2025-06-30T18:40:55.349024Z"></time></span>
    </div>
    <hr style="margin: 10px; border: 1px solid;">
    
    <!-- CPE Applicability Generator -->
    <div id="cveListCPESuggester" class="tabcontent" style="display: block; border-left: 0px;">
        <div id="cpeSuggesterHeader" class="header">
            <h3>CPE Applicability Generator</h3>
        </div>
        <table border="1" class="dataframe table table-stripped">
  <thead>
    <tr style="text-align: right;">
      <th class="hidden-header" style="min-width: 20%;">rowDataHTML</th>
      <th class="hidden-header" style="min-width: 80%;">cpeQueryHTML</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><div class="mb-3 d-flex gap-2" id="buttonContainer_0"><button id="collapseRowButton_0" class="btn btn-secondary" onclick="toggleRowCollapse(0)">Collapse Row (Mark Complete)</button></div><div id="rowDataTable_0_container" class="table-container">    <table id="rowDataTable_0" class="table table-hover">                <tr>                    <td>Data Resource</td>                    <td>CVEAPI</td>                </tr>                                <tr>                    <td>Source ID</td>                    <td><span title="Contact Email: cve@kernel.org &#013;Source Identifiers: 416baaa9-dc9f-4396-8d5f-8c081fb06d67">kernel.org</span></td>                </tr>                                <tr>                    <td>Source Role</td>                    <td>CNA</td>                </tr>                <tr><td>Platform Entry Notifications</td><td><span class="badge bg-danger" title="CRITICAL: CPE Range Matching Logic does not currently support git versionTypes">git versionType</span> <span class="badge bg-sourceDataConcern" title="Source to CPE transformations applied:&#013;Vendor+Product: Linux:Linux → linux:linux&#013;">Source to CPE Transformations Applied</span> <span class="badge bg-info" title="version: 95a15d80aa0de938299acfcbc6aa6f2b16f5d7e5, lessThan: 7184491fc515f391afba23d0e9b690caaea72daf, status: affected, versionType: git&#013;version: 95a15d80aa0de938299acfcbc6aa6f2b16f5d7e5, lessThan: f2277d9e2a0d092c13bae7ee82d75432bb8b5108, status: affected, versionType: git&#013;version: 95a15d80aa0de938299acfcbc6aa6f2b16f5d7e5, lessThan: 1f08a1b26cfc53b7715abc46857c6023bb1b87de, status: affected, versionType: git&#013;version: 95a15d80aa0de938299acfcbc6aa6f2b16f5d7e5, lessThan: 8e65edf0d37698f7a6cb174608d3ec7976baf49e, status: affected, versionType: git&#013;version: 95a15d80aa0de938299acfcbc6aa6f2b16f5d7e5, lessThan: e9076ffbcaed5da6c182b144ef9f6e24554af268, status: affected, versionType: git">CVE Affects Version Range(s)</span> <span class="badge bg-secondary" title="cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#013;cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#013;cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*">CPE Base String Searches</span> </td></tr>            <tr>                <td>Vendor Value</td>                <td>Linux</td>            </tr>                        <tr>                <td>Product Value</td>                <td>Linux</td>            </tr>                        <tr>                <td>Repository</td>                <td>https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git</td>            </tr>                        <tr>                <td>Program Files</td>                <td>['drivers/firmware/arm_scmi/reset.c']</td>            </tr>                    <tr>            <td>Raw Platform Data</td>            <td><details><summary>Review rawPlatformData</summary>            <code id="rawPlatformData_0" class="rawPlatformData">{"product": "Linux", "vendor": "Linux", "defaultStatus": "unaffected", "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git", "programFiles": ["drivers/firmware/arm_scmi/reset.c"], "versions": [{"version": "95a15d80aa0de938299acfcbc6aa6f2b16f5d7e5", "lessThan": "7184491fc515f391afba23d0e9b690caaea72daf", "status": "affected", "versionType": "git"}, {"version": "95a15d80aa0de938299acfcbc6aa6f2b16f5d7e5", "lessThan": "f2277d9e2a0d092c13bae7ee82d75432bb8b5108", "status": "affected", "versionType": "git"}, {"version": "95a15d80aa0de938299acfcbc6aa6f2b16f5d7e5", "lessThan": "1f08a1b26cfc53b7715abc46857c6023bb1b87de", "status": "affected", "versionType": "git"}, {"version": "95a15d80aa0de938299acfcbc6aa6f2b16f5d7e5", "lessThan": "8e65edf0d37698f7a6cb174608d3ec7976baf49e", "status": "affected", "versionType": "git"}, {"version": "95a15d80aa0de938299acfcbc6aa6f2b16f5d7e5", "lessThan": "e9076ffbcaed5da6c182b144ef9f6e24554af268", "status": "affected", "versionType": "git"}]}</code></details></td>        </tr>        </table></div></td>
      <td><div id="cpe-query-container-0" class="cpe-query-container" >    <div class="card mb-3">        <div class="card-header d-flex justify-content-between align-items-center"              id="provenanceHeader_0"              data-bs-toggle="collapse"              data-bs-target="#provenanceCollapse_0"              style="cursor: pointer;">            <h5 class="mb-0">                Provenance Assistance            </h5>            <span class="arrow-icon">&darr;</span>        </div>        <div id="provenanceCollapse_0" class="collapse" aria-labelledby="provenanceHeader_0">            <div class="card-body">                <!-- Main container for all provenance elements -->                <div class="d-flex flex-row flex-wrap gap-3">                    <!-- Provenance links -->                    <div id="provenanceLinks_0" class="provenance-links">                        <!-- Link cards will be populated via JavaScript -->                    </div>                                        <!-- Description buttons -->                    <div id="descriptionButtons_0" class="description-buttons">                        <!-- Buttons will be populated via JavaScript -->                    </div>                </div>                                <!-- Dedicated area for displaying description content -->                <div id="descriptionContent_0" class="description-content mt-3 border-top pt-3" style="display: none;">                    <!-- Description content will be populated here when a button is clicked -->                </div>            </div>        </div>    </div>        <div class="card mb-3">        <div class="card-header d-flex justify-content-between align-items-center"              id="customCPEBuilderHeader_0"              data-bs-toggle="collapse"              data-bs-target="#customCPEBuilderCollapse_0"              style="cursor: pointer;">            <h5 class="mb-0">                Custom CPE Builder            </h5>            <span class="arrow-icon">&darr;</span>        </div>        <div id="customCPEBuilderCollapse_0" class="collapse" aria-labelledby="customCPEBuilderHeader_0">            <div class="card-body">                <div id="customCPEBuilder-content-0" class="customCPEBuilder">                    <!-- Content will be populated by custom_cpe_builder.js -->                </div>            </div>        </div>    </div>            <div class="card mb-3">            <div class="card-header d-flex justify-content-between align-items-center"                  id="cpeHeader_0"                  data-bs-toggle="collapse"                  data-bs-target="#cpeCollapse_0"                  style="cursor: pointer;">                <h5 class="mb-0">                    CPE Suggestions                </h5>                <span class="arrow-icon">&uarr;</span>            </div>            <div id="cpeCollapse_0" class="collapse show" aria-labelledby="cpeHeader_0">                <div class="card-body">                    <div id="matchesTable_0_container" class="table-container">                    <table id="matchesTable_0" class="table table-hover matchesTable">                    <thead>                      <tr>                        <th style="width: 65%">CPE Base String</th>                        <th style="width: 35%">Information</th>                      </tr>                    </thead>                    <tbody>                                    <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_*_*" class="cpe-row confirmed-mapping-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*">                    <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*</td>                    <td>                        <div class="d-flex flex-wrap gap-1 align-items-center">                        <span class="badge rounded-pill bg-success">Confirmed Mapping</span>                            <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                            <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                            <div class="badge bg-primary d-inline-flex align-items-center">                                Total CPE Names: 5820                                <span class="badge bg-info ms-1">Final: 5703</span>                                <span class="badge bg-warning ms-1">Deprecated: 117</span>                            </div>                        </div>                    </td>                </tr>                            <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_arm64_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm64:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm64:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 23                            <span class="badge bg-info ms-1">Final: 23</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_x86_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x86:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x86:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 16                            <span class="badge bg-info ms-1">Final: 16</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_x64_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x64:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x64:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 5                            <span class="badge bg-info ms-1">Final: 5</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_ixgbe_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel_ixgbe:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel_ixgbe:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 2                            <span class="badge bg-info ms-1">Final: 2</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel-rt_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel-rt:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel-rt:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 1                            <span class="badge bg-info ms-1">Final: 1</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_i40e\_i40evf_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel_i40e\/i40evf:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel_i40e\/i40evf:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 1                            <span class="badge bg-info ms-1">Final: 1</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_arm32_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm32:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm32:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 1                            <span class="badge bg-info ms-1">Final: 1</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                    </tbody>        </table>        </div>                </div>            </div>        </div>        </div></td>
    </tr>
    <tr>
      <td><div class="mb-3 d-flex gap-2" id="buttonContainer_1"><button id="collapseRowButton_1" class="btn btn-secondary" onclick="toggleRowCollapse(1)">Collapse Row (Mark Complete)</button></div><div id="rowDataTable_1_container" class="table-container">    <table id="rowDataTable_1" class="table table-hover">                <tr>                    <td>Data Resource</td>                    <td>CVEAPI</td>                </tr>                                <tr>                    <td>Source ID</td>                    <td><span title="Contact Email: cve@kernel.org &#013;Source Identifiers: 416baaa9-dc9f-4396-8d5f-8c081fb06d67">kernel.org</span></td>                </tr>                                <tr>                    <td>Source Role</td>                    <td>CNA</td>                </tr>                <tr><td>Platform Entry Notifications</td><td><span class="badge bg-warning" title="Versions array contains wildcard patterns requiring special handling">Wildcard Patterns</span> <span class="badge bg-sourceDataConcern" title="Source to CPE transformations applied:&#013;Vendor+Product: Linux:Linux → linux:linux&#013;">Source to CPE Transformations Applied</span> <span class="badge bg-info" title="version: 5.4, status: affected&#013;version: 0, lessThan: 5.4, status: unaffected, versionType: semver&#013;version: 5.4.277, lessThanOrEqual: 5.4.*, status: unaffected, versionType: semver&#013;version: 5.10.218, lessThanOrEqual: 5.10.*, status: unaffected, versionType: semver&#013;version: 5.15.71, lessThanOrEqual: 5.15.*, status: unaffected, versionType: semver&#013;version: 5.19.12, lessThanOrEqual: 5.19.*, status: unaffected, versionType: semver&#013;version: 6.0, lessThanOrEqual: *, status: unaffected, versionType: original_commit_for_fix">CVE Affects Version(s) Exact and Range(s)</span> <span class="badge bg-secondary" title="cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#013;cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#013;cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*">CPE Base String Searches</span> </td></tr>            <tr>                <td>Vendor Value</td>                <td>Linux</td>            </tr>                        <tr>                <td>Product Value</td>                <td>Linux</td>            </tr>                        <tr>                <td>Repository</td>                <td>https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git</td>            </tr>                        <tr>                <td>Program Files</td>                <td>['drivers/firmware/arm_scmi/reset.c']</td>            </tr>                    <tr>            <td>Raw Platform Data</td>            <td><details><summary>Review rawPlatformData</summary>            <code id="rawPlatformData_1" class="rawPlatformData">{"product": "Linux", "vendor": "Linux", "defaultStatus": "affected", "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git", "programFiles": ["drivers/firmware/arm_scmi/reset.c"], "versions": [{"version": "5.4", "status": "affected"}, {"version": "0", "lessThan": "5.4", "status": "unaffected", "versionType": "semver"}, {"version": "5.4.277", "lessThanOrEqual": "5.4.*", "status": "unaffected", "versionType": "semver"}, {"version": "5.10.218", "lessThanOrEqual": "5.10.*", "status": "unaffected", "versionType": "semver"}, {"version": "5.15.71", "lessThanOrEqual": "5.15.*", "status": "unaffected", "versionType": "semver"}, {"version": "5.19.12", "lessThanOrEqual": "5.19.*", "status": "unaffected", "versionType": "semver"}, {"version": "6.0", "lessThanOrEqual": "*", "status": "unaffected", "versionType": "original_commit_for_fix"}]}</code></details></td>        </tr>        </table></div></td>
      <td><div id="cpe-query-container-1" class="cpe-query-container" >    <div class="card mb-3">        <div class="card-header d-flex justify-content-between align-items-center"              id="provenanceHeader_1"              data-bs-toggle="collapse"              data-bs-target="#provenanceCollapse_1"              style="cursor: pointer;">            <h5 class="mb-0">                Provenance Assistance            </h5>            <span class="arrow-icon">&darr;</span>        </div>        <div id="provenanceCollapse_1" class="collapse" aria-labelledby="provenanceHeader_1">            <div class="card-body">                <!-- Main container for all provenance elements -->                <div class="d-flex flex-row flex-wrap gap-3">                    <!-- Provenance links -->                    <div id="provenanceLinks_1" class="provenance-links">                        <!-- Link cards will be populated via JavaScript -->                    </div>                                        <!-- Description buttons -->                    <div id="descriptionButtons_1" class="description-buttons">                        <!-- Buttons will be populated via JavaScript -->                    </div>                </div>                                <!-- Dedicated area for displaying description content -->                <div id="descriptionContent_1" class="description-content mt-3 border-top pt-3" style="display: none;">                    <!-- Description content will be populated here when a button is clicked -->                </div>            </div>        </div>    </div>        <div class="card mb-3">        <div class="card-header d-flex justify-content-between align-items-center"              id="customCPEBuilderHeader_1"              data-bs-toggle="collapse"              data-bs-target="#customCPEBuilderCollapse_1"              style="cursor: pointer;">            <h5 class="mb-0">                Custom CPE Builder            </h5>            <span class="arrow-icon">&darr;</span>        </div>        <div id="customCPEBuilderCollapse_1" class="collapse" aria-labelledby="customCPEBuilderHeader_1">            <div class="card-body">                <div id="customCPEBuilder-content-1" class="customCPEBuilder">                    <!-- Content will be populated by custom_cpe_builder.js -->                </div>            </div>        </div>    </div>            <div class="card mb-3">            <div class="card-header d-flex justify-content-between align-items-center"                  id="cpeHeader_1"                  data-bs-toggle="collapse"                  data-bs-target="#cpeCollapse_1"                  style="cursor: pointer;">                <h5 class="mb-0">                    CPE Suggestions                </h5>                <span class="arrow-icon">&uarr;</span>            </div>            <div id="cpeCollapse_1" class="collapse show" aria-labelledby="cpeHeader_1">                <div class="card-body">                    <div id="matchesTable_1_container" class="table-container">                    <table id="matchesTable_1" class="table table-hover matchesTable">                    <thead>                      <tr>                        <th style="width: 65%">CPE Base String</th>                        <th style="width: 35%">Information</th>                      </tr>                    </thead>                    <tbody>                                    <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_*_*" class="cpe-row confirmed-mapping-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*">                    <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*</td>                    <td>                        <div class="d-flex flex-wrap gap-1 align-items-center">                        <span class="badge rounded-pill bg-success">Confirmed Mapping</span>                            <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                            <span class="badge rounded-pill bg-info" title="version: cpe:2.3:o:linux:linux_kernel:5.4:*:*:*:*:*:*:*Versions Matches Identified:  &#10;lessThan: cpe:2.3:o:linux:linux_kernel:5.4:*:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:-:*:*:*:*:*:*Versions Matches Identified:  &#10;lessThan: cpe:2.3:o:linux:linux_kernel:5.4:-:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc1:*:*:*:*:*:*Versions Matches Identified:  &#10;lessThan: cpe:2.3:o:linux:linux_kernel:5.4:rc1:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc2:*:*:*:*:*:*Versions Matches Identified:  &#10;lessThan: cpe:2.3:o:linux:linux_kernel:5.4:rc2:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc3:*:*:*:*:*:*Versions Matches Identified:  &#10;lessThan: cpe:2.3:o:linux:linux_kernel:5.4:rc3:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc4:*:*:*:*:*:*Versions Matches Identified:  &#10;lessThan: cpe:2.3:o:linux:linux_kernel:5.4:rc4:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc5:*:*:*:*:*:*Versions Matches Identified:  &#10;lessThan: cpe:2.3:o:linux:linux_kernel:5.4:rc5:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc6:*:*:*:*:*:*Versions Matches Identified:  &#10;lessThan: cpe:2.3:o:linux:linux_kernel:5.4:rc6:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc7:*:*:*:*:*:*Versions Matches Identified:  &#10;lessThan: cpe:2.3:o:linux:linux_kernel:5.4:rc7:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:6.0:rc3:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:6.0:rc4:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:6.0:rc5:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:6.0:rc6:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:6.0:rc7:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.19.12:*:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.15.71:*:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:6.0:-:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.10.218:*:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4.277:*:*:*:*:*:*:*">Version Matches: 30</span>                            <div class="badge bg-primary d-inline-flex align-items-center">                                Total CPE Names: 5820                                <span class="badge bg-info ms-1">Final: 5703</span>                                <span class="badge bg-warning ms-1">Deprecated: 117</span>                            </div>                        </div>                    </td>                </tr>                            <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_arm64_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm64:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm64:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 23                            <span class="badge bg-info ms-1">Final: 23</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_x86_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x86:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x86:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 16                            <span class="badge bg-info ms-1">Final: 16</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_x64_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x64:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x64:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 5                            <span class="badge bg-info ms-1">Final: 5</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_ixgbe_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel_ixgbe:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel_ixgbe:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 2                            <span class="badge bg-info ms-1">Final: 2</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel-rt_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel-rt:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel-rt:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 1                            <span class="badge bg-info ms-1">Final: 1</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_i40e\_i40evf_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel_i40e\/i40evf:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel_i40e\/i40evf:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 1                            <span class="badge bg-info ms-1">Final: 1</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_arm32_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm32:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm32:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 4</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 1                            <span class="badge bg-info ms-1">Final: 1</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                    </tbody>        </table>        </div>                </div>            </div>        </div>        </div></td>
    </tr>
    <tr>
      <td><div class="mb-3 d-flex gap-2" id="buttonContainer_2"><button id="collapseRowButton_2" class="btn btn-secondary" onclick="toggleRowCollapse(2)">Collapse Row (Mark Complete)</button></div><div id="rowDataTable_2_container" class="table-container">    <table id="rowDataTable_2" class="table table-hover">                <tr>                    <td>Data Resource</td>                    <td>CVEAPI</td>                </tr>                                <tr>                    <td>Source ID</td>                    <td><span title="Contact Email: cisa@example.com &#013;Source Identifiers: 134c704f-9b21-4f2e-91b3-4a467353bcc0">CISA-ADP</span></td>                </tr>                                <tr>                    <td>Source Role</td>                    <td>ADP</td>                </tr>                <tr><td>Platform Entry Notifications</td><td><span class="badge bg-sourceDataConcern" title="Source to CPE transformations applied:&#013;Vendor+Product: linux:linux_kernel → linux:kernel&#013;">Source to CPE Transformations Applied</span> <span class="badge bg-info" title="version: 95a15d80aa0d, status: affected, lessThan: 7184491fc515, versionType: custom&#013;version: 95a15d80aa0d, status: affected, lessThan: f2277d9e2a0d, versionType: custom&#013;version: 95a15d80aa0d, status: affected, lessThan: 1f08a1b26cfc, versionType: custom&#013;version: 95a15d80aa0d, status: affected, lessThan: 8e65edf0d376, versionType: custom&#013;version: 95a15d80aa0d, status: affected, lessThan: e9076ffbcaed, versionType: custom">CVE Affects Version Range(s)</span> <span class="badge bg-info" title="Versions array contains 1 CPEs from affected entry: cpe:2.3:a:linux:linux_kernel:-:*:*:*:*:*:*:*">CVE Affected CPES Data: 1</span> <span class="badge bg-secondary" title="cpe:2.3:a:linux:linux_kernel:*:*:*:*:*:*:*:*&#013;cpe:2.3:*:linux:*kernel*:*:*:*:*:*:*:*:*&#013;cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#013;cpe:2.3:a:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#013;cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#013;cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*">CPE Base String Searches</span> </td></tr>            <tr>                <td>Vendor Value</td>                <td>linux</td>            </tr>                        <tr>                <td>Product Value</td>                <td>linux_kernel</td>            </tr>                    <tr>            <td>Raw Platform Data</td>            <td><details><summary>Review rawPlatformData</summary>            <code id="rawPlatformData_2" class="rawPlatformData">{"vendor": "linux", "product": "linux_kernel", "cpes": ["cpe:2.3:a:linux:linux_kernel:-:*:*:*:*:*:*:*"], "defaultStatus": "unaffected", "versions": [{"version": "95a15d80aa0d", "status": "affected", "lessThan": "7184491fc515", "versionType": "custom"}, {"version": "95a15d80aa0d", "status": "affected", "lessThan": "f2277d9e2a0d", "versionType": "custom"}, {"version": "95a15d80aa0d", "status": "affected", "lessThan": "1f08a1b26cfc", "versionType": "custom"}, {"version": "95a15d80aa0d", "status": "affected", "lessThan": "8e65edf0d376", "versionType": "custom"}, {"version": "95a15d80aa0d", "status": "affected", "lessThan": "e9076ffbcaed", "versionType": "custom"}]}</code></details></td>        </tr>        </table></div></td>
      <td><div id="cpe-query-container-2" class="cpe-query-container" >    <div class="card mb-3">        <div class="card-header d-flex justify-content-between align-items-center"              id="provenanceHeader_2"              data-bs-toggle="collapse"              data-bs-target="#provenanceCollapse_2"              style="cursor: pointer;">            <h5 class="mb-0">                Provenance Assistance            </h5>            <span class="arrow-icon">&darr;</span>        </div>        <div id="provenanceCollapse_2" class="collapse" aria-labelledby="provenanceHeader_2">            <div class="card-body">                <!-- Main container for all provenance elements -->                <div class="d-flex flex-row flex-wrap gap-3">                    <!-- Provenance links -->                    <div id="provenanceLinks_2" class="provenance-links">                        <!-- Link cards will be populated via JavaScript -->                    </div>                                        <!-- Description buttons -->                    <div id="descriptionButtons_2" class="description-buttons">                        <!-- Buttons will be populated via JavaScript -->                    </div>                </div>                                <!-- Dedicated area for displaying description content -->                <div id="descriptionContent_2" class="description-content mt-3 border-top pt-3" style="display: none;">                    <!-- Description content will be populated here when a button is clicked -->                </div>            </div>        </div>    </div>        <div class="card mb-3">        <div class="card-header d-flex justify-content-between align-items-center"              id="customCPEBuilderHeader_2"              data-bs-toggle="collapse"              data-bs-target="#customCPEBuilderCollapse_2"              style="cursor: pointer;">            <h5 class="mb-0">                Custom CPE Builder            </h5>            <span class="arrow-icon">&darr;</span>        </div>        <div id="customCPEBuilderCollapse_2" class="collapse" aria-labelledby="customCPEBuilderHeader_2">            <div class="card-body">                <div id="customCPEBuilder-content-2" class="customCPEBuilder">                    <!-- Content will be populated by custom_cpe_builder.js -->                </div>            </div>        </div>    </div>            <div class="card mb-3">            <div class="card-header d-flex justify-content-between align-items-center"                  id="cpeHeader_2"                  data-bs-toggle="collapse"                  data-bs-target="#cpeCollapse_2"                  style="cursor: pointer;">                <h5 class="mb-0">                    CPE Suggestions                </h5>                <span class="arrow-icon">&uarr;</span>            </div>            <div id="cpeCollapse_2" class="collapse show" aria-labelledby="cpeHeader_2">                <div class="card-body">                    <div id="matchesTable_2_container" class="table-container">                    <table id="matchesTable_2" class="table table-hover matchesTable">                    <thead>                      <tr>                        <th style="width: 65%">CPE Base String</th>                        <th style="width: 35%">Information</th>                      </tr>                    </thead>                    <tbody>                                <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_arm64_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm64:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm64:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 5</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 23                            <span class="badge bg-info ms-1">Final: 23</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_x86_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x86:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x86:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 5</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 16                            <span class="badge bg-info ms-1">Final: 16</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_x64_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x64:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x64:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 5</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 5                            <span class="badge bg-info ms-1">Final: 5</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_ixgbe_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel_ixgbe:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel_ixgbe:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 5</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 2                            <span class="badge bg-info ms-1">Final: 2</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel-rt_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel-rt:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel-rt:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 5</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 1                            <span class="badge bg-info ms-1">Final: 1</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_i40e\_i40evf_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel_i40e\/i40evf:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel_i40e\/i40evf:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 5</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 1                            <span class="badge bg-info ms-1">Final: 1</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_arm32_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm32:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm32:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 5</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 1                            <span class="badge bg-info ms-1">Final: 1</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 5</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 5820                            <span class="badge bg-info ms-1">Final: 5703</span>                            <span class="badge bg-warning ms-1">Deprecated: 117</span>                        </div>                    </div>                </td>            </tr>                    </tbody>        </table>        </div>                </div>            </div>        </div>        </div></td>
    </tr>
    <tr>
      <td><div class="mb-3 d-flex gap-2" id="buttonContainer_3"><button id="collapseRowButton_3" class="btn btn-secondary" onclick="toggleRowCollapse(3)">Collapse Row (Mark Complete)</button></div><div id="rowDataTable_3_container" class="table-container">    <table id="rowDataTable_3" class="table table-hover">                <tr>                    <td>Data Resource</td>                    <td>CVEAPI</td>                </tr>                                <tr>                    <td>Source ID</td>                    <td><span title="Contact Email: cisa@example.com &#013;Source Identifiers: 134c704f-9b21-4f2e-91b3-4a467353bcc0">CISA-ADP</span></td>                </tr>                                <tr>                    <td>Source Role</td>                    <td>ADP</td>                </tr>                <tr><td>Platform Entry Notifications</td><td><span class="badge bg-sourceDataConcern" title="Source to CPE transformations applied:&#013;Vendor+Product: linux:linux_kernel → linux:kernel&#013;">Source to CPE Transformations Applied</span> <span class="badge bg-info" title="version: 5.4, status: affected">CVE Affects Version(s) Exact</span> <span class="badge bg-info" title="Versions array contains 1 CPEs from affected entry: cpe:2.3:o:linux:linux_kernel:5.4:*:*:*:*:*:*:*">CVE Affected CPES Data: 1</span> <span class="badge bg-secondary" title="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*&#013;cpe:2.3:*:linux:*kernel*:*:*:*:*:*:*:*:*&#013;cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#013;cpe:2.3:o:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#013;cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#013;cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*">CPE Base String Searches</span> </td></tr>            <tr>                <td>Vendor Value</td>                <td>linux</td>            </tr>                        <tr>                <td>Product Value</td>                <td>linux_kernel</td>            </tr>                    <tr>            <td>Raw Platform Data</td>            <td><details><summary>Review rawPlatformData</summary>            <code id="rawPlatformData_3" class="rawPlatformData">{"vendor": "linux", "product": "linux_kernel", "cpes": ["cpe:2.3:o:linux:linux_kernel:5.4:*:*:*:*:*:*:*"], "defaultStatus": "affected", "versions": [{"version": "5.4", "status": "affected"}]}</code></details></td>        </tr>        </table></div></td>
      <td><div id="cpe-query-container-3" class="cpe-query-container" >    <div class="card mb-3">        <div class="card-header d-flex justify-content-between align-items-center"              id="provenanceHeader_3"              data-bs-toggle="collapse"              data-bs-target="#provenanceCollapse_3"              style="cursor: pointer;">            <h5 class="mb-0">                Provenance Assistance            </h5>            <span class="arrow-icon">&darr;</span>        </div>        <div id="provenanceCollapse_3" class="collapse" aria-labelledby="provenanceHeader_3">            <div class="card-body">                <!-- Main container for all provenance elements -->                <div class="d-flex flex-row flex-wrap gap-3">                    <!-- Provenance links -->                    <div id="provenanceLinks_3" class="provenance-links">                        <!-- Link cards will be populated via JavaScript -->                    </div>                                        <!-- Description buttons -->                    <div id="descriptionButtons_3" class="description-buttons">                        <!-- Buttons will be populated via JavaScript -->                    </div>                </div>                                <!-- Dedicated area for displaying description content -->                <div id="descriptionContent_3" class="description-content mt-3 border-top pt-3" style="display: none;">                    <!-- Description content will be populated here when a button is clicked -->                </div>            </div>        </div>    </div>        <div class="card mb-3">        <div class="card-header d-flex justify-content-between align-items-center"              id="customCPEBuilderHeader_3"              data-bs-toggle="collapse"              data-bs-target="#customCPEBuilderCollapse_3"              style="cursor: pointer;">            <h5 class="mb-0">                Custom CPE Builder            </h5>            <span class="arrow-icon">&darr;</span>        </div>        <div id="customCPEBuilderCollapse_3" class="collapse" aria-labelledby="customCPEBuilderHeader_3">            <div class="card-body">                <div id="customCPEBuilder-content-3" class="customCPEBuilder">                    <!-- Content will be populated by custom_cpe_builder.js -->                </div>            </div>        </div>    </div>            <div class="card mb-3">            <div class="card-header d-flex justify-content-between align-items-center"                  id="cpeHeader_3"                  data-bs-toggle="collapse"                  data-bs-target="#cpeCollapse_3"                  style="cursor: pointer;">                <h5 class="mb-0">                    CPE Suggestions                </h5>                <span class="arrow-icon">&uarr;</span>            </div>            <div id="cpeCollapse_3" class="collapse show" aria-labelledby="cpeHeader_3">                <div class="card-body">                    <div id="matchesTable_3_container" class="table-container">                    <table id="matchesTable_3" class="table table-hover matchesTable">                    <thead>                      <tr>                        <th style="width: 65%">CPE Base String</th>                        <th style="width: 35%">Information</th>                      </tr>                    </thead>                    <tbody>                                <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_arm64_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm64:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm64:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*&#10;searchSourcepartvendorproduct:  cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 7</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 23                            <span class="badge bg-info ms-1">Final: 23</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_x86_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x86:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x86:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*&#10;searchSourcepartvendorproduct:  cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 7</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 16                            <span class="badge bg-info ms-1">Final: 16</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_x64_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x64:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:x64:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*&#10;searchSourcepartvendorproduct:  cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 7</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 5                            <span class="badge bg-info ms-1">Final: 5</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_ixgbe_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel_ixgbe:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel_ixgbe:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:o:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcepartvendorproduct:  cpe:2.3:o:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 6</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 2                            <span class="badge bg-info ms-1">Final: 2</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_arm32_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm32:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm32:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*&#10;searchSourcepartvendorproduct:  cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 7</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 1                            <span class="badge bg-info ms-1">Final: 1</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel-rt_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel-rt:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel-rt:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:o:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcepartvendorproduct:  cpe:2.3:o:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 6</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 1                            <span class="badge bg-info ms-1">Final: 1</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_i40e\_i40evf_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel_i40e\/i40evf:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel_i40e\/i40evf:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:o:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcepartvendorproduct:  cpe:2.3:o:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 6</span>                    <span class="badge rounded-pill bg-info" title="">Version Matches: 0</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 1                            <span class="badge bg-info ms-1">Final: 1</span>                            <span class="badge bg-warning ms-1">Deprecated: 0</span>                        </div>                    </div>                </td>            </tr>                        <tr id="row_cpe_2_3_o_linux_linux_kernel_*_*_*_*_*_*_*_*" class="cpe-row" data-cpe-base="cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*">                <td class="text-break">cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*</td>                <td>                <div class="d-flex flex-wrap gap-1 align-items-center">                    <span class="badge rounded-pill bg-secondary" title="Relevant Match String Searches:&#10;searchSourcecveAffectedCPEsArray:  cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*&#10;searchSourcepartvendorproduct:  cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*&#10;searchSourcevendorproduct:  cpe:2.3:*:linux:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourceproduct:  cpe:2.3:*:*:*linux_kernel*:*:*:*:*:*:*:*:*&#10;searchSourcevendor:  cpe:2.3:*:linux:*:*:*:*:*:*:*:*:*&#10;">Relevant Searches: 7</span>                    <span class="badge rounded-pill bg-info" title="version: cpe:2.3:o:linux:linux_kernel:5.4:*:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:-:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc1:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc2:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc3:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc4:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc5:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc6:*:*:*:*:*:*Versions Matches Identified:  &#10;version: cpe:2.3:o:linux:linux_kernel:5.4:rc7:*:*:*:*:*:*">Version Matches: 9</span>                        <div class="badge bg-primary d-inline-flex align-items-center">                            Total CPE Names: 5820                            <span class="badge bg-info ms-1">Final: 5703</span>                            <span class="badge bg-warning ms-1">Deprecated: 117</span>                        </div>                    </div>                </td>            </tr>                    </tbody>        </table>        </div>                </div>            </div>        </div>        </div></td>
    </tr>
    <tr>
      <td><div class="mb-3 d-flex gap-2" id="buttonContainer_4"><button id="collapseRowButton_4" class="btn btn-secondary" onclick="toggleRowCollapse(4)">Collapse Row (Mark Complete)</button></div><div id="rowDataTable_4_container" class="table-container">    <table id="rowDataTable_4" class="table table-hover">                <tr>                    <td>Data Resource</td>                    <td>NVDAPI</td>                </tr>                                <tr>                    <td>Source ID</td>                    <td><span title="Contact Email: nvd@nist.gov &#013;Source Identifiers: nvd@nist.gov">NIST</span></td>                </tr>                                <tr>                    <td>Source Role</td>                    <td>NVD</td>                </tr>                <tr><td>Platform Entry Notifications</td><td><span class="badge bg-info" title="No versions detected!">NVD Configuration</span> </td></tr>        <tr>            <td>Raw Platform Data</td>            <td><details><summary>Review rawPlatformData</summary>            <code id="rawPlatformData_4" class="rawPlatformData">{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.4", "versionEndExcluding": "5.4.277", "matchCriteriaId": "C621E4C1-8A64-4242-B99B-5E199F908D5B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.5", "versionEndExcluding": "5.10.218", "matchCriteriaId": "86AE14FD-2318-4BF1-87B3-9ED387996A2F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.11", "versionEndExcluding": "5.15.71", "matchCriteriaId": "080C1827-D257-4D5A-9071-779EF7F5EF0B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartExcluding": "5.16", "versionEndExcluding": "5.19.12", "matchCriteriaId": "2D86B159-0AA3-429A-8FE5-B87DB2046DB6"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*", "matchCriteriaId": "E8BD11A3-8643-49B6-BADE-5029A0117325"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*", "matchCriteriaId": "5F0AD220-F6A9-4012-8636-155F1B841FAD"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.0:rc3:*:*:*:*:*:*", "matchCriteriaId": "A46498B3-78E1-4623-AAE1-94D29A42BE4E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.0:rc4:*:*:*:*:*:*", "matchCriteriaId": "F8446E87-F5F6-41CA-8201-BAE0F0CA6DD9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.0:rc5:*:*:*:*:*:*", "matchCriteriaId": "8E5FB72F-67CE-43CC-83FE-541604D98182"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.0:rc6:*:*:*:*:*:*", "matchCriteriaId": "3A0A7397-F5F8-4753-82DC-9A11288E696D"}]}]}</code></details></td>        </tr>        </table></div></td>
      <td><div id="cpe-query-container-4" class="cpe-query-container" >    <div class="card mb-3">        <div class="card-header d-flex justify-content-between align-items-center"              id="customCPEBuilderHeader_4"              data-bs-toggle="collapse"              data-bs-target="#customCPEBuilderCollapse_4"              style="cursor: pointer;">            <h5 class="mb-0">                Custom CPE Builder            </h5>            <span class="arrow-icon">&uarr;</span>        </div>        <div id="customCPEBuilderCollapse_4" class="collapse show" aria-labelledby="customCPEBuilderHeader_4">            <div class="card-body">                <div id="customCPEBuilder-content-4" class="customCPEBuilder">                    <!-- Content will be populated by custom_cpe_builder.js -->                </div>            </div>        </div>    </div>                    <div class="card mb-3">                    <div class="card-header">                        <h5 class="mb-0">CPE Suggestions</h5>                    </div>                    <div class="card-body">                        <p class="text-muted">No CPE suggestions available for this entry.</p>                    </div>                </div>                </div></td>
    </tr>
    <tr>
      <td><div class="mb-3 d-flex gap-2" id="buttonContainer_5"><button id="collapseRowButton_5" class="btn btn-secondary" onclick="toggleRowCollapse(5)">Collapse Row (Mark Complete)</button></div><div id="rowDataTable_5_container" class="table-container">    <table id="rowDataTable_5" class="table table-hover">                <tr>                    <td>Data Resource</td>                    <td>NVDAPI</td>                </tr>                                <tr>                    <td>Source ID</td>                    <td><span title="Contact Email: nvd@nist.gov &#013;Source Identifiers: nvd@nist.gov">NIST</span></td>                </tr>                                <tr>                    <td>Source Role</td>                    <td>NVD</td>                </tr>                <tr><td>Platform Entry Notifications</td><td><span class="badge bg-info" title="No versions detected!">NVD Configuration</span> </td></tr>        <tr>            <td>Raw Platform Data</td>            <td><details><summary>Review rawPlatformData</summary>            <code id="rawPlatformData_5" class="rawPlatformData">{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}</code></details></td>        </tr>        </table></div></td>
      <td><div id="cpe-query-container-5" class="cpe-query-container" >    <div class="card mb-3">        <div class="card-header d-flex justify-content-between align-items-center"              id="customCPEBuilderHeader_5"              data-bs-toggle="collapse"              data-bs-target="#customCPEBuilderCollapse_5"              style="cursor: pointer;">            <h5 class="mb-0">                Custom CPE Builder            </h5>            <span class="arrow-icon">&uarr;</span>        </div>        <div id="customCPEBuilderCollapse_5" class="collapse show" aria-labelledby="customCPEBuilderHeader_5">            <div class="card-body">                <div id="customCPEBuilder-content-5" class="customCPEBuilder">                    <!-- Content will be populated by custom_cpe_builder.js -->                </div>            </div>        </div>    </div>                    <div class="card mb-3">                    <div class="card-header">                        <h5 class="mb-0">CPE Suggestions</h5>                    </div>                    <div class="card-body">                        <p class="text-muted">No CPE suggestions available for this entry.</p>                    </div>                </div>                </div></td>
    </tr>
  </tbody>
</table>
        <script>
            // Initialize the timestamp handler with the generated timestamp
            window.timestampHandler.init("2025-06-30T18:40:55.349024Z");
        </script>
    </div>
    
    <script>
    function openCity(evt, cityName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(cityName).style.display = "block";
        evt.currentTarget.className += " active";
    }
    </script>
    </body>
    </html>
    